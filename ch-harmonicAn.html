<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="18 Harmonic Analysis | Project XXII" />
<meta property="og:type" content="book" />





<meta name="author" content="Zhengyuan Gao" />

<meta name="date" content="2021-08-09" />

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>

<meta name="description" content="18 Harmonic Analysis | Project XXII">

<title>18 Harmonic Analysis | Project XXII</title>

<link href="libs/tufte-css/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script src="libs/htmlwidgets/htmlwidgets.js"></script>
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding/datatables.js"></script>
<link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk/js/crosstalk.min.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }

code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>



</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Project XXII<p><p class="author">Zhengyuan Gao</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BA; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Preface</a>
<a href="part-i-inference-based-upon-logic-and-logical-computation.html">PART I: Inference Based upon Logic and Logical Computation</a>
<a href="sub-logic.html"><span class="toc-section-number">1</span> Logic</a>
<a href="sub-set-theory.html"><span class="toc-section-number">2</span> Set Theory</a>
<a href="sub-axioms.html"><span class="toc-section-number">3</span> Axioms</a>
<a href="sub-inferknow.html"><span class="toc-section-number">4</span> Inference and Knowledge</a>
<a href="sub-incomplete.html"><span class="toc-section-number">5</span> Incompleteness</a>
<a href="part-ii-infinitesimal-changes-and-their-consequences.html">PART II: Infinitesimal Changes and their Consequences</a>
<a href="sub-continuity.html"><span class="toc-section-number">6</span> Continuity</a>
<a href="sub-calculus.html"><span class="toc-section-number">7</span> Calculus</a>
<a href="ch-DE.html"><span class="toc-section-number">8</span> Differential Equations</a>
<a href="ch-CalUn.html"><span class="toc-section-number">9</span> Calculus under Uncertainty</a>
<a href="part-iii-emergence-of-abstract-interactions.html">PART III: Emergence of Abstract Interactions</a>
<a href="ch-vecMat.html"><span class="toc-section-number">10</span> Vector and Matrix</a>
<a href="ch-MatComp.html"><span class="toc-section-number">11</span> Matrix Computation</a>
<a href="ch-eigen.html"><span class="toc-section-number">12</span> Eigenvalues and Eigenvectors</a>
<a href="ch-UnMulti.html"><span class="toc-section-number">13</span> Uncertainty in Multiple Dimensions</a>
<a href="part-iv-three-masons-to-illuminate-the-dual-world.html">PART IV: Three Masons to Illuminate the Dual World</a>
<a href="ch-representation.html"><span class="toc-section-number">14</span> Representation</a>
<a href="ch-optApp.html"><span class="toc-section-number">15</span> Optimum Approximation</a>
<a href="ch-randomization.html"><span class="toc-section-number">16</span> Randomization</a>
<a href="part-v-complex-ensembles.html">PART V: Complex Ensembles</a>
<a href="ch-complexAn.html"><span class="toc-section-number">17</span> Complex Analysis</a>
<a id="active-page" href="ch-harmonicAn.html"><span class="toc-section-number">18</span> Harmonic Analysis</a><ul class="toc-sections">
<li class="toc"><a href="#sub:heatEq"> Miscellaneous: Harmonic Function, Heat Equation, Exponential Family</a></li>
<li class="toc"><a href="#sub:convolution"> Character and Convolution</a></li>
<li class="toc"><a href="#sub:income"> * Infinite Divisibility: equality and inequality</a></li>
</ul>
<a href="bibliography.html">Bibliography</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html><body><div id="ch:harmonicAn" class="section level1">
<h1>
<span class="header-section-number">18</span> Harmonic Analysis</h1>
<p>In science, when one experimenting on the particles suspended in the fluid, one has the control to ensure that the trajectories of the particle movements are independent of human factors. In social experiments, the “particles” are, in some sense, ourselves. These “particles” have internal states such as emotion and intelligence. These extra features endow “experimentees” with (perhaps simple) interactional and distributional anti-control capabilities. They can store energy and information, sense their environment, and respond to it. They can change or update their internal states contingently depending on their interactions with each other. In this sense, a simultaneous relationship between the “experimenters” and the “experimentees” naturally can emerge in any social “experiment.”</p>
<p>Let’s think of a social “experiment” as a simultaneous or a structural coupling model.
Unlike the causal model that is a collection of premises from which one can deduce a set of propositions along with the order of the <a href="ch-CalUn.html#sub:conProb">causal chain</a>, a simultaneous model is a collection of synchronic <a href="sub-set-theory.html#sub:order">equivalence relations</a> from which one merely can deduce the <a href="ch-eigen.html#sub:det">invariants</a> under some appropriate transformations.<label for="tufte-sn-565" class="margin-toggle sidenote-number">565</label><input type="checkbox" id="tufte-sn-565" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">565</span> The transformation is often presented by group actions.</span> However, to maintain the <a href="ch-eigen.html#sub:det">invariance</a> under the transformations, the (seemingly disordered) simultaneous model should accompany some <em>ordering parameters</em> that are formed by the “experimentees” and are accepted by the “experimenters” or vice versa. The <strong>ordering parameters</strong> synchronize the microscopic and the macroscopic behaviors of the experiment. They generate the simple principles which the “particles” would like to follow, and they influence the direction in which the paths of the experiment evolve.</p>
<p>The <strong>ordering parameters</strong> may depend only on a few principal components. One typical <strong>ordering parameter</strong> is the <a href="">time arrow</a>, i.e., the time parameter in a <a href="ch-randomization.html#sub:global">one-parameter semigroup</a>. The time attaches the dynamical law to all components in the system. Meanwhile, the interactions of the components follow some invariant operations. The <a href="ch-complexAn.html#sub:ImRelation">spectral representation</a> of the dynamics gives us another vision about the ordering: the order of <a href="ch-eigen.html#sub:det">eigenvalues</a> or <a href="ch-complexAn.html#sub:ImRelation">singular values</a>.<label for="tufte-sn-566" class="margin-toggle sidenote-number">566</label><input type="checkbox" id="tufte-sn-566" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">566</span> For example, when the <a href="ch-complexAn.html#sub:ImRelation">embedding data manifold</a> is a square matrix (circular data manifold), the first eigenvector of the manifold tends to describe the full trend of the series. So projecting the data onto the first eigenvector produces the summation. The following principal order bases, i.e., the 2nd or the 3rd, tend to capture the “low-frequency” components of the data, and the rest basis functions progressively fill in “high-frequency” details.</span></p>
<p>Other important forms of <strong>ordering parameters</strong> are the <a href="ch-optApp.html#sub:appSys">non-negative linear functional</a>, such as the energy, the utility, and (probability) distribution functions.<label for="tufte-sn-567" class="margin-toggle sidenote-number">567</label><input type="checkbox" id="tufte-sn-567" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">567</span> For example, heat is a form of energy produced by the particles’ disordered motion (kinetic energy). Heat can convert to and from different forms of energy. The distribution function from the heat equation relates to the Gaussian probability function, which we will see in ch[?].</span> In practice, man-made indexes, such as wealth or income, tend to play the role of the one-dimensional “ordering” parameter. The simultaneity shaped by this parameter can give rise to specific capitalist social-economic dynamical patterns that bring in inequality and the growth of the society.</p>
<p>All these ordering structures more or less relate to the profound properties of the <a href="ch-complexAn.html#sub:complexCal">complex exponential functions</a> and the <a href="ch-representation.html#sub:conjugacy">abstract Fourier basis</a>. The studies of symmetry (and <a href="ch-complexAn.html#sub:coupling">skew-symmetry</a>), invariants, and group transformations of these functions are in a field called harmonic analysis.<label for="tufte-sn-568" class="margin-toggle sidenote-number">568</label><input type="checkbox" id="tufte-sn-568" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">568</span> The strength of the harmonic analysis is that the <a href="ch-representation.html#sub:conjugacy">abstract Fourier basis</a> produces an ordered and meaningful summarization of the underlying model or data since the <a href="ch-representation.html#sub:conjugacy">Fourier transformation</a> extracts regularities from model or data by projecting them into <a href="ch-randomization.html#sub:SumDecomp">invariant subspaces</a> and orders the basis functions in terms of their smoothness.</span></p>
<div class="solution">
<p class="solution-begin">
Eigen-decomposition of the circular data manifold <span id="sol-start-127" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-127', 'sol-start-127')"></span>
</p>
<div id="sol-body-127" class="solution-body" style="display: none;">
<p>If the <a href="ch-complexAn.html#sub:ImRelation">embedding manifold</a> is a square matrix, the eigenvectors of this embedding manifold relate to <a href="ch-representation.html#sub:dualBasis">Fourier matrices</a>, and the eigenvalues of this manifold relate to the Fourier transform of the embedded time series.</p>
<p>To see this, let’s consider the <a href="ch-MatComp.html#sub:matInv">elementary permutation matrix</a> of a data vector <span class="math inline">\(\mathbf{x}\)</span>:<label for="tufte-sn-569" class="margin-toggle sidenote-number">569</label><input type="checkbox" id="tufte-sn-569" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">569</span> Note that here <span class="math inline">\(\mathbf{L}\)</span> is not a lagged operator but a circular operator.</span><span class="math display">\[\mathbf{L}\mathbf{x}=\left[\begin{array}{cccc}
0 &amp; 1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1\\
1 &amp; 0 &amp; 0 &amp; 0
\end{array}\right]\left[\begin{array}{c}
x_{1}\\
x_{2}\\
x_{3}\\
x_{4}
\end{array}\right]=\left[\begin{array}{c}
x_{2}\\
x_{3}\\
x_{4}\\
x_{1}
\end{array}\right].\]</span>
Similarly, one can see that <span class="math inline">\(\mathbf{L}^{2}\mathbf{x}\)</span> gives <span class="math inline">\([x_{3},x_{4},x_{1},x_{2}]^{\top}\)</span>, <span class="math inline">\(\mathbf{L}^{3}\mathbf{x}\)</span> gives <span class="math inline">\([x_{4},x_{1},x_{2},x_{3}]^{\top}\)</span>, while <span class="math inline">\(\mathbf{L}^{4}\mathbf{x}\)</span> return to the original vector <span class="math inline">\(\mathbf{x}\)</span>, namely <span class="math inline">\(\mathbf{L}^{4}=\mathbf{I}\)</span>. We can construct the <em>circular data manifold</em> <span class="math inline">\(\mathbf{M}\)</span> of the vector <span class="math inline">\(\mathbf{x}\)</span>:
<span class="math display">\[\mathbf{M}=x_{1}\mathbf{I}+x_{2}\mathbf{L}+x_{3}\mathbf{L}^{2}+x_{4}\mathbf{L}^{3}=\left[\begin{array}{cccc}
x_{1} &amp; x_{2} &amp; x_{3} &amp; x_{4}\\
x_{4} &amp; x_{1} &amp; x_{2} &amp; x_{3}\\
x_{3} &amp; x_{4} &amp; x_{1} &amp; x_{2}\\
x_{2} &amp; x_{3} &amp; x_{4} &amp; x_{1}
\end{array}\right].\]</span>
The eigenvalues of <span class="math inline">\(\mathbf{L}\)</span> are the roots of the polynomial equation <span class="math inline">\(\lambda^{4}=1\)</span>, because<span class="math display">\[\mathbf{L}\mathbf{x}=\lambda\mathbf{x}=\lambda\left[\begin{array}{c}
x_{1}\\
x_{2}\\
x_{3}\\
x_{4}
\end{array}\right]=\left[\begin{array}{c}
x_{2}\\
x_{3}\\
x_{4}\\
x_{1}
\end{array}\right]\]</span>
which leads to <span class="math inline">\(x_{1}=\lambda x_{4}=\lambda^{2}x_{3}=\lambda^{3}x_{2}=\lambda^{4}x_{1}\)</span>, namely <span class="math inline">\(\lambda^{4}=1\)</span>. The eigenvalues are <span class="math inline">\(1\)</span>, <span class="math inline">\(\mbox{i}\)</span>, <span class="math inline">\(\mbox{i}^{2}\)</span>, and <span class="math inline">\(\mbox{i}^{3}\)</span>, the four roots with equal spaces on the unit circle, namely <span class="math inline">\(\mbox{e}^{(2\pi\mbox{i}/4)k}\)</span> with <span class="math inline">\(k=0,1,2,3\)</span>. The corresponding eigenvectors are<span class="math display">\[\mathbf{v}_{1}=\left[\begin{array}{c}
1\\
1\\
1\\
1
\end{array}\right],\,\mathbf{v}_{2}=\left[\begin{array}{c}
1\\
\mbox{i}\\
\mbox{i}^{2}\\
\mbox{i}^{3}
\end{array}\right],\,\mathbf{v}_{3}=\left[\begin{array}{c}
1\\
\mbox{i}^{2}\\
\mbox{i}^{4}\\
\mbox{i}^{6}
\end{array}\right],\,\mathbf{v}_{4}=\left[\begin{array}{c}
1\\
\mbox{i}^{3}\\
\mbox{i}^{6}\\
\mbox{i}^{9}
\end{array}\right],\]</span>
which is equivalent to <span class="math display">\[\mathbf{V}=\left[\begin{array}{cccc}
1 &amp; 1 &amp; 1 &amp; 1\\
1 &amp; \mbox{i} &amp; \mbox{i}^{2} &amp; \mbox{i}^{3}\\
1 &amp; \mbox{i}^{2} &amp; \mbox{i}^{4} &amp; \mbox{i}^{6}\\
1 &amp; \mbox{i}^{3} &amp; \mbox{i}^{6} &amp; \mbox{i}^{9}
\end{array}\right]=\mathbf{F}_{4},\]</span>
a <span class="math inline">\(4\times4\)</span> <a href="ch-representation.html#sub:dualBasis">Fourier matrix</a>.</p>
<p>Let’s generalize this setting to any time series <span class="math inline">\(\mathbf{x}=[x_{1},\dots,x_{T-1}]^{\top}\)</span> and its data embedding manifold
<span class="math display">\[\mathbf{M}=x_{1}\mathbf{I}+x_{2}\mathbf{L}+\cdots+x_{T-1}\mathbf{L}^{T-1}.\]</span>
For the <span class="math inline">\(k\)</span>-th eigenvector <span class="math inline">\(\mathbf{v}_{k}\)</span>, the eigen-decomposition <span class="math inline">\(\mathbf{M}\mathbf{v}_{k}=\lambda_{k}\mathbf{v}_{k}\)</span>
implies that<span class="math display">\[\left(x_{1}\mathbf{I}+x_{2}\mathbf{L}+\cdots+x_{T-1}\mathbf{L}^{T-1}\right)\mathbf{v}_{k}=\left(x_{1}+x_{2}\lambda_{k}+\cdots+x_{T-1}\lambda_{k}^{T-1}\right)\mathbf{v}_{k}.\]</span>
We know for the elemantary permutation matrix <span class="math inline">\(\mathbf{L}\)</span>, the eigenvalue follows <span class="math inline">\(\lambda_{k}=\mbox{e}^{2\pi\mbox{i}(k-1)/T}\)</span>. So the vector of eigenvalues follows <span class="math display">\[\left[\begin{array}{c}
\lambda_{1}\\
\lambda_{2}\\
\vdots\\
\lambda_{T}
\end{array}\right]=\left[\begin{array}{c}
x_{1}+x_{2}+\cdots+x_{T}\\
x_{1}+x_{2}\mbox{e}^{2\pi\mbox{i}/T}+\cdots+x_{T}\mbox{e}^{2\pi\mbox{i}(T-1)/T}\\
\vdots\\
x_{1}+x_{2}\mbox{e}^{2\pi\mbox{i}(T-1)/T}+\cdots+x_{T}\mbox{e}^{2\pi\mbox{i}(T-1)(T-1)}
\end{array}\right]=\mathbf{F}_{T}\left[\begin{array}{c}
x_{1}\\
x_{2}\\
\vdots\\
x_{T}
\end{array}\right].\]</span>
In other words, the eigenvalues of manifold <span class="math inline">\(\mathbf{M}\)</span> are nothing else but the Fourier transform of the embedded time series <span class="math inline">\(\mathbf{x}\)</span>. The first eigenvalue relates to the sum of the series, namely the Fourier transformation of <span class="math inline">\(\mathbf{x}\)</span> under the frequency <span class="math inline">\(2\pi\mbox{i}\times0/T\)</span>; the second eigenvalue relates to the Fourier transformation of <span class="math inline">\(\mathbf{x}\)</span> under the frequency <span class="math inline">\(2\pi\mbox{i}/T\)</span>, and so on. We can see that the lower ranked eigenvalue corresponds to the higher frequency of the transformation.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div id="sub:heatEq" class="section level2">
<h2>
<span class="header-section-number">18.1</span> Miscellaneous: Harmonic Function, Heat Equation, Exponential Family</h2>
<p>For an <a href="ch-complexAn.html#sub:complexCal">analytic function</a> <span class="math inline">\(f(z)=u(x,y)+\mbox{i}v(x,y)\)</span>, we have seen how to connect the real and imaginary parts of the function through the <a href="ch-complexAn.html#sub:complexCal">Cauchy-Riemann relations</a>.
Now suppose we are only interested in the real parts of the complex function <span class="math inline">\(f(z)\)</span>, namely <span class="math inline">\(u(x,y)\)</span>. YYou may wonder what would be the analytic revelation accompanying this real-valued function <span class="math inline">\(u(x,y)\)</span>.</p>
<p>The revelation comes with an operation of the second-order <a href="ch-DE.html#sub:pde">partial derivatives</a>.
Suppose <span class="math inline">\(f\)</span> satisfies the <a href="ch-complexAn.html#sub:complexCal">Cauchy-Riemann relations</a> so that <span class="math inline">\(f\)</span> is analytic and has continuous partial derivatives. Differentiating both sides of one Cauchy-Riemann equation <span class="math inline">\(\frac{\partial u}{\partial x}=\frac{\partial v}{\partial y}\)</span>
with respect to <span class="math inline">\(x\)</span>
and differentiating both sides of the other Cauchy-Riemann equation <span class="math inline">\(\frac{\partial u}{\partial y}=-\frac{\partial v}{\partial x}\)</span> with respect to <span class="math inline">\(y\)</span>, we have
<span class="math display">\[\frac{\partial^{2}u}{\partial x^{2}}=\frac{\partial^{2}v}{\partial x\partial y},\quad\frac{\partial^{2}u}{\partial y^{2}}=-\frac{\partial^{2}v}{\partial y\partial x}.\]</span>
By adding the two equations, we obtain an equation of the second-order <a href="ch-DE.html#sub:pde">partial derivatives</a> of <span class="math inline">\(u(x,y)\)</span>: <span class="math display">\[\frac{\partial^{2}u}{\partial x^{2}}+\frac{\partial^{2}u}{\partial y^{2}}=\Delta u(x,y)=0,\]</span>
where <span class="math inline">\(\Delta\)</span> represents the <a href="ch-MatComp.html#sub:vecSpaces">operator</a> that sums up all the second-order <a href="ch-DE.html#sub:pde">partial derivatives</a> and is called the <em>Laplacian operator</em>. The real-valued function <span class="math inline">\(u(x,y)\)</span> is said to be <em>harmonic</em> if <span class="math inline">\(\Delta u(x,y)=0\)</span>. In other words, for an <a href="ch-complexAn.html#sub:complexCal">analytic function</a> <span class="math inline">\(f(z)=u(x,y)+\mbox{i}v(x,y)\)</span>, the real part of the <a href="ch-complexAn.html#sub:complexCal">analytic function</a> should be <strong>harmonic</strong>.<label for="tufte-sn-570" class="margin-toggle sidenote-number">570</label><input type="checkbox" id="tufte-sn-570" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">570</span> In a similar manner, we can attain <span class="math display">\[\frac{\partial^{2}u}{\partial y\partial x}=\frac{\partial^{2}v}{\partial y^{2}},\\
\frac{\partial^{2}u}{\partial x\partial u}=-\frac{\partial^{2}v}{\partial x^{2}},\]</span>
namely <span class="math inline">\(\Delta v(x,y)=0\)</span>. So the imaginary part of the analytic function is also a <strong>harmonic function</strong>. The function <span class="math inline">\(v(x,y)\)</span> is called a <em>harmonic conjugate</em> of <span class="math inline">\(u(x,y)\)</span>.
Two <strong>harmonic functions</strong> are said to be <strong>harmonic conjugate</strong> if they satisfy the <a href="ch-complexAn.html#sub:complexCal">Cauchy-Riemann relations</a>.</span></p>
<p>Notice that the one-dimensional <strong>Laplacian operator</strong> is nothing else but a second-order differentiation <span class="math inline">\(\Delta f(x)=\mbox{d}^2 f(x)/\mbox{d} x^2\)</span>. We have seen in chapter <a href="ch-representation.html#sub:innerProd">14.2</a> that the <a href="ch-representation.html#sub:innerProd">eigenfunctions</a> of this <strong>Laplacian</strong> <span class="math inline">\(\Delta\)</span> are the trigonometric functions <span class="math inline">\(\sin(\theta x)\)</span> and <span class="math inline">\(\cos(\theta x)\)</span> where <span class="math inline">\((\pm\theta)^2 =\lambda\)</span> are the eigenvalues of <span class="math inline">\(\Delta\)</span>.
Discretizing the <span class="math inline">\(\lambda\)</span> by some integers from <span class="math inline">\(\mathbb{Z}\)</span>, i.e., <span class="math inline">\(\lambda=k^2\)</span> for <span class="math inline">\(k\in\mathbb{Z}\)</span>, we formed the <a href="ch-representation.html#sub:innerProd">Fourier basis</a> functions, i.e., <span class="math inline">\(\phi_k(x) = \mbox{e}^{\mbox{i}kx}\)</span>. Thus, if we have a <strong>harmonic function</strong>, we expect the function to associate with some nice base systems like the <a href="ch-representation.html#sub:innerProd">Fourier bases</a>.</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:heatDif"></span>
<img src="fig/Part5/heat.gif" alt="Distribution of the heat" width="100%"><!--
<p class="caption marginnote">-->Figure 18.1: Distribution of the heat<!--</p>-->
<!--</div>--></span>
</p>
<p>On the other hand, we can think that a <strong>harmonic function</strong> is (at least locally) a part of an <a href="ch-complexAn.html#sub:complexCal">analytic function</a>.Suppose we have a nice base system induced by the harmonic function on <span class="math inline">\(\mathbb{R}^n\)</span>. In that case, the system can be extended to an analytic complex system in <span class="math inline">\(\mathbb{C}^{n}\)</span> where the <a href="ch-complexAn.html#sub:coupling">complexified system</a> becomes <a href="ch-complexAn.html#sub:complexCal">infinite differentiable</a>, , and some <a href="ch-complexAn.html#sub:complexCal">complex polynomials</a> can represent the derivative operations of the new system.</p>
<p>Using the <strong>harmonic condition</strong> to derive some invariant representations and linking some complex phenomena to simple harmonic bases, these two paths somehow point to the big picture of the harmonic analysis.</p>
<div class="solution">
<p class="solution-begin">
Code for generating heat distributions <span id="sol-start-128" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-128', 'sol-start-128')"></span>
</p>
<div id="sol-body-128" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" data-line-number="1"><span class="co"># Discrete spatial location points</span></a>
<a class="sourceLine" id="cb189-2" data-line-number="2">x =<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dt">len=</span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb189-3" data-line-number="3">y =<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dt">len=</span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb189-4" data-line-number="4">xy =<span class="st"> </span><span class="kw">expand.grid</span>(x,y)</a>
<a class="sourceLine" id="cb189-5" data-line-number="5"></a>
<a class="sourceLine" id="cb189-6" data-line-number="6"><span class="co">#Initial time</span></a>
<a class="sourceLine" id="cb189-7" data-line-number="7">t0 =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb189-8" data-line-number="8"><span class="co">#Time increment</span></a>
<a class="sourceLine" id="cb189-9" data-line-number="9">dt =<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb189-10" data-line-number="10"><span class="co"># Temperature at t0</span></a>
<a class="sourceLine" id="cb189-11" data-line-number="11">heat =<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb189-12" data-line-number="12"><span class="co"># sigma2 squared or c_d</span></a>
<a class="sourceLine" id="cb189-13" data-line-number="13">sigma2=<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb189-14" data-line-number="14"></a>
<a class="sourceLine" id="cb189-15" data-line-number="15"><span class="co"># 2D heat kernel</span></a>
<a class="sourceLine" id="cb189-16" data-line-number="16">heat.kernel =<span class="st"> </span><span class="cf">function</span>(x,y,t){(heat<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">4</span><span class="op">*</span>t<span class="op">/</span>sigma2))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">**</span><span class="dv">2</span><span class="op">+</span>y<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">4</span><span class="op">*</span>t<span class="op">*</span>sigma2))}</a>
<a class="sourceLine" id="cb189-17" data-line-number="17">solve.vec =<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb189-18" data-line-number="18"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb189-19" data-line-number="19">    u =<span class="st"> </span><span class="kw">heat.kernel</span>(xy[<span class="dv">1</span>],xy[<span class="dv">2</span>],t0)</a>
<a class="sourceLine" id="cb189-20" data-line-number="20">    t0 =<span class="st"> </span>t0 <span class="op">+</span><span class="st"> </span>dt</a>
<a class="sourceLine" id="cb189-21" data-line-number="21">    solve.vec=<span class="kw">c</span>(solve.vec,u)</a>
<a class="sourceLine" id="cb189-22" data-line-number="22">}</a>
<a class="sourceLine" id="cb189-23" data-line-number="23"></a>
<a class="sourceLine" id="cb189-24" data-line-number="24"><span class="co"># Plot</span></a>
<a class="sourceLine" id="cb189-25" data-line-number="25"><span class="kw">library</span>(plot3D)</a>
<a class="sourceLine" id="cb189-26" data-line-number="26">t =<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb189-27" data-line-number="27">solution =<span class="st"> </span><span class="kw">unlist</span>(solve.vec[t], <span class="dt">recursive=</span><span class="ot">TRUE</span>, <span class="dt">use.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb189-28" data-line-number="28">sol.matrix =<span class="st"> </span><span class="kw">matrix</span>(solution, <span class="dt">nrow=</span><span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb189-29" data-line-number="29"><span class="kw">persp3D</span>(x,y,<span class="dt">z=</span>sol.matrix, <span class="dt">image =</span> <span class="ot">FALSE</span>, <span class="dt">zlab=</span><span class="st">"f"</span>, <span class="dt">expand =</span> <span class="fl">0.5</span>, <span class="dt">zlim=</span> <span class="kw">c</span>(<span class="op">-</span><span class="kw">min</span>(sol.matrix), <span class="dv">4</span>), <span class="dt">colkey=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">"Time = "</span>, t))</a></code></pre></div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>One way to understand harmonicity and invariance is to consider the equilibrium state in <a href="ch-DE.html#sub:pde">heat diffusion</a> problems. In chapter <a href="ch-DE.html#sub:pde">8.5</a>, we considered the <a href="ch-DE.html#sub:pde">heat equation</a> in one dimension. Now we extend the problem to two dimensions. The following <em>two-dimensional heat equation</em> describes the dynamics in figure <a href="ch-harmonicAn.html#fig:heatDif">18.1</a>:
<span class="math display">\[\frac{\partial f(x,y,t)}{\partial t}=-c_{D}\left(\frac{\partial^{2}f}{\partial x^{2}}+\frac{\partial^{2}f}{\partial y^{2}}\right)=-c_{D}\Delta f(x,y,t).\]</span>
The <strong>harmonic equation</strong> <span class="math inline">\(\Delta f(x,y,t)=0\)</span> can be thought of as the <a href="ch-DE.html#sub:ode">steady-state</a> or <a href="ch-DE.html#sub:ode">equilibrium solution</a> when there is no heat diffusing in the system, namely <span class="math inline">\(\partial f(x,y,t)/\partial t =0\)</span>. The <strong>Laplacian operator</strong> only counts for the changes regarding the spatial variables <span class="math inline">\((x,y)\)</span>, excluding the time variable <span class="math inline">\(t\)</span>.</p>
<p>To make things more transparent, let’s separate <span class="math inline">\(f\)</span> into two parts, <span class="math inline">\(f(x,y,t)=K(x,y)u(t)\)</span>, where <span class="math inline">\(K(\cdot,\cdot)\)</span> is a function capturing the spatial interaction effect between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, and <span class="math inline">\(u(t)\)</span> is the function capturing the dynamical effect. The <strong>2D heat equation</strong> becomes <span class="math display">\[K(x,y)\frac{\mbox{d}u(t)}{\mbox{d}t}=-c_{D}u(t)\Delta K(x,y).\]</span>
Rearrange the expression and assume an unknown constant <span class="math inline">\(c\)</span> for ratios <span class="math display">\[\frac{\mbox{d}u(t)}{\mbox{d}t}\frac{1}{u(t)}=-c_{D}\frac{\Delta K(x,y)}{K(x,y)}=c.\]</span> We arrive in two separate systems. The interaction system forms an eigenvalue problem <span class="math inline">\(\Delta K=\lambda K\)</span> where <span class="math inline">\(\lambda=-c/c_{D}\)</span>, and <span class="math inline">\(K(\cdot,\cdot)\)</span> relates to a kind of the multivariate <a href="ch-representation.html#sub:innerProd">eigenfunction</a> of the <strong>Laplacian operator</strong> <span class="math inline">\(\Delta\)</span>. After solving the eigenvalue <span class="math inline">\(\lambda\)</span>, the value of <span class="math inline">\(c\)</span> becomes available, and so does the solution of the dynamical system <span class="math inline">\(\mbox{d}u(t)/\mbox{d}t=c\)</span>.</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:ReprodHeat"></span>
<img src="fig/Part5/ReprodHeat.png" alt="Reproduce the 1-rank heat matrix" width="100%"><!--
<p class="caption marginnote">-->Figure 18.2: Reproduce the 1-rank heat matrix<!--</p>-->
<!--</div>--></span>
</p>
<p>The <strong>Laplacian operator</strong> can be rewritten as<label for="tufte-sn-571" class="margin-toggle sidenote-number">571</label><input type="checkbox" id="tufte-sn-571" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">571</span> Because the <a href="ch-vecMat.html#sub:linearity">gradient operators</a> are linear, the inner product of the two <a href="ch-vecMat.html#sub:linearity">gradient operators</a> is still linear. So Laplacian operator is also a <a href="ch-MatComp.html#sub:vecSpaces">linear operator</a>.</span>
<span class="math display">\[\begin{align*}\Delta K  &amp;=\frac{\partial^{2}K}{\partial x^{2}}+\frac{\partial^{2}K}{\partial y^{2}}\\
&amp;=\underset{\nabla^{\mbox{H}}}{\underbrace{\left(\frac{\partial}{\partial x}-\mbox{i}\frac{\partial}{\partial y}\right)}}\underset{\nabla K}{\underbrace{\left(\frac{\partial K}{\partial x}+\mbox{i}\frac{\partial K}{\partial y}\right)}}= \nabla^{\mbox{H}}\nabla K.
\end{align*}\]</span>
Let <span class="math inline">\(\phi\)</span> and <span class="math inline">\(\psi\)</span> be the eigenfunctions of the <a href="ch-vecMat.html#sub:linearity">gradient operator</a> <span class="math inline">\(\nabla\)</span> and the <a href="ch-vecMat.html#sub:linearity">adjoint operator</a> <span class="math inline">\(\nabla^{\mbox{H}}\)</span>, respectively. These functions should share the same eigenvalues.<label for="tufte-sn-572" class="margin-toggle sidenote-number">572</label><input type="checkbox" id="tufte-sn-572" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">572</span> Recall that the <a href="ch-UnMulti.html#sub:rw">left-hand eigenvector</a> and the <a href="ch-UnMulti.html#sub:rw">right-hand eigenvector</a>, though probably different, must share the same eigenvalues.</span> So we can decompose <span class="math inline">\(K\)</span> by <span class="math inline">\(\nabla^{\mbox{H}}\nabla K=\lambda K=\lambda\phi\psi\)</span> where <span class="math inline">\(\nabla\phi=\sqrt{\lambda}\phi\)</span> and <span class="math inline">\(\nabla^{\mbox{H}}\psi=\sqrt{\lambda}\psi\)</span>.</p>
<p>The above decomposition tells that two 1D <a href="ch-representation.html#sub:innerProd">orthonormal bases</a> can represent the 2D spatial variation in <span class="math inline">\(K(\cdot,\cdot)\)</span>. We illustrate this decomposition using the data generated by a <strong>2D heat equation</strong>.
Suppose we have two series of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, such that <span class="math inline">\(\mathbf{x},\mathbf{y}\in\mathbb{R}^{N}\)</span>. Now the realizations of <span class="math inline">\(K(\cdot,\cdot)\)</span> are recorded in a matrix
<span class="math display">\[\mathbf{K}=\left[\begin{array}{ccc}
K(x_{1},y_{1}) &amp; \cdots &amp; K(x_{1},y_{N})\\
\vdots &amp; \ddots &amp; \vdots\\
K(x_{N},y_{1}) &amp; \cdots &amp; K(x_{n},y_{N})
\end{array}\right].\]</span>
By the <a href="ch-complexAn.html#sub:ImRelation">singular value decomposition</a>, we can decompose <span class="math inline">\(\mathbf{K}\)</span> as
<span class="math display">\[\mathbf{K} = \mathbf{U}\mathbf{\Sigma}\mathbf{V}^{\top} =\underset{\Phi}{\underbrace{\left(\mathbf{U}\sqrt{\mathbf{\Sigma}}\right)}}\underset{\Psi^{\top}}{\underbrace{(\mathbf{V}\sqrt{\mathbf{\Sigma}})^{\top}}}=\Phi \Psi^{\top}.\]</span>
Note that <span class="math inline">\([\mathbf{K}^{\top}\mathbf{K}]_{ij}=\sum_{k=1}^{N}K(y_{i},x_{k})K(x_{k},y_{j})\)</span> and <span class="math inline">\([\mathbf{K}\mathbf{K}^{\top}]_{ij}=\sum_{k=1}^{N}K(x_{i},y_{k})K(y_{k},x_{j})\)</span>. Thus the matrix <span class="math inline">\(\mathbf{U}\)</span>, as the eigenvector matrix of <span class="math inline">\(\mathbf{K}\mathbf{K}^{\top}\)</span>, is the basis contributed by the input <span class="math inline">\(\mathbf{x}\)</span>, and <span class="math inline">\(\mathbf{V}\)</span>, as the eigenvector matrix <span class="math inline">\(\mathbf{V}\)</span> of <span class="math inline">\(\mathbf{K}^{\top}\mathbf{K}\)</span>, is the basis contributed by the input <span class="math inline">\(\mathbf{y}\)</span>.<label for="tufte-sn-573" class="margin-toggle sidenote-number">573</label><input type="checkbox" id="tufte-sn-573" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">573</span> The matrix <span class="math inline">\(\mathbf{K}\)</span> is extremely singular, i.e. a <a href="ch-MatComp.html#sub:vecSpaces">rank</a>-<span class="math inline">\(1\)</span> matrix <span class="math inline">\(\mbox{rank}(\mathbf{K})=1\)</span>. There is a compact representation for <span class="math inline">\(\mathbf{K}\)</span> such that
<span class="math display">\[\mathbf{K} =\Phi \Psi^{\top} = \sigma_1\phi_1(\mathbf{x}) \psi_1^{\top}(\mathbf{y})\]</span> where <span class="math inline">\(\phi_1(\mathbf{x})\)</span> and <span class="math inline">\(\psi_1(\mathbf{y})\)</span> are the leading eigenvectors in <span class="math inline">\(\Phi\)</span> and <span class="math inline">\(\Psi\)</span> respectively, and <span class="math inline">\(\sigma_1\)</span> is the leading <a href="ch-complexAn.html#sub:ImRelation">singular value</a>. In this case, the function <span class="math inline">\(K(x,y)\)</span> can be thought of as the “<a href="ch-vecMat.html#sub:matrix">outer-product</a>” of two basis functions <span class="math inline">\(\phi(x)\)</span> and <span class="math inline">\(\psi(y)\)</span> that respectively span the spaces of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. See figure <a href="ch-harmonicAn.html#fig:ReprodHeat">18.2</a>. The “outer product” can be formally defined as a tensor product which we will discuss in ch[?].</span></p>
<div class="solution">
<p class="solution-begin">
Reproduction <span id="sol-start-129" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-129', 'sol-start-129')"></span>
</p>
<div id="sol-body-129" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb190-1" data-line-number="1"><span class="co"># tensor kernel</span></a>
<a class="sourceLine" id="cb190-2" data-line-number="2">t =<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb190-3" data-line-number="3">solution =<span class="st"> </span><span class="kw">unlist</span>(solve.vec[t], <span class="dt">recursive=</span><span class="ot">TRUE</span>, <span class="dt">use.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb190-4" data-line-number="4">sol.matrix =<span class="st"> </span><span class="kw">matrix</span>(solution, <span class="dt">nrow=</span><span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb190-5" data-line-number="5">K =<span class="st"> </span><span class="kw">matrix</span>(solution, <span class="dt">nrow=</span><span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb190-6" data-line-number="6"></a>
<a class="sourceLine" id="cb190-7" data-line-number="7">phi=<span class="kw">svd</span>(K)<span class="op">$</span>u<span class="op">%*%</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="kw">sqrt</span>(<span class="kw">svd</span>(K)<span class="op">$</span>d[<span class="dv">1</span>]),<span class="kw">rep</span>(<span class="dv">0</span>,(<span class="kw">length</span>(x)<span class="op">-</span><span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb190-8" data-line-number="8">psi=<span class="kw">svd</span>(K)<span class="op">$</span>v<span class="op">%*%</span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="kw">sqrt</span>(<span class="kw">svd</span>(K)<span class="op">$</span>d[<span class="dv">1</span>]),<span class="kw">rep</span>(<span class="dv">0</span>,(<span class="kw">length</span>(y)<span class="op">-</span><span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb190-9" data-line-number="9">phi1=phi[,<span class="dv">1</span>];psi1=psi[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb190-10" data-line-number="10">K.matrix=<span class="kw">outer</span>(phi1,psi1,<span class="st">"*"</span>)</a>
<a class="sourceLine" id="cb190-11" data-line-number="11"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb190-12" data-line-number="12"><span class="kw">persp3D</span>(x,y,<span class="dt">z=</span>sol.matrix, <span class="dt">image =</span> <span class="ot">FALSE</span>, <span class="dt">zlab=</span><span class="st">"f"</span>, <span class="dt">expand =</span> <span class="fl">0.5</span>, <span class="dt">zlim=</span> <span class="kw">c</span>(<span class="op">-</span><span class="kw">min</span>(sol.matrix), <span class="dv">4</span>), <span class="dt">colkey =</span> <span class="kw">list</span>(<span class="dt">side =</span> <span class="dv">1</span>), <span class="dt">scale =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">"Heat distribution at t = 20"</span>)</a>
<a class="sourceLine" id="cb190-13" data-line-number="13"><span class="kw">persp3D</span>(x,y,<span class="dt">z=</span>K.matrix, <span class="dt">image =</span> <span class="ot">FALSE</span>, <span class="dt">zlab=</span><span class="st">"f"</span>, <span class="dt">expand =</span> <span class="fl">0.5</span>, <span class="dt">zlim=</span> <span class="kw">c</span>(<span class="op">-</span><span class="kw">min</span>(sol.matrix), <span class="dv">4</span>), <span class="dt">colkey =</span> <span class="kw">list</span>(<span class="dt">side =</span> <span class="dv">1</span>), <span class="dt">scale =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">"Reproducing by two eigenvectors "</span>)</a></code></pre></div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>So far, things go well on two dimensions. But we have to keep in mind that we assume that the <strong>2D heat equation</strong> is separable as <span class="math inline">\(f(x,y,t)=K(x,y)u(t)\)</span>. If we drop this assumption, we should think about parameterizing <span class="math inline">\(K(x,y)\)</span> with the time parameter <span class="math inline">\(t\)</span>, namely a time-varying 2-dimensional “multivariate eigenfunction.”<label for="tufte-sn-574" class="margin-toggle sidenote-number">574</label><input type="checkbox" id="tufte-sn-574" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">574</span> Another way is to consider a 3-dimensional “multivariate eigenfunction,” i.e., <span class="math inline">\(K(x,y,t)\)</span>. The way is analogous to construct a triple “product” of three basis functions. However, according to some spatial-temporal philosophical doctrine, the “product” seems to blend two different basic matters, time and space. Also, the triple “product” is not computationally attractive as it faces the <a href="sub-continuity.html#sub:continuousFunc">curse of dimensionality</a>. Unlike the spatial structure, the long memory encoded in the time <span class="math inline">\(t\)</span> is hardly decomposable. The rank-<span class="math inline">\(1\)</span> example in figure <a href="ch-harmonicAn.html#fig:ReprodHeat">18.2</a> only uses two eigenvectors, namely <span class="math inline">\(2\times 100\)</span>, to reproduce the <span class="math inline">\(100\times 100\)</span> <span class="math inline">\(\mathbf{K}\)</span> matrix. But if we extend the matrix <span class="math inline">\(\mathbf{K}\)</span> to a short time period of <span class="math inline">\(100\)</span> time points, we may probably need to store a large portion of the <span class="math inline">\(200\times 100\)</span> data points rather than three eigenvectors, namely <span class="math inline">\(3\times 100\)</span> data points.</span></p>
<p>Here is some intuition about our planned tour of the parameterization. Let’s assume that <span class="math inline">\(\mathbf{A}\)</span> is a <a href="ch-MatComp.html#sub:vecSpaces">linear operator</a> where the following differential problem <span class="math display">\[\frac{\partial K}{\partial t}=\mathbf{A}K,\quad K(x,y,0)=f(x,y,0)\]</span>
admits a solution form <span class="math inline">\(K(x,y,t)=(\mbox{e}^{t\mathbf{A}})f(x,y,0)\)</span>.<label for="tufte-sn-575" class="margin-toggle sidenote-number">575</label><input type="checkbox" id="tufte-sn-575" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">575</span> The solution form <span class="math inline">\((\mbox{e}^{t\mathbf{A}})f(x,y,0)\)</span> can reversely define the meaning of operator <span class="math inline">\(\mathbf{A}\)</span> by the following limit:
<span class="math display">\[\lim_{t\rightarrow0}\frac{e^{\mathbf{A}t}f-f}{t}=\mathbf{A}f.\]</span> In this case, we call <span class="math inline">\(\mathbf{A}\)</span> the <a href="ch-representation.html#sub:pseudoRandom">generator</a> of <span class="math inline">\(K(x,y,t)=(e^{t\mathbf{A}})f(x,y,0)\)</span>.</span> Suppose that we replace the notation <span class="math inline">\(\mathbf{A}\)</span> with the <strong>Laplacian operator</strong> <span class="math inline">\(\Delta\)</span>, and suppose the above statement still holds, then we would obtain a parameterized solution.</p>
<p>The above idea of parameterization is rooting in the applications of abstract exponential objects, such as <span class="math inline">\(\mbox{e}^{t\Delta}\)</span>. To grab the meanings of these abstract exponential objects, we need some knowledge about the <strong>binary operation</strong> and the <strong>group</strong> structure.<label for="tufte-sn-576" class="margin-toggle sidenote-number">576</label><input type="checkbox" id="tufte-sn-576" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">576</span> Recall that the addition and multiplication of real numbers are both <strong>binary operations</strong>. That is, both addition and multiplication combine two real numbers to obtain one real number. In a nutshell, a binary operation is to associating two objects in a given order that will result in one object as the answer.</span></p>
<ul>
<li>
<strong>Binary operation</strong> and <strong>algebraic structure</strong> : A <em>binary operation</em> <span class="math inline">\(\ast\)</span> on a set <span class="math inline">\(\mathcal{V}\)</span>
is a function mapping <span class="math inline">\(\mathcal{V}\times\mathcal{V}\)</span> into <span class="math inline">\(\mathcal{V}\)</span>, namely <span class="math display">\[\ast(\cdot,\cdot):\mathcal{V}\times\mathcal{V}\rightarrow\mathcal{V}.\]</span> For each <span class="math inline">\((f,g)\in\mathcal{V}\times\mathcal{V}\)</span>, the function <span class="math inline">\(\ast(f,g)\)</span> is denoted by <span class="math inline">\(f\ast g\)</span>.
The set <span class="math inline">\(\mathcal{V}\)</span> equipped with the <strong>binary operation</strong> <span class="math inline">\(\ast\)</span> forms an <em>algebraic structure</em> that is denoted by <span class="math inline">\((\mathcal{V},\ast)\)</span>.</li>
</ul>
<p>The definition tells that a <strong>binary operation</strong> gives an <a href="sub-logic.html#sub:ex-computer">algebra</a> on the set <span class="math inline">\(\mathcal{V}\)</span>. Let’s consider <span class="math inline">\(x\ast x\)</span> and let <span class="math inline">\(\ast\)</span> denote any <strong>binary operation</strong>. If <span class="math inline">\(\ast=+\)</span>, for any <span class="math inline">\(a\in\mathbb{R}\)</span>, <span class="math inline">\(x\ast x=x+x=a\)</span> has a solution <span class="math inline">\(x=a/2\in\mathbb{R}\)</span>. However, if <span class="math inline">\(\ast=\times\)</span>, then for some <span class="math inline">\(a\in\mathbb{R}\)</span>, <span class="math inline">\(x\ast x=x\times x=a\)</span> may have no solution, e.g., <span class="math inline">\(a&lt;0\)</span>. In this case, we can see that when the same set of <span class="math inline">\(\mathbb{R}\)</span> is equipped with a different <strong>binary operation</strong>, it displays a very <strong>algebraic structure</strong>. However, sometimes two different sets with very different <strong>binary operations</strong> turn out to have the same <strong>algebraic structure</strong>. For example, the <strong>algebraic structure</strong> <span class="math inline">\((\mathbb{R},+)\)</span> is the same as the algebraic structure <span class="math inline">\((\mathbb{R}^{+}, \times)\)</span> under the exponential function <span class="math inline">\(\mbox{e}^{(\cdot)}:\mathbb{R}\rightarrow\mathbb{R}^{+}\)</span>:
<span class="math display">\[\mbox{e}^{s+t}=\mbox{e}^{s}\times\mbox{e}^{t},\,  \mbox{ for } s,t\in\mathbb{R}.\]</span>
In another way, we can write as <span class="math display">\[\psi(t\ast s)=\mbox{e}^{(t+s)}=\mbox{e}^{t}\times\mbox{e}^{s}=\psi(t)\ast'\psi(s)\]</span>
which says that two <strong>binary algebraic structures</strong>, one for <span class="math inline">\(s\)</span> and <span class="math inline">\(t\)</span> in <span class="math inline">\((\mathcal{V},\ast)\)</span>
and the other for <span class="math inline">\(\mbox{e}^{s}\)</span> and <span class="math inline">\(\mbox{e}^{t}\)</span> in <span class="math inline">\((\mathcal{V}',\ast')\)</span>,
are structurally alike, called <strong>isomorphism</strong>, under the <a href="sub-set-theory.html#sub:func">bijective</a> map <span class="math inline">\(\psi=\mbox{e}^{(\cdot)}\)</span>.<label for="tufte-sn-577" class="margin-toggle sidenote-number">577</label><input type="checkbox" id="tufte-sn-577" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">577</span> Let <span class="math inline">\((\mathcal{V},\ast)\)</span> and <span class="math inline">\((\mathcal{V}',\ast')\)</span> be <strong>binary algebraic structures</strong>. An <em>isomorphism</em> of <span class="math inline">\(\mathcal{V}\)</span> with <span class="math inline">\(\mathcal{V}'\)</span> is a one-to-one function <span class="math inline">\(\psi\)</span> mapping <span class="math inline">\(\mathcal{V}\)</span> onto <span class="math inline">\(\mathcal{V}'\)</span> such that <span class="math inline">\(\phi(f\ast g)=\phi(f)\ast'\phi(g)\)</span> for all <span class="math inline">\(x,y\in\mathcal{V}\)</span>. </span></p>
<ul>
<li>
<em>Group</em> : A <strong>group</strong> is a <strong>binary algebraic structure</strong> <span class="math inline">\((\mathcal{G},\ast)\)</span> such that the following axioms regarding on <span class="math inline">\(\ast\)</span> are satisfied:<label for="tufte-sn-578" class="margin-toggle sidenote-number">578</label><input type="checkbox" id="tufte-sn-578" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">578</span> Notice that <strong>binary algebraic structures</strong> with weaker axioms about one side identity element and one side inverse will lead us to the <a href="ch-randomization.html#sub:global">semigroup</a> structure. The <em>left identity element</em> <span class="math inline">\(\mbox{Id}\)</span> for <span class="math inline">\(\ast\)</span> only holds for <span class="math inline">\(\mbox{Id}\ast x=x\)</span> for all <span class="math inline">\(x\in\mathcal{G}\)</span>. For each <span class="math inline">\(x\in\mathcal{G}\)</span>, if there is an element <span class="math inline">\(y\in\mathcal{G}\)</span> such that <span class="math inline">\(y\ast x=\mbox{Id}\)</span>, then <span class="math inline">\(y\)</span> is the <em>left inverse</em> of <span class="math inline">\(x\)</span>. The right identity and the right inverse can be defined in a similar fashion.</span>
</li>
</ul>
<ol style="list-style-type: decimal">
<li><p>Associativity: <span class="math inline">\((f\ast g)\ast h=f\ast(g\ast h)\)</span>
for all <span class="math inline">\(f,g,h\in\mathcal{G}\)</span>.<label for="tufte-sn-579" class="margin-toggle sidenote-number">579</label><input type="checkbox" id="tufte-sn-579" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">579</span> Associativity holds for all elements in the <strong>binary algebraic structures</strong> <span class="math inline">\((\mathbb{F},+)\)</span> and <span class="math inline">\((\mathbb{F},\times)\)</span>.</span></p></li>
<li><p>Existence of an <em>identity element</em> <span class="math inline">\(\mbox{Id}\)</span>: <span class="math inline">\(\mbox{Id} \ast f=f\ast \mbox{Id}=f\)</span> for all <span class="math inline">\(f\in\mathcal{G}\)</span>.<label for="tufte-sn-580" class="margin-toggle sidenote-number">580</label><input type="checkbox" id="tufte-sn-580" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">580</span> Note that the <strong>identity element</strong> <span class="math inline">\(\mbox{Id}\)</span> often appears in different notations under different contexts. For example, <span class="math inline">\(0\)</span> denotes an additive <strong>identity element</strong> in <span class="math inline">\((\mathbb{R},+)\)</span> and <span class="math inline">\(1\)</span> denotes the multiplicative <strong>identity element</strong> in <span class="math inline">\((\mathbb{R},\times)\)</span>. Furthermore, vectors <span class="math inline">\(\mathbf{0}\)</span> and <span class="math inline">\(\mathbf{1}\)</span> are the <strong>identity elements</strong> in <span class="math inline">\((\mathbb{F}^{n},+)\)</span> and <span class="math inline">\((\mathbb{F}^{n},\times)\)</span>, respectively.</span></p></li>
<li><p>Existence of the inverse: For each <span class="math inline">\(f\in\mathcal{G}\)</span>, there is an element <span class="math inline">\(g\in\mathcal{G}\)</span> such that <span class="math inline">\(f\ast g=g\ast f= \mbox{Id}\)</span>. The element <span class="math inline">\(g\)</span> is the inverse of <span class="math inline">\(f\)</span> denoted by <span class="math inline">\(f^{-1}\)</span>.</p></li>
</ol>
<p>We can see that if we let <span class="math inline">\(\mathcal{G}=\{ \mbox{e}^{x}: x\in \mathbb{F} \}\)</span>, then <span class="math inline">\((\mathcal{G}, \times)\)</span> is a <strong>group</strong>.<label for="tufte-sn-581" class="margin-toggle sidenote-number">581</label><input type="checkbox" id="tufte-sn-581" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">581</span> Since <span class="math inline">\(\mathbf{e}^{x}\in \mathbb{F}\)</span>, the associativity holds for the multiplication. The identity element is <span class="math inline">\(1\)</span>. The inverse is <span class="math inline">\(\mbox{e}^{(-x)}\)</span>.</span></p>
<p>All the <span class="math inline">\(m\times n\)</span> matrices come with the <strong>binary operations</strong> addition <span class="math inline">\(+\)</span> and scalar multiplication <span class="math inline">\(\times\)</span>, so they form a <strong>group</strong> called <em>matrix group</em>.</p>
<p>All the <span class="math inline">\(n\times n\)</span> invertible matrices with real number entities together with <strong>additive operations</strong> <span class="math inline">\(+\)</span>, scalar multiplication <span class="math inline">\(\times\)</span>, and the matrix multiplicative <strong>binary operation</strong> <span class="math inline">\(\times\)</span> also form a group called the <em>general linear group of degree <span class="math inline">\(n\)</span></em>, usually denoted by <span class="math inline">\(\mbox{GL}(n,\mathbb{R})\)</span>.<label for="tufte-sn-582" class="margin-toggle sidenote-number">582</label><input type="checkbox" id="tufte-sn-582" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">582</span> Associativity holds for all elements in <span class="math inline">\((\mathbb{F}^{n\times n},+)\)</span> or <span class="math inline">\((\mathbb{F}^{n\times n},\times)\)</span>. The identity element is the identity matrix <span class="math inline">\(\mathbf{I}\)</span> under <span class="math inline">\(+\)</span> or <span class="math inline">\(\times\)</span>. The inverse is <span class="math inline">\(-\mathbf{A}\)</span> under <span class="math inline">\(+\)</span> and <span class="math inline">\(\mathbf{A}^{-1}\)</span> under <span class="math inline">\(\times\)</span> since <span class="math inline">\(\mathbf{A}\)</span> is invertible.</span></p>
<p>Also, all invertible linear operators <span class="math inline">\(\mathbf{T}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}\)</span> together with the composition <strong>binary operation</strong> <span class="math inline">\(\circ\)</span> forms a <strong>group</strong>, usually denoted by <span class="math inline">\(\mbox{GL}(\mathbb{R}^{n})\)</span>. It is easy to see that <span class="math inline">\(\mbox{GL}(n,\mathbb{R})\)</span> and <span class="math inline">\(\mbox{GL}(\mathbb{R}^{n})\)</span> are <strong>isomorphic</strong>, as we have <span class="math inline">\(\mathbf{T}(\mathbf{x})=\mathbf{A}\mathbf{x}\)</span>.</p>
<p>The <em>exponential function of a square matrix</em> <span class="math inline">\(\mathbf{A}\in \mathbb{R}^{n\times n}\)</span> and the <em>exponential function of a linear operator</em> <span class="math inline">\(\mathbf{A}:\mathbb{R}^{n}\rightarrow \mathbb{R}^{n}\)</span> are defined in a similar manner as the scalar exponential functions:<label for="tufte-sn-583" class="margin-toggle sidenote-number">583</label><input type="checkbox" id="tufte-sn-583" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">583</span> 
However, there is one important difference. The <a href="ch-vecMat.html#sub:vec">commutativity</a> property <span class="math inline">\(\mbox{e}^{z+w}=\mbox{e}^{z}\mbox{e}^{w}\)</span> that holds for <span class="math inline">\(z,w\in\mathbb{R}\)</span> or <span class="math inline">\(z,w\in\mathbb{C}\)</span> is no longer valid. Because matrices or functions are not <a href="ch-vecMat.html#sub:vec">commutative</a> under the matrix multiplication or the functional composition in general, namely <span class="math inline">\(\mathbf{A}\mathbf{B}\neq \mathbf{B}\mathbf{A}\)</span>. According to the definition, <span class="math display">\[\begin{align*}\mbox{e}^{\mathbf{A}\mathbf{B}}&amp;=\mbox{Id}+\mathbf{A}\mathbf{B}+\cdots \\ 
&amp;\neq \mbox{Id}+\mathbf{B}\mathbf{A}+\cdots =\mbox{e}^{\mathbf{B}\mathbf{A}}\end{align*}\]</span> unless <span class="math inline">\(\mathbf{A}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> are <a href="ch-vecMat.html#sub:vec">commutative</a>.</span>
<span class="math display">\[\mbox{e}^{\mathbf{A}}=\mbox{Id}+\mathbf{A}+\frac{1}{2}\mathbf{A}^{2}+\cdots=\sum_{k=0}^{\infty}\frac{(\mathbf{A})^{k}}{k!}.\]</span></p>
<p>For any <span class="math inline">\(s,t\in\mathbb{F}\)</span>, we can prove that <span class="math inline">\(\mbox{e}^{(s+t)\mathbf{A}}=\mbox{e}^{s\mathbf{A}}\mbox{e}^{t\mathbf{A}}\)</span>.</p>
<div class="solution">
<p class="solution-begin">
Proof <span id="sol-start-130" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-130', 'sol-start-130')"></span>
</p>
<div id="sol-body-130" class="solution-body" style="display: none;">
<p>Note that
<span class="math display">\[\mbox{e}^{(s+t)\mathbf{A}}=\sum_{k=0}^{\infty}\frac{1}{k!}(s+t)^{k}\mathbf{A}^{k}.\]</span>
We have
<span class="math display">\[\begin{align*}
\mbox{e}^{s\mathbf{A}}\mbox{e}^{t\mathbf{A}} &amp;=\left(\sum_{r=0}^{\infty}\frac{s^{r}}{r!}\mathbf{A}^{r}\right)\left(\sum_{k=0}^{\infty}\frac{t{}^{k}}{k!}\mathbf{A}^{k}\right)\\
&amp;=\sum_{r,s=0}^{\infty}\frac{s^{r}t{}^{k}}{r!k!}\mathbf{A}^{r+k}=\sum_{n=0}^{\infty}\left(\sum_{r=0}^{n}\frac{s^{r}t^{n-r}}{r!(n-r)!}\right)\mathbf{A}^{n}\\
&amp;= \sum_{n=0}^{\infty}\frac{1}{n!}\left(\sum_{r=0}^{n}\left(\begin{array}{c}
n\\r
\end{array}\right)s^{r}t^{n-r}\right)\mathbf{A}^{n}\\
&amp;=\sum_{n=0}^{\infty}\frac{(s+t)^{n}}{n!}\mathbf{A}^{n}=\mbox{e}^{(s+t)\mathbf{A}}.
\end{align*}\]</span></p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>This property ensures that any (square) <strong>matrix exponential function</strong> <span class="math inline">\(\mbox{e}^{\mathbf{A}}\)</span> has its multiplicative inverse <span class="math inline">\(\mbox{e}^{(-\mathbf{A})}\)</span> as
<span class="math display">\[\mathbf{I}=\mbox{e}^{\mathbf{O}}=\mbox{e}^{(1+ (-1))\times \mathbf{A}}=\mbox{e}^{\mathbf{A}}\mbox{e}^{-\mathbf{A}}\]</span> where <span class="math inline">\(\mathbf{O}\)</span> is the <span class="math inline">\(n\times n\)</span> matrix of all zeros. So the set of all (square) matrix exponential functions form a <strong>general linear group of degree <span class="math inline">\(n\)</span></strong>. In other words, the exponential function maps the elements from the <span class="math inline">\(n\times n\)</span> <strong>matrix group</strong> to <span class="math inline">\(\mbox{GL}(n,\mathbb{R})\)</span>.
Similarly, for any <a href="ch-MatComp.html#sub:vecSpaces">linear operator</a> <span class="math inline">\(\mathbf{A}:\mathbb{R}^{n}\rightarrow \mathbb{R}^{n}\)</span>, the exponential function maps it to the group <span class="math inline">\(\mbox{GL}(\mathbb{R}^{n})\)</span>.</p>
<p>For our parameterization task, we are especially interested in the <strong>group</strong> of <a href="ch-MatComp.html#sub:vecSpaces">linear operators</a> <span class="math inline">\(\mbox{e}^{t\mathbf{A}}:\mathbb{R}^{n}\rightarrow \mathbb{R}^{n}\)</span> with the parameter <span class="math inline">\(t\in\mathbb{R}\)</span>, called the one-parameter <em>exponential family</em>.</p>
<p>Any member from the one-parameter <strong>exponential family</strong> satisfies <span class="math display">\[\frac{\mbox{d}}{\mbox{d}t}\mbox{e}^{t\mathbf{A}}=\mathbf{A}\mbox{e}^{t\mathbf{A}}\]</span>
because the definition of the exponential function gives<span class="math display">\[\frac{\mbox{d}}{\mbox{d}t}\mbox{e}^{t\mathbf{A}}=\sum_{k=0}^{\infty}\frac{\mbox{d}}{\mbox{d}t}\frac{t^{k}}{k!}\mathbf{A}^{k}=\mathbf{A}\sum_{k=0}^{\infty}\frac{t^{k}}{k!}\mathbf{A}^{k}=\mathbf{A}\mbox{e}^{t\mathbf{A}}.\]</span>
Thus, the one-parameter <strong>exponential family</strong> <span class="math inline">\(\{\mbox{e}^{t\mathbf{A}}\}_{t\in\mathbb{R}}\)</span> associates with the solutions of the following differential equation<label for="tufte-sn-584" class="margin-toggle sidenote-number">584</label><input type="checkbox" id="tufte-sn-584" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">584</span> If we simplify <span class="math inline">\(\mathbf{A}\)</span> as a number <span class="math inline">\(a\in\mathbb{R}\)</span>. We have <span class="math display">\[\begin{align*}\psi_{s+t}(x)&amp;=\mbox{e}^{(s+t)a}f(x,0)=\mbox{e}^{sa}\mbox{e}^{ta}f(x,0)\\
&amp;=(\psi_s\circ\psi_t)(x).\end{align*}\]</span> The <strong>group</strong> <span class="math inline">\((\mathbb{R}^{+},\times)\)</span> of elements <span class="math inline">\(\{\mbox{e}^{t}\}_{t\in\mathbb{R}}\)</span> acts on <span class="math inline">\(f(x,0)\)</span>. So the solution is a <strong>group</strong> acting of the <span class="math inline">\(f(x,0)\)</span> called <em>group action</em>. Here the parameter <span class="math inline">\(t\)</span> is from the <strong>group</strong> <span class="math inline">\((\mathbb{R},+)\)</span>, and it is <strong>isomorphic</strong> to <span class="math inline">\((\mathbb{R}^{+},\times)\)</span>. So we can also say the parameter <strong>group</strong> <span class="math inline">\((\mathbb{R}^{+},\times)\)</span> acting on <span class="math inline">\(f(x,0)\)</span> results the solution of <span class="math inline">\(f(x,t)\)</span>.</span> <span class="math display">\[\frac{\mbox{d}\mathbf{f}(t)}{\mbox{d}t}=\mathbf{A}\mathbf{f}(t)\]</span>
where <span class="math inline">\(\mathbf{f}(t):\mathbb{R}\rightarrow\mathbb{R}^{n}\)</span> is some function evaluated at <span class="math inline">\(n\)</span> points at time <span class="math inline">\(t\)</span>.<label for="tufte-sn-585" class="margin-toggle sidenote-number">585</label><input type="checkbox" id="tufte-sn-585" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">585</span> For example, the heat function <span class="math inline">\(f(x,y,t)\)</span> evaluated at <span class="math inline">\(30\)</span> spatial points of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> gives <span class="math inline">\(n=900\)</span> points at time <span class="math inline">\(t\)</span>. The operator <span class="math inline">\(\mathbf{A}\)</span> can be thought of as a <span class="math inline">\(900\times 900\)</span> <a href="ch-MatComp.html#sub:LU">second-order difference matrix</a> defined in chapter <a href="ch-MatComp.html#sub:LU">11.3</a>. (However, one needs to sort the points in a particular way to make the matrix work properly. But this sorting is not our concern now.)</span></p>
<p>In particular, we know that the differentiation operator <span class="math inline">\(\frac{\mbox{d}}{\mbox{d}t}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}\)</span> is a <a href="ch-MatComp.html#sub:vecSpaces">linear operator</a>. For any <span class="math inline">\(s\in\mathbb{R}\)</span>, we can prove that the <strong>exponential linear operator function</strong> is <span class="math display">\[\mbox{e}^{s\left(\frac{\mbox{d}}{\mbox{d}t}\right)}=\mathbf{L}^{-s},\]</span>
where <span class="math inline">\(\mathbf{L}^{-s}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}\)</span> is the operator translating forwardly of the object by <span class="math inline">\(s\)</span> units such that <span class="math inline">\((\mathbf{L}^{-s}\mathbf{f})(0)=\mathbf{f}(s)\)</span>. This <strong>exponential linear operator function</strong> provides the generic (numerical) solution of the differential equations.<label for="tufte-sn-586" class="margin-toggle sidenote-number">586</label><input type="checkbox" id="tufte-sn-586" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">586</span> For the heat equation problem, we have <span class="math inline">\(\mbox{d}/\mbox{dt}(\cdot)=\Delta(\cdot)\)</span>. So the solution is <span class="math display">\[\mbox{e}^{s\left(\frac{\mbox{d}}{\mbox{d}t}\right)}\mathbf{f}(0)=\mbox{e}^{s\Delta}\mathbf{f}(0)=\mathbf{f}(s).\]</span> Basically, the solution tells us at any time <span class="math inline">\(t\)</span> an <strong>exponential family</strong> <span class="math inline">\(\mbox{e}^{t\Delta}\)</span> acting on vectorized initial data <span class="math inline">\(\mathbf{f}(0)\)</span>, and the action describes how the heat diffuses at time <span class="math inline">\(t\)</span>.</span></p>
<div class="solution">
<p class="solution-begin">
Sketch of the proof <span id="sol-start-131" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-131', 'sol-start-131')"></span>
</p>
<div id="sol-body-131" class="solution-body" style="display: none;">
<p>Here I only consider <span class="math inline">\(\mathbf{f}(t)\)</span> as the vector representation of a polynomial function <span class="math inline">\(f(t)\)</span> of degree <span class="math inline">\(n-1\)</span>.<label for="tufte-sn-587" class="margin-toggle sidenote-number">587</label><input type="checkbox" id="tufte-sn-587" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">587</span> In principle, one can choose <span class="math inline">\(n\)</span> to be arbitrary large so that the polynomial function can approximate well to any potential solution.</span> The space of polynomial functions of degree <span class="math inline">\(n-1\)</span> has <span class="math inline">\(n\)</span> basis <span class="math inline">\(\{1,t,t^{2},\dots,t^{n-1}\}\)</span>, and it is <strong>isomorphic</strong> to <span class="math inline">\(\mathbb{R}^{n}\)</span> such that<span class="math display">\[f(t)=c_{1}+c_{2}t+\cdots+c_{n}t^{n-1}\Leftrightarrow\mathbf{f}(t)=\left[\begin{array}{c}
c_{1}\\
c_{2}t\\
\vdots\\
c_{n}t^{n-1}
\end{array}\right].\]</span>
Let an operator <span class="math inline">\(\mathbf{A}:\mathbb{R}^{n}\rightarrow\mathbb{R}^{n}\)</span>
be <span class="math inline">\(\mathbf{A}\mathbf{f}=\frac{\mbox{d}\mathbf{f}}{\mbox{d}t}\)</span>.</p>
<p>The Taylor series for any polynomial <span class="math inline">\(f(t+s)\)</span> at <span class="math inline">\(t\)</span> has the following form
<span class="math display">\[f(t+s)=f(t)+\frac{s}{1}\frac{\mbox{d}p(t)}{\mbox{d}t}+\frac{s^{2}}{2}\frac{\mbox{d}^{2}f(t)}{\mbox{d}t^{2}}+\cdots.\]</span>
The above expression can be written in the vector form as follows
<span class="math display">\[\left(\mbox{Id}\times\mathbf{f}+s\mathbf{A}\mathbf{f}+\frac{s^{2}}{2}\mathbf{A}^{2}\mathbf{f}+\cdots\right)=\sum_{k=0}^{\infty}\frac{(s\mathbf{A})^{k}}{k!}\mathbf{f}=\mbox{e}^{s\mathbf{A}}\mathbf{f}.\]</span></p>
<p>In other words, we have<span class="math display">\[\mbox{e}^{s\mathbf{A}}\mathbf{f}=\mbox{e}^{s\left(\frac{\mbox{d}}{\mbox{d}t}\right)}\mathbf{f}=\mathbf{L}^{-s}\mathbf{f}.\]</span>
for any polynomial vector <span class="math inline">\(\mathbf{f}(\cdot)\)</span>.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="sub:convolution" class="section level2">
<h2>
<span class="header-section-number">18.2</span> Character and Convolution</h2>
<p>The word “harmonic” often describes a quality of sound. The name of the <a href="ch-harmonicAn.html#sub:heatEq">harmonic function</a> reveals a roundabout connection between the source of sound created by the periodic vibrating strings and the “harmonic motion” generated by the Fourier series. Our current attempt is to concretize this roundabout route so that we can connect various distant concepts in a unified roadmap.<label for="tufte-sn-588" class="margin-toggle sidenote-number">588</label><input type="checkbox" id="tufte-sn-588" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">588</span> The title of this section is the “hub station” of the tour.</span></p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:WaveEq"></span>
<img src="fig/Part5/WaveEq.gif" alt="Wave equation" width="100%"><!--
<p class="caption marginnote">-->Figure 18.3: Wave equation<!--</p>-->
<!--</div>--></span>
</p>
<p><span class="newthought">From Wave to Fourier series and periodicity</span></p>
<p>For the <a href="ch-DE.html#sub:pde">1D heat equation</a> problem, it is natural to imagine that at the end of the heat diffusion process, everywhere of the domain reaches the same temperature because <span class="math inline">\(\Delta f(x,t)= \partial^2f(x,t)/\partial x^2=0\)</span> can only induce that <span class="math inline">\(f(x,t)\)</span> is a constant on the domain. In this case, we anticipate the system to arrive at its equilibrium state. The temperature of all states become still in this kind of egalitarianism’s equilibrium. Moreover, the role of time vanishes as <span class="math inline">\(\partial f/\partial t=0\)</span>.</p>
<p>However, we have confronted another type of equilibrium, the periodic equilibrium; the variations recur in a cyclic pattern (see chapter <a href="ch-UnMulti.html#sub:rw">13.3</a>). The role of time in this kind of equilibrium persistently unfolds the repeating episodes, so it is never dismissed. The periodic equilibrium can happen for the <a href="ch-harmonicAn.html#sub:heatEq">2D heat equation</a> problem. When <span class="math inline">\(\partial f/\partial t=0\)</span>, the equation <span class="math inline">\(\Delta f(x,y,t)=0\)</span> rather than degenerates to a constant function, has a <a href="ch-representation.html#sub:innerProd">Fourier series representation</a> of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. Here, the basis functions of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> perform as vibrating periodic strings such that the gain/loss caused by the second derivatives of <span class="math inline">\(x\)</span> compensate the opposite effect of <span class="math inline">\(y\)</span>.<label for="tufte-sn-589" class="margin-toggle sidenote-number">589</label><input type="checkbox" id="tufte-sn-589" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">589</span> The equation <span class="math inline">\(\Delta f(x,y)=0\)</span> is called the <em>Laplace’s equation</em>. Assume that <span class="math inline">\(f(x,y)=\phi(x)\psi(y)\)</span>. The equation becomes <span class="math display">\[0=\frac{\mbox{d}^{2}\phi(x)}{\mbox{d}x^{2}}\psi(y) +\phi(x)\frac{\mbox{d}^{2}\psi(y)}{\mbox{d}y^{2}}\]</span> or say <span class="math display">\[\frac{\mbox{d}^{2}\phi(x)/\mbox{d}x^{2}}{\phi(x)}=-\frac{\mbox{d}^{2}\psi(y)/\mbox{d}y^{2}}{\psi(y)}=A_n,\]</span> For each constant <span class="math inline">\(A_n\)</span>, we have a system of two equations <span class="math display">\[\begin{align*}\frac{\mbox{d}^{2}\phi(x)}{\mbox{d}x^{2}} &amp;=A_n\phi(x),\\
\frac{\mbox{d}^{2}\psi(y)}{\mbox{d}y^{2}}   &amp;=-A_n\psi(y).\end{align*}\]</span>
The system coincides with the coupling structure in equation <a href="ch-complexAn.html#eq:coupling">(17.1)</a>. The <a href="ch-representation.html#sub:innerProd">Fourier series</a>, as this coupling system’s <a href="ch-representation.html#sub:innerProd">eigenfunctions</a>, offers the vibrating periodic solution.</span></p>
<p>One of the well-known vibrating periodic systems is the <em>wave equation</em> <span class="math display">\[\frac{\partial^{2}f(x,y,t)}{\partial t^{2}}=\Delta f(x,y,t).\]</span> In this system, the vibration energy created by the <a href="ch-harmonicAn.html#sub:heatEq">Laplacian</a> is completely transmitted along the arrow of time (through the second-order derivatives of time). The <a href="ch-representation.html#sub:innerProd">Fourier series</a> also solve the <strong>wave equation</strong>. The visual solution is given in figure <a href="ch-harmonicAn.html#fig:WaveEq">18.3</a>.<label for="tufte-sn-590" class="margin-toggle sidenote-number">590</label><input type="checkbox" id="tufte-sn-590" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">590</span> The Fourier basis <span class="math inline">\(\mbox{e}^{\mbox{i}n\theta}\)</span> forms the wave terms <span class="math inline">\(\cos(n\theta)\)</span> and <span class="math inline">\(\sin(n\theta)\)</span>. The integer <span class="math inline">\(n=1,2,3,\dots\)</span> means that possible wavelengths are <span class="math inline">\(\frac{1}{2\pi},\frac{1}{4\pi},\dots\)</span>. With the Fourier series, we can write every continuous periodic function as a sum of simple waves. A similar result holds for non-periodic functions on <span class="math inline">\(\mathbb{R}\)</span>, provided that they have finite <span class="math inline">\(L^2\)</span>-norms. Also, for non-periodic function, there is no restriction on the wavelengths, so every positive real number can occur.</span></p>
<div class="solution">
<p class="solution-begin">
Wave equation: solution and code <span id="sol-start-132" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-132', 'sol-start-132')"></span>
</p>
<div id="sol-body-132" class="solution-body" style="display: none;">
<p>Consdier the <strong>wave equation</strong> <span class="math display">\[\frac{\partial^{2}f(x,y,t)}{\partial t^{2}}=\Delta f(x,y,t).\]</span>
For an explicit solution, let’s assume <span class="math inline">\(f(x,y,t)=\phi(x)\psi(y)\gamma(t)\)</span>. The <strong>wave equation</strong> becomes <span class="math display">\[\phi(x)\psi(y)\frac{\mbox{d}^{2}\gamma(t)}{\mbox{d}t^{2}}=\frac{\mbox{d}^{2}\phi(x)}{\mbox{d}x^{2}}\psi(y)\gamma(t)+\phi(x)\frac{\mbox{d}^{2}\psi(y)}{\mbox{d}y^{2}}\gamma(t)\]</span>
which is equivalent to<span class="math display">\[\frac{\mbox{d}^{2}\gamma(t)/\mbox{d}t^{2}}{\gamma(t)}=\frac{\mbox{d}^{2}\phi(x)/\mbox{d}x^{2}}{\phi(x)}+\frac{\mbox{d}^{2}\psi(y)/\mbox{d}y^{2}}{\psi(y)}=A.\]</span>
Now we have a system of three equations. One is<span class="math display">\[\frac{\mbox{d}^{2}\gamma(t)/\mbox{d}t^{2}}{\gamma(t)}=A\mbox{ or}\frac{\mbox{d}^{2}\gamma(t)}{\mbox{d}t^{2}}=A\gamma,\]</span>
and the other two are from <span class="math display">\[\frac{\mbox{d}^{2}\phi(x)/\mbox{d}x^{2}}{\phi(x)}=B=-\frac{\mbox{d}^{2}\psi(y)/\mbox{d}y^{2}}{\psi(y)}+A,\]</span>
namely <span class="math display">\[\begin{align*}\frac{\mbox{d}^{2}\phi(x)}{\mbox{d}x^{2}}    &amp;=B\phi(x),\\
\frac{\mbox{d}^{2}\psi(y)}{\mbox{d}y^{2}}   &amp;=(A-B)\psi(y)=C\psi(y).\end{align*}\]</span>
All these three are eigenfunctions-eigenvalues problems where eigenvalues are <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>, and the eigenfunctions are Fourier series.</p>
<p>For <span class="math inline">\(\phi(x)\)</span> and <span class="math inline">\(\psi(y)\)</span>, we can use sine seires to represent them <span class="math display">\[\phi(x)=\sum_{m}\sin\frac{m\pi}{a}x,\;\psi(y)=\sum_{n}\sin\frac{n\pi}{b}y\]</span>
where <span class="math inline">\(B=-(m/a)^{2}\)</span> and <span class="math inline">\(C=-(n/b)^{2}\)</span>. As <span class="math inline">\(A=B+C=-(m/a)^{2}+(n/b)^{2}&lt;0\)</span>, we represent <span class="math inline">\(\gamma(t)\)</span> by <span class="math display">\[\gamma_{mn}(t)=\cos\omega_{mn}t+\sin\omega_{mn}t\]</span>
where <span class="math inline">\(\omega_{mn}=\pi\sqrt{(m/a)^{2}+(n/b)^{2}}\)</span>. The general solution is <span class="math display">\[u(x,y,t)=\sum_{n=1}^{\infty}\sum_{m=1}^{\infty}\sin\left(\frac{m\pi}{a}x\right)\sin\left(\frac{n\pi}{b}y\right)\left(\cos\omega_{mn}t+\sin\omega_{mn}t\right).\]</span>
Note that for each pair <span class="math inline">\((m,n)\)</span>, <span class="math display">\[\sin\left(\frac{m\pi}{a}x\right)\sin\left(\frac{n\pi}{b}y\right)\left(\cos\omega_{mn}t+\sin\omega_{mn}t\right)\]</span>
is also a solution of the wave equation.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1"><span class="co"># wave</span></a>
<a class="sourceLine" id="cb191-2" data-line-number="2">x =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">len=</span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb191-3" data-line-number="3">y =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">len=</span><span class="dv">30</span>)</a>
<a class="sourceLine" id="cb191-4" data-line-number="4">xy =<span class="st"> </span><span class="kw">expand.grid</span>(x,y)</a>
<a class="sourceLine" id="cb191-5" data-line-number="5"></a>
<a class="sourceLine" id="cb191-6" data-line-number="6"><span class="co">#Wave speed</span></a>
<a class="sourceLine" id="cb191-7" data-line-number="7">c =<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb191-8" data-line-number="8"><span class="co">#Initial time</span></a>
<a class="sourceLine" id="cb191-9" data-line-number="9">t0 =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb191-10" data-line-number="10"><span class="co">#Time increment</span></a>
<a class="sourceLine" id="cb191-11" data-line-number="11">dt =<span class="st"> </span><span class="fl">0.03</span></a>
<a class="sourceLine" id="cb191-12" data-line-number="12"><span class="co">#Try every combination</span></a>
<a class="sourceLine" id="cb191-13" data-line-number="13">n =<span class="st"> </span><span class="dv">2</span> <span class="co">#1 #5 #2 #5</span></a>
<a class="sourceLine" id="cb191-14" data-line-number="14">m =<span class="st"> </span><span class="dv">3</span> <span class="co">#1 #5 #3 #3</span></a>
<a class="sourceLine" id="cb191-15" data-line-number="15"></a>
<a class="sourceLine" id="cb191-16" data-line-number="16">w =<span class="st"> </span>pi<span class="op">*</span>c<span class="op">*</span><span class="kw">sqrt</span>(n<span class="op">**</span><span class="dv">2</span><span class="op">+</span>m<span class="op">**</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb191-17" data-line-number="17">Fourier.sol =<span class="st"> </span><span class="cf">function</span>(x,y,t){(<span class="kw">cos</span>(w<span class="op">*</span>t)<span class="op">+</span><span class="kw">sin</span>(w<span class="op">*</span>t))<span class="op">*</span><span class="kw">sin</span>(pi<span class="op">*</span>m<span class="op">*</span>x)<span class="op">*</span><span class="kw">sin</span>(n<span class="op">*</span>pi<span class="op">*</span>y)}</a>
<a class="sourceLine" id="cb191-18" data-line-number="18"></a>
<a class="sourceLine" id="cb191-19" data-line-number="19">solve.vec =<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb191-20" data-line-number="20"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">500</span>){</a>
<a class="sourceLine" id="cb191-21" data-line-number="21">    f =<span class="st"> </span><span class="kw">Fourier.sol</span>(xy[<span class="dv">1</span>],xy[<span class="dv">2</span>],t0)</a>
<a class="sourceLine" id="cb191-22" data-line-number="22">    t0 =<span class="st"> </span>t0 <span class="op">+</span><span class="st"> </span>dt</a>
<a class="sourceLine" id="cb191-23" data-line-number="23">    solve.vec=<span class="kw">c</span>(solve.vec,f)</a>
<a class="sourceLine" id="cb191-24" data-line-number="24">}</a>
<a class="sourceLine" id="cb191-25" data-line-number="25"></a>
<a class="sourceLine" id="cb191-26" data-line-number="26"><span class="co"># Plot</span></a>
<a class="sourceLine" id="cb191-27" data-line-number="27"><span class="kw">library</span>(plot3D)</a>
<a class="sourceLine" id="cb191-28" data-line-number="28">t =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb191-29" data-line-number="29">solution.wave =<span class="st"> </span><span class="kw">unlist</span>(solve.vec[t], <span class="dt">recursive=</span><span class="ot">TRUE</span>, <span class="dt">use.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb191-30" data-line-number="30">sol.matrix =<span class="st"> </span><span class="kw">matrix</span>(solution.wave, <span class="dt">nrow=</span><span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb191-31" data-line-number="31"><span class="kw">persp3D</span>(x,y,<span class="dt">z=</span>sol.matrix, <span class="dt">image =</span> <span class="ot">FALSE</span>, <span class="dt">zlab=</span><span class="st">"f"</span>, <span class="dt">expand =</span> <span class="fl">0.5</span>, <span class="dt">xlim=</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">zlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">colkey=</span><span class="ot">FALSE</span>, <span class="dt">scale =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">"Time = "</span>, t))</a></code></pre></div>
<p>In particular, if the wave problem has boundary condition, such as <span class="math inline">\(u(x,y,0)=f(x,y)\)</span>
and <span class="math inline">\(\frac{\mbox{d}u(x,y,0)}{\mbox{d}t}=g(x,y)\)</span>. One can use double Fourier series to represent <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> such that <span class="math display">\[\begin{align*}f(x,y)=&amp;  u(x,y,0)=\sum_{n=1}^{\infty}\sum_{m=1}^{\infty}c_{mn}\sin\left(\frac{m\pi}{a}x\right)\sin\left(\frac{n\pi}{b}y\right),\\
g(x,y)=&amp;    \frac{\mbox{d}u(x,y,0)}{\mbox{d}t}=\sum_{n=1}^{\infty}\sum_{m=1}^{\infty}\tilde{c}_{mn}\sin\left(\frac{m\pi}{a}x\right)\sin\left(\frac{n\pi}{b}y\right).\end{align*}\]</span></p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><span class="newthought">From periodicity to cyclic groups</span></p>
<p>Recall that a function <span class="math inline">\(f\)</span> on <span class="math inline">\(\mathbb{R}\)</span> is <a href="ch-UnMulti.html#sub:rw">periodic</a> with a period <span class="math inline">\(T\)</span> if <span class="math inline">\(f(x+T)=f(x)\)</span>.<label for="tufte-sn-591" class="margin-toggle sidenote-number">591</label><input type="checkbox" id="tufte-sn-591" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">591</span> The formal notation of the space of all continuous periodic functions on <span class="math inline">\(\mathbb{R}\)</span> is <span class="math inline">\(\mathcal{C}(\mathbb{R}/\mathbb{Z})\)</span>, where <span class="math inline">\(\mathbb{R}/\mathbb{Z}\)</span> (often called a <em>quotient space</em>) is to split <span class="math inline">\(\mathbb{R}\)</span> into <a href="sub-set-theory.html#sub:order">equivalence classes</a> of all integers. Note that for each <span class="math inline">\(x\in\mathbb{R}\)</span>, its <a href="sub-set-theory.html#sub:order">equivalence class</a> of all integers is <span class="math display">\[\{x+k|k\in\mathbb{Z}\}.\]</span>
Thus, the set of all equivalence classes of <span class="math inline">\(\mathbb{Z}\)</span> forms a partition of <span class="math inline">\(\mathbb{R}\)</span>: <span class="math display">\[\mathbb{R}/\mathbb{Z}=\left\{ \left.x+k\right|k\in\mathbb{Z},x\in\mathbb{R}\right\}.\]</span></span></p>
<p>The cyclic nature of the variable <span class="math inline">\(T\)</span> in <span class="math inline">\(f(x)=f(x+T)\)</span> means that we have invariance with respect to translation in a period of <span class="math inline">\(T\)</span>. In another sense, this is an invariance with respect to the <a href="ch-harmonicAn.html#sub:heatEq">group</a> of translations in the frequency of <span class="math inline">\(T\)</span>.<label for="tufte-sn-592" class="margin-toggle sidenote-number">592</label><input type="checkbox" id="tufte-sn-592" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">592</span> One can verify a periodic set is a <a href="ch-harmonicAn.html#sub:heatEq">group</a> when one considers <span class="math inline">\(f(x+T)=\mathbf{L}^{-T}f(x)\)</span> under the <a href="ch-randomization.html#sub:SumDecomp">shift operator</a> <span class="math inline">\(\mathbf{L}^{-T}\)</span>. In this case, one can compose two periodic translations <span class="math inline">\(\mathbf{L}^{-sT}\mathbf{L}^{-kT}\)</span> and obtain another periodic translation <span class="math inline">\(\mathbf{L}^{-(s+k)T}\)</span>, and one can have the inverse of a periodic translation by translating in the negative direction of the original one such as <span class="math inline">\(\mathbf{L}^{T}f(x)=f(x-T)=f(x)\)</span>.</span></p>
<ul>
<li>
<strong>Subgroup</strong> : Consider the <a href="ch-harmonicAn.html#sub:heatEq">group</a> structure <span class="math inline">\((\mathcal{G},\ast)\)</span>. If a subset <span class="math inline">\(\mathcal{G}_{s}\)</span> of <span class="math inline">\(\mathcal{G}\)</span> is <a href="ch-randomization.html#sub:SumDecomp">closed</a> under the <a href="ch-harmonicAn.html#sub:heatEq">binary operation</a> <span class="math inline">\(\ast\)</span>, then <span class="math inline">\((\mathcal{G}_{s},\ast)\)</span> is a <em>subgroup</em> of <span class="math inline">\((\mathcal{G},\ast)\)</span>.<label for="tufte-sn-593" class="margin-toggle sidenote-number">593</label><input type="checkbox" id="tufte-sn-593" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">593</span> The binary operation of the <strong>subgroup</strong> should be the same as that of the original <a href="ch-harmonicAn.html#sub:heatEq">group</a>. Note that <span class="math inline">\((\mathbb{Q}^{+},\times)\)</span> is not a <strong>subgroup</strong> of <span class="math inline">\((\mathbb{R},+)\)</span> even though <span class="math inline">\(\mathbb{Q}^{+}\subset\mathbb{R}\)</span>.</span>
</li>
</ul>
<p>It is easy to see that if a <strong>subgroup</strong> <span class="math inline">\((\mathcal{G}_{s},\ast)\)</span> of <span class="math inline">\((\mathcal{G},\ast)\)</span> contains <span class="math inline">\(f\in\mathcal{G}\)</span>, then it must also contain <span class="math inline">\(f\ast f\)</span>, <span class="math inline">\(f\ast f\ast f, \dots\)</span>, etc., namely <span class="math display">\[\underset{n-\mbox{times}}{\underbrace{f\ast\cdots\ast f}=f^{(\ast n)}} \in (\mathcal{G}_s,\ast) \:\mbox{ for any }n\in\mathbb{Z}.\]</span></p>
<ul>
<li>
<strong>Cyclic (sub)group</strong> : Let <span class="math inline">\((\mathcal{G},\ast)\)</span> be a <a href="ch-harmonicAn.html#sub:heatEq">group</a>. For any <span class="math inline">\(f\in\mathcal{G}\)</span>, the set
<span class="math inline">\(\mathcal{G}_{c}=\left\{ \left.f^{(\ast n)}\right|n\in\mathbb{Z}\right\}\)</span>
forms a <strong>subgroup</strong> <span class="math inline">\((\mathcal{G}_c,\ast)\)</span> of
<span class="math inline">\((\mathcal{G},\ast)\)</span>.<label for="tufte-sn-594" class="margin-toggle sidenote-number">594</label><input type="checkbox" id="tufte-sn-594" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">594</span> The associative law gives <span class="math inline">\(f^{(\ast t)}f^{(\ast s)}=f^{(\ast(t+s))}\)</span> for any <span class="math inline">\(t,s\in\mathbb{Z}\)</span>. The identity element is <span class="math inline">\(f^{(\ast t)}f^{(\ast(-t))}=f^{(\ast0)}=\mbox{Id}\)</span>. Hence we can ensure that <span class="math inline">\((\mathcal{G}_{c},\ast)\)</span> is a <strong>subgroup</strong> of <span class="math inline">\((\mathcal{G},\ast)\)</span>.</span> We say <span class="math inline">\((\mathcal{G}_c,\ast)\)</span> is <a href="ch-representation.html#sub:pseudoRandom">generated</a> by <span class="math inline">\(f\)</span>. the <a href="ch-harmonicAn.html#sub:heatEq">group</a> <span class="math inline">\((\mathcal{G}_{c}, \ast)\)</span> is the smallest <strong>subgroup</strong> of <span class="math inline">\((\mathcal{G},\ast)\)</span> that contains <span class="math inline">\(f\)</span>. That is, every <strong>subgroup</strong> containing <span class="math inline">\(f\)</span> must contain <span class="math inline">\(\mathcal{G}_{c}\)</span>. The subgroup <span class="math inline">\((\mathcal{G}_{c}, \ast)\)</span> is called the <em>cyclic subgroup</em> of <span class="math inline">\((\mathcal{G},\ast)\)</span> <a href="ch-representation.html#sub:pseudoRandom">generated</a> by <span class="math inline">\(f\)</span>. On the other hand, when an element <span class="math inline">\(f\)</span> <a href="ch-representation.html#sub:pseudoRandom">generates</a> a <a href="ch-harmonicAn.html#sub:heatEq">group</a> <span class="math inline">\((\mathcal{F},\ast)\)</span>, <span class="math inline">\(f\)</span> is called the <em>generator</em> for <span class="math inline">\((\mathcal{F},\ast)\)</span>, and <span class="math inline">\((\mathcal{F},\ast)\)</span> must be <strong>cyclic</strong>.</li>
</ul>
<p>Let’s consider one simple <strong>cyclic group</strong>. For each positive integer <span class="math inline">\(k\)</span>, let <span class="math inline">\(\mathcal{U}_{k}=\{z\in\mathbb{C}|z^{k}=1\}\)</span>, then <span class="math inline">\((\mathcal{U}_{k},\times)\)</span> is a <strong>cyclic group</strong> of the <span class="math inline">\(k\)</span>-th roots of unity in <span class="math inline">\(\mathbb{C}\)</span>. The elements of <span class="math inline">\(\mathcal{U}_{k}\)</span> can be represented geometrically by equally spaced points on a (complex) unit circle around the origin. The <strong>generator</strong> of the <strong>cyclic group</strong> <span class="math inline">\((\mathcal{U}_{k},\times)\)</span> is <span class="math display">\[\cos\frac{2\pi}{k}+\mbox{i}\sin\frac{2\pi}{k}=\mbox{e}^{\mbox{i}2\pi/k},\]</span>
because <span class="math inline">\((\mbox{e}^{\mbox{i}2\pi/k})^{k}=1\)</span>.<label for="tufte-sn-595" class="margin-toggle sidenote-number">595</label><input type="checkbox" id="tufte-sn-595" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">595</span> Let <span class="math inline">\(\mbox{e}^{\mbox{i}2\pi/k}=\xi\)</span>. The <span class="math inline">\(k\)</span> roots can be written as <span class="math inline">\(1,\xi,\xi^{2},\dots,\xi^{n-1}\)</span>. These <span class="math inline">\(k\)</span> powers of <span class="math inline">\(\xi\)</span> are closed under the multiplication. For example, let <span class="math inline">\(k=6\)</span>, <span class="math display">\[\xi^{3}\xi^{7}=\xi^{10}=\xi^{6}\xi^{4}=1\times\xi^{4}=\xi^{4}.\]</span>
For any <span class="math inline">\(z\times z^{k-1}=z^{k}=1\)</span>, we can see that <span class="math inline">\(z\)</span> has the inverse <span class="math inline">\(z^{k-1}\in\mathbb{C}\)</span>.
Also, the multiplication <span class="math inline">\(\xi^{i}\xi^{j}\)</span> is <a href="ch-harmonicAn.html#sub:heatEq">isomorphic</a> to the addition <span class="math inline">\((i+j)\mbox{ mod }n\)</span>. So we can see that <span class="math inline">\((\mathcal{U}_{k},\times)\)</span> is isomorphic to <span class="math inline">\((\mathcal{Z}_{k},+)\)</span> where <span class="math inline">\(\mathcal{Z}_{k}=\{0,1,\dots,n-1\}\)</span> and <a href="ch-representation.html#sub:pseudoRandom">addition modulo</a> <span class="math inline">\(n\)</span> is closed on <span class="math inline">\(\mathcal{Z}_{k}\)</span>.</span></p>
<p>The discrete set <span class="math inline">\(\mathcal{U}_{k}=\{\mbox{e}^{\mbox{i}\frac{2\pi}{k}}=z\in\mathbb{C}|z^{k}=1\}\)</span> is a discretization of the <em>complex unit circle</em> <span class="math inline">\(\mathcal{U}= \{\mbox{e}^{\mbox{i}\theta}: \theta\in [0,2\pi ]\}\)</span>. Note that <span class="math inline">\((\mathcal{U},\times)\)</span> is also a <strong>cyclic group</strong> whose cycle follows the period <span class="math inline">\(2\pi\)</span>.<label for="tufte-sn-596" class="margin-toggle sidenote-number">596</label><input type="checkbox" id="tufte-sn-596" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">596</span> The multiplication of complex numbers on the <strong>complex unit circle</strong> is associative. The identity element for the multiplication is <span class="math inline">\(1\)</span>. For any <span class="math inline">\(\mbox{e}^{\mbox{i}\theta}\in\mathcal{U}\)</span>, <span class="math display">\[\mbox{e}^{\mbox{i}\theta}\times\mbox{e}^{\mbox{i}(2\pi-\theta)}=\mbox{e}^{2\pi\mbox{i}}=1\]</span> means <span class="math inline">\(\mbox{e}^{\mbox{i}(2\pi-\theta)}\)</span> is the inverse of <span class="math inline">\(\mbox{e}^{\mbox{i}\theta}\)</span>.
Also, <span class="math inline">\((\mathcal{U},\times)\)</span> is <a href="ch-harmonicAn.html#sub:heatEq">isomorphic</a> to <span class="math inline">\((\mathbb{R}^{+},(+ \mod(2\pi))\)</span>, because <span class="math inline">\(z_{1}\times z_{2}\)</span> is <a href="ch-harmonicAn.html#sub:heatEq">isomorphic</a> to <span class="math inline">\((\theta_{1}+\theta_{2})\mbox{ mod }2\pi\)</span> where <span class="math inline">\(z_{j}=\mbox{e}^{\mbox{i}\theta_{j}}\)</span> for <span class="math inline">\(j=1,2\)</span>. In other words, the complex number multiplication on the unit circle and addition with modulo <span class="math inline">\(2\pi\)</span> on <span class="math inline">\(\mathbb{R}\)</span> have the same algebraic properties.</span></p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:denseCircle"></span>
<img src="fig/Part5/denseCircle.gif" alt="Equidistribution on the unit circle" width="100%"><!--
<p class="caption marginnote">-->Figure 18.4: Equidistribution on the unit circle<!--</p>-->
<!--</div>--></span>
</p>
<p>The relation between the groups <span class="math inline">\((\mathcal{U}_k, \times)\)</span> and <span class="math inline">\((\mathcal{U}, \times)\)</span> is disclosed as follows. Picking up some arbitrary point(s) on a unit circle, we can repeatedly rotate the point(s) by some chosen angle <span class="math inline">\(\alpha\)</span> so that the trajectory of the moving points can almost cover the whole unit circle. The angle <span class="math inline">\(\alpha\)</span> is chosen as follows. The location of the trajectory on the unit circle is contained in the set <span class="math inline">\(\{\cos(n\alpha),\sin(n\alpha)\}_{n\in\mathbb{N}}\)</span> so that the <a href="ch-randomization.html#sub:SumDecomp">closure</a> of the set is the <em>complex unit circle</em>, namely <span class="math display">\[\overline{\{\cos(n\alpha),\sin(n\alpha)\}_{n\in\mathbb{N}}}=\{\mbox{e}^{\mbox{i}\alpha}: \alpha\in [0,2\pi ]\}=\mathcal{U}.\]</span> The set <span class="math inline">\(\{\cos(n\alpha),\sin(n\alpha)\}_{n\in\mathbb{N}}\)</span> is called the <em>dense set</em> of <span class="math inline">\(\mathcal{U}\)</span>.<label for="tufte-sn-597" class="margin-toggle sidenote-number">597</label><input type="checkbox" id="tufte-sn-597" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">597</span> For example, the set of rational numbers <span class="math inline">\(\mathbb{Q}\)</span> is a <strong>dense set</strong> of <span class="math inline">\(\mathbb{R}\)</span>, namley <span class="math inline">\(\overline{\mathbb{Q}}=\mathbb{R}\)</span>.</span>
Figure <a href="ch-harmonicAn.html#fig:denseCircle">18.4</a> shows the construction of such a <a href="ch-randomization.html#sub:SumDecomp">closure</a>.</p>
<p>Both <span class="math inline">\(\{\cos(n\alpha),\sin(n\alpha)\}_{n\in\mathbb{N}}\)</span> and <span class="math inline">\(\{\mbox{e}^{\mbox{i}n\alpha}\}_{n\in\mathbb{N}}\)</span> are the <a href="ch-representation.html#sub:innerProd">Fourier bases</a>. In particular, if we choose <span class="math inline">\(\alpha\)</span> as <span class="math inline">\(\alpha=\frac{2\pi}{k}\)</span>, then we have the third Fourier base <span class="math display">\[\left\{ \left.\left(\cos\left(n\frac{2\pi}{k}\right),\sin\left(n\frac{2\pi}{k}\right)\right)\right|n\in\mathbb{N}\right\}.\]</span> These three bases are all in <span class="math inline">\(\ell^2([0,2\pi])\)</span>, but their <a href="ch-randomization.html#sub:SumDecomp">closures</a> form the <a href="ch-MatComp.html#sub:vecSpaces">bases</a> in <span class="math inline">\(L^2([0,2\pi])\)</span>.</p>
<p>The above result is known as the <em>equidistribution theorem</em> that says for any continuous integrable function <span class="math inline">\(f:[0,2\pi]\rightarrow \mathbb{C}\)</span>, there is<label for="tufte-sn-598" class="margin-toggle sidenote-number">598</label><input type="checkbox" id="tufte-sn-598" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">598</span> 
In other words, the theorem says that if a sequence <span class="math inline">\(\{x_n\}_{n\in\mathbb{N}}\)</span> is the <strong>dense</strong> set of <span class="math inline">\([0,2\pi]\)</span>, then the sequence <span class="math inline">\(\{f(x_n)\}_{n\in\mathbb{N}}\)</span> is also <strong>dense</strong> on the image set of <span class="math inline">\(f(\cdot)\)</span>. When <span class="math inline">\(x_n=n\alpha \mbox{ mod } 2\pi\)</span> generates a <strong>dense set</strong> on <span class="math inline">\([0,2\pi]\)</span>, then <span class="math inline">\(f(x_n)=\mbox{e}^{\mbox{i}\alpha x_n}\)</span> or the wave terms <span class="math inline">\(\cos(n\alpha)\)</span> and <span class="math inline">\(\sin(n\alpha)\)</span> will also generate the <strong>dense set</strong> on the <strong>complex unit circle</strong>.</span>
<span class="math display">\[\lim_{N\rightarrow\infty}\frac{1}{N}\sum_{n=1}^{N}f((n \alpha)\mbox{ mod }2\pi)=\int_{0}^{2\pi}f(\theta)\mbox{d}\theta.\]</span> This theorem serves as the cornerstone for the <a href="ch-representation.html#sub:pseudoRandom">pseudo-random number generators</a>, <a href="ch-CalUn.html#sub:divRV">monte Carol</a> integrals, as well as numerous arguments about the convergences of <a href="ch-CalUn.html#sub:rv">distribution functions</a> of (true) random variables.</p>
<div class="solution">
<p class="solution-begin">
Equidistribution <span id="sol-start-133" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-133', 'sol-start-133')"></span>
</p>
<div id="sol-body-133" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb192-1" data-line-number="1"><span class="co"># sequence of k objects</span></a>
<a class="sourceLine" id="cb192-2" data-line-number="2">k =<span class="st"> </span><span class="dv">8</span>; <span class="co"># try k = 5 to see the difference </span></a>
<a class="sourceLine" id="cb192-3" data-line-number="3">a =<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">^</span>(<span class="dv">1</span><span class="op">:</span>k)); a=<span class="dv">2</span><span class="op">*</span>pi<span class="op">*</span>a;</a>
<a class="sourceLine" id="cb192-4" data-line-number="4"><span class="co"># from z_k: a = 1/(1:k); a=2*pi*(a+sqrt(2)); # replace sqrt(2) with 2 to see the difference</span></a>
<a class="sourceLine" id="cb192-5" data-line-number="5"><span class="co"># n rotation </span></a>
<a class="sourceLine" id="cb192-6" data-line-number="6">data =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">n=</span><span class="kw">rep</span>(<span class="dv">1</span>,<span class="kw">length</span>(a)),<span class="dt">x=</span><span class="kw">sin</span>(a),<span class="dt">y=</span><span class="kw">cos</span>(a))</a>
<a class="sourceLine" id="cb192-7" data-line-number="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>){</a>
<a class="sourceLine" id="cb192-8" data-line-number="8">  n =<span class="st"> </span><span class="dv">10</span><span class="op">^</span>i</a>
<a class="sourceLine" id="cb192-9" data-line-number="9">  x =<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">sin</span>((<span class="dv">1</span><span class="op">:</span>n)<span class="op">%*%</span><span class="kw">t</span>(a))); y =<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">cos</span>((<span class="dv">1</span><span class="op">:</span>n)<span class="op">%*%</span><span class="kw">t</span>(a))); </a>
<a class="sourceLine" id="cb192-10" data-line-number="10">  add.data =<span class="kw">data.frame</span>(<span class="dt">n=</span><span class="kw">rep</span>(<span class="kw">as.character</span>(n),<span class="kw">length</span>(x)),x,y)   </a>
<a class="sourceLine" id="cb192-11" data-line-number="11">  data =<span class="st"> </span><span class="kw">rbind</span>(data, add.data)</a>
<a class="sourceLine" id="cb192-12" data-line-number="12">}</a>
<a class="sourceLine" id="cb192-13" data-line-number="13"><span class="co"># Plot</span></a>
<a class="sourceLine" id="cb192-14" data-line-number="14"><span class="kw">library</span>(ggplot2); <span class="kw">library</span>(gganimate)</a>
<a class="sourceLine" id="cb192-15" data-line-number="15"><span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> n)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st">  </span><span class="kw">transition_states</span>(n)</a></code></pre></div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><span class="newthought">From cyclic groups to character and convolution</span></p>
<p>It turns out that we can “project” the group objects onto the standard <strong>cyclic group</strong> <span class="math inline">\((\mathcal{U},\times)\)</span>. The “projection” is to extract the <strong>characters</strong> of the objects.</p>
<ul>
<li>
<strong>Character</strong> : A <em>character</em> <span class="math inline">\(\mathbf{F}\)</span> of a group <span class="math inline">\((\mathcal{G},\ast)\)</span> is a <a href="ch-complexAn.html#sub:coupling">homeomorphism</a> to the <strong>complex unit circle</strong> such that <span class="math inline">\(\mathbf{F}:(\mathcal{G},\ast)\rightarrow(\mathcal{U},\times)\)</span> and <span class="math display">\[\mathbf{F}(f\ast g)=\mathbf{F}(f)\times\mathbf{F}(g)\]</span>
for every <span class="math inline">\(f,g\in\mathcal{G}\)</span>.</li>
</ul>
<p>In other words, the <strong>character</strong> <span class="math inline">\(\mathbf{F}\)</span> makes two sets <span class="math inline">\(\mathcal{G}\)</span> and <span class="math inline">\(\mathcal{U}\)</span> compatible with their group structures.
Let’s concentrate on a particular <strong>character</strong>, the <a href="ch-representation.html#sub:conjugacy">Fourier transform</a>, <span class="math display">\[\mathbf{F}_\theta(f)=\langle f, \mbox{e}^{\mbox{i}\theta} \rangle = \frac{1}{2\pi}\int_{-\infty}^{\infty} f(x) \mbox{e}^{-\mbox{i}\theta x}\mbox{d}x\]</span> for any bounded continuous function <span class="math inline">\(f\)</span>. This <strong>character</strong> connects the <a href="ch-harmonicAn.html#sub:heatEq">algebraic structures</a> of the <a href="ch-CalUn.html#sub:divRV">convolution</a> operation <span class="math inline">\((\star)\)</span> on the space of all bounded continuous functions <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span> and the multiplicative operation <span class="math inline">\((\times)\)</span> on the complex unit circle <span class="math inline">\(\mathcal{U}\)</span> such that
<span class="math display">\[\mathbf{F}_\theta(f \star g)=\mathbf{F}_\theta (f) \cdot \mathbf{F}_\theta(g)\]</span>
for <span class="math inline">\(f,g\in \mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span>.<label for="tufte-sn-599" class="margin-toggle sidenote-number">599</label><input type="checkbox" id="tufte-sn-599" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">599</span> Note that although <span class="math inline">\(L^1(\mathbb{R})\)</span> is not a <a href="ch-MatComp.html#sub:vecSpaces">subspace</a> of <span class="math inline">\(L^2(\mathbb{R})\)</span>, <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span> is a <a href="ch-MatComp.html#sub:vecSpaces">subspace</a> of <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^2 (\mathbb{R})\)</span>. The proof is given below.</span></p>
<div class="solution">
<p class="solution-begin">
Proof <span id="sol-start-134" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-134', 'sol-start-134')"></span>
</p>
<div id="sol-body-134" class="solution-body" style="display: none;">
<p>For any <span class="math inline">\(f\in \mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span>, <span class="math inline">\(f\)</span> is bounded, say <span class="math inline">\(|f(x)|\leq c\)</span> for any <span class="math inline">\(x\in\mathbb{R}\)</span>. Then <span class="math display">\[|f(x)|^{2}\leq c|f(x)|,\]</span>
which implies that
<span class="math display">\[\int|f(x)|^{2}\mbox{d}x\leq c\int|f(x)|\mbox{d}x=c\|f\|_{1}.\]</span>
Because <span class="math inline">\(f\in \mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span>
and <span class="math inline">\(\|f\|_{1}\)</span> is finite, the former integral must be finite, namely <span class="math inline">\(f\in \mathcal{C}_b(\mathbb{R})\cap L^2 (\mathbb{R})\)</span>. That’s to say, any element in <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span> must also be the element in <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^2 (\mathbb{R})\)</span>.</p>
<p>Thus, <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span> is a subspace of <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^2 (\mathbb{R})\)</span>.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>The above result also is known as the <em>convolution theorem</em>. It states that the Fourier transform of a convolution is the pointwise product of Fourier transforms.<label for="tufte-sn-600" class="margin-toggle sidenote-number">600</label><input type="checkbox" id="tufte-sn-600" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">600</span> Technically speaking, the major use of this result is for the <a href="ch-representation.html#sub:conjugacy">completion</a> of the <span class="math inline">\(L^{1}\)</span> space. Consider any function <span class="math inline">\(f:\mathbb{R}\rightarrow\mathbb{C}\)</span> in the <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span>. The space <span class="math inline">\(\mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span> is a pre-Hilbert space. By the <a href="ch-representation.html#sub:conjugacy">completion</a>, we can map <span class="math inline">\(f\)</span> to a completed <span class="math inline">\(L^{2}\)</span>-space (the <strong>complex unit circle</strong>) that is spanned by the orthonormal basis (Fourier basis). That is, for every <span class="math inline">\(f\in \mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\)</span>, we have <span class="math inline">\(\hat{f}=\mathbf{F}(f)\in \mathcal{C}_b(\mathbb{R})\cap L^2 (\mathbb{R})\)</span> and <span class="math inline">\(\|f\|=\|\hat{f}\|\)</span>. The map <span class="math display">\[\mathbf{F}(\cdot):\mathcal{C}_b(\mathbb{R})\cap L^1 (\mathbb{R})\rightarrow \mathcal{C}_b(\mathbb{R})\cap L^2 (\mathbb{R})\]</span> is the Fourier transformation. In particular, when the map is <span class="math display">\[\mathbf{F}(\cdot):\mathcal{C}_b(\mathbb{R})\cap L^2 (\mathbb{R})\rightarrow \mathcal{C}_b(\mathbb{R})\cap L^2 (\mathbb{R}),\]</span>
the Fourier transformation is a <a href="ch-representation.html#sub:dualBasis">unitary</a> map.</span></p>
<p>To have a better understanding of this theorem, let’s consider a specific example. The <a href="ch-representation.html#sub:conjugacy">Fourier representations</a> for the continuous bounded functions <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are:<label for="tufte-sn-601" class="margin-toggle sidenote-number">601</label><input type="checkbox" id="tufte-sn-601" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">601</span> As they are in a subspace of <span class="math inline">\(L^2\)</span>, their Fourier representations exist.</span> <span class="math display">\[\begin{align*}f(x)&amp;=\sum_{m=-\infty}^{\infty}a_m\mbox{e}^{\mbox{i}mx}=\sum_{m=\infty}^{\infty}(\mathbf{F}_mF)\mbox{e}^{\mbox{i}mx}\\
  G(x)&amp;=\sum_{n=-\infty}^{\infty}b_n\mbox{e}^{\mbox{i}nx}=\sum_{n=-\infty}^{\infty}(\mathbf{F}_ng)\mbox{e}^{\mbox{i}nx}.\end{align*}\]</span>
Then the product of <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(x)\)</span> follows <span class="math display">\[\begin{align*}f(x)g(x)&amp;=\sum_{j=-\infty}^{\infty}\mathbf{F}_m(f)\cdot\mathbf{F}_n(g)\mbox{e}^{-\mbox{i}jx}\\&amp;=\sum_{j=-\infty}^{\infty}\mathbf{F}_{j}(f\star g)\mbox{e}^{\mbox{i}jx}=\sum_{j=-\infty}^{\infty}c_j\mbox{e}^{\mbox{i}jx}.\end{align*}\]</span></p>
<p>More specifically, for two polynomials <span class="math display">\[\begin{align*}f(x)&amp;=a_{1}+\cdots+a_{m}x^{m-1}=\left[\begin{array}{c}
a_{1}\\
\vdots\\
a_{m}
\end{array}\right]^{\top}\left[\begin{array}{c}
1\\
\vdots\\
x^{m-1}
\end{array}\right]=\mathbf{a}^{\top}\mathbf{p}(x)\\
g(x)&amp;=b_{1}+\cdots+b_{n}x^{n-1}=\left[\begin{array}{c}
b_{1}\\
\vdots\\
b_{n}
\end{array}\right]^{\top}\left[\begin{array}{c}
1\\
\vdots\\
x^{n-1}
\end{array}\right]=\mathbf{b}^{\top}\mathbf{q}(x),\end{align*}\]</span> the multiplication of <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(x)\)</span> is<label for="tufte-sn-602" class="margin-toggle sidenote-number">602</label><input type="checkbox" id="tufte-sn-602" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">602</span> As you can see, the only important information regarding the multiplication of <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> relies on the coefficient vector <span class="math inline">\(\mathbf{c}\)</span> that is, in fact, the <a href="ch-CalUn.html#sub:divRV">convolution</a> of the coefficient vectors <span class="math inline">\(\mathbf{a}\)</span> and <span class="math inline">\(\mathbf{b}\)</span>.</span> <span class="math display">\[f(x)g(x)=h(x)=\left[\begin{array}{c}
c_{1}\\
\vdots\\
c_{n+m}
\end{array}\right]^{\top}\left[\begin{array}{c}
1\\
\vdots\\
x^{n+m-1}
\end{array}\right]=\mathbf{c}^{\top}\mathbf{k}(x)\\
\mbox{where } c_{d}=\sum_{l}a_{l}b_{d-l+1}, \mbox{for }\:1\leq d\leq n+m.\]</span></p>
<p>For example, consider <span class="math inline">\(f(x)=1-x^{2}\)</span> and <span class="math inline">\(g(x)=x+2x^{2}\)</span>. The multiplication of <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(x)\)</span> is <span class="math inline">\(h(x)=x+2x^{2}-x^{3}-2x^{4}\)</span>. Now we turn to the coefficient vectors. For <span class="math inline">\(f(x)\)</span>
and <span class="math inline">\(g(x)\)</span>, <span class="math inline">\(\mathbf{a}=[1,0,-1]\)</span> and <span class="math inline">\(\mathbf{b}=[0,1,2]\)</span>. The convolution of <span class="math inline">\(\mathbf{a}\)</span> and <span class="math inline">\(\mathbf{b}\)</span> is
<span class="math display">\[\mathbf{a}\star\mathbf{b}=\left[\begin{array}{c}
a_{1}b_{1}\\
a_{1}b_{2}+a_{2}b_{1}\\
a_{1}b_{3}+a_{2}b_{2}+a_{3}b_{1}\\
a_{2}b_{3}+a_{3}b_{2}\\
a_{3}b_{3}
\end{array}\right]=\left[\begin{array}{c}
0\\
1\\
2\\
-1\\
-2
\end{array}\right]\]</span> which is the coefficient vector of <span class="math inline">\(h(x)\)</span>.</p>
<p>Now we have displayed the full chain between the periodicity and Fourier series.
Intuitively, one can think of <a href="ch-representation.html#sub:conjugacy">Fourier transformation</a> as a <strong>characteristic</strong> “projection.” It “projects” some object onto a <strong>cyclic group</strong> in order to construct its continuous periodic counterpart.<label for="tufte-sn-603" class="margin-toggle sidenote-number">603</label><input type="checkbox" id="tufte-sn-603" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">603</span> For a function, the Fourier transformation is a projection from <span class="math inline">\(\mathbb{R}\)</span> to <span class="math inline">\(\mathbb{R}/\mathbb{Z}\)</span> to give a continuous periodic function on <span class="math inline">\(\mathbb{R}\)</span>.</span> For the new periodic object, one can represent it by the Fourier series that consists of the generators <span class="math inline">\(\mbox{e}^{\mbox{i}\theta}\)</span> from the group <span class="math inline">\((\mathcal{U},\times)\)</span> or the wave terms <span class="math inline">\(\cos(nk)\)</span> and <span class="math inline">\(\sin(nk)\)</span> from the group <span class="math inline">\((\mathcal{U}_k,\times)\)</span>. The <strong>character</strong> also reveals the relationship of the <a href="ch-harmonicAn.html#sub:heatEq">algebraic structure</a> under this “projection”: a convoluting object becomes a product of two separating objects.<label for="tufte-sn-604" class="margin-toggle sidenote-number">604</label><input type="checkbox" id="tufte-sn-604" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">604</span> In practice, aperiodic convolution can be expressed as a product of polynomials, and cyclic convolution is equivalent to a product of polynomials in a special <a href="ch-harmonicAn.html#sub:heatEq">group</a> called the polynomial ring.</span></p>
<p><span class="newthought">From convolution to mean value property</span></p>
<p><a href="ch-CalUn.html#sub:divRV">Convolution</a> is a special integral operation. <a href="ch-CalUn.html#sub:divRV">Convolutions</a> are often used to regularize functions. For example, if <span class="math inline">\(f\)</span> is integrable and <span class="math inline">\(g\)</span> is infinitely differentiable (smooth), then <span class="math inline">\(f\star g\)</span> is infinitely differentiable. Furthermore, if <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> are integrable, then <span class="math inline">\(f\star g\)</span> is continuous.<label for="tufte-sn-605" class="margin-toggle sidenote-number">605</label><input type="checkbox" id="tufte-sn-605" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">605</span> We know that the <a href="ch-randomization.html#sub:RHilbert">delta function</a> is not differentiable in the general sense. But if we have a differentiable function <span class="math inline">\(f(x)\)</span>, its derivative at an arbitrary point <span class="math inline">\(a\)</span> can be defined as <span class="math display">\[\begin{align*}\left.\frac{\mbox{d}f(x)}{\mbox{d}x}\right|_{x=a} &amp;=v(a)\\
&amp;=\int\frac{\mbox{d}f(x)}{\mbox{d}x}\delta(a-x)\mbox{d}x \\ &amp;=\int f(x)\frac{\mbox{d}\delta(a-x)}{\mbox{d}x}\mbox{d}x \end{align*}\]</span>
where the last equality comes from the use of <a href="sub-calculus.html#sub:diffInt">the differentiation rule of products</a> such that <span class="math inline">\(\mathbf{D}f \star g = f\star \mathbf{D}g\)</span> for the differentiation operator <span class="math inline">\(\mathbf{D}\)</span>. Therefore, even though the differentiation of <span class="math inline">\(\delta(\cdot)\)</span> is not defined in general, one can represent this differentiation through the convolution <span class="math inline">\(v(a)=f\star(\frac{\mbox{d}\delta}{\mbox{d}x})\)</span>, where <span class="math inline">\(\delta\)</span> becomes “differentiable.”</span> In figure <a href="ch-representation.html#fig:Fourier">14.3</a>, we saw that the non-smoothness and discontinuity caused the irregular behaviors of the Fourier series. To eliminate the problems, one often need to convolute or integrate with a smooth and integrable function, called the integrated <em>kernel</em>. The <strong>kernel</strong> needs to be approximate to an identity under the integration so that, on average, it shouldn’t distort the underlying information. The construction of the <strong>kernel function</strong> relates to the <strong>mean value property</strong> of the <a href="ch-complexAn.html#sub:complexCal">analytic functions</a> / <a href="ch-harmonicAn.html#sub:heatEq">harmonic functions</a>.</p>
<p>Consider an <a href="ch-complexAn.html#sub:complexCal">analytic function</a> <span class="math inline">\(f(z)=u(z)+\mbox{i}v(z)\)</span>, where <span class="math inline">\(u\)</span> and <span class="math inline">\(v\)</span> are <a href="ch-harmonicAn.html#sub:heatEq">harmonic functions</a>. For a path of the complex circle centering at <span class="math inline">\(z\)</span>, say <span class="math inline">\(\gamma(\beta)=z+r\mbox{e}^{\mbox{i}\beta}\)</span> with <span class="math inline">\(\gamma:[0,2\pi]\rightarrow\mathbb{C}\)</span>, the <a href="ch-eigen.html#sub:det">polar coordinate representation</a> <span class="math inline">\(z=r\mbox{e}^{\mbox{i}t}\)</span> of the <a href="ch-complexAn.html#sub:complexCal">Cauchy integral</a> gives
<span class="math display">\[\begin{align*}
f(z)&amp;=\frac{1}{2\pi\mbox{i}}\int_{\gamma}\frac{f(w)}{w-z}\mbox{d}w =\frac{1}{2\pi\mbox{i}}\int_{0}^{2\pi}\frac{f(z+r\mbox{e}^{\mbox{i}\beta})}{r\mbox{e}^{\mbox{i}\beta}}r\mbox{i}\mbox{e}^{\mbox{i}\beta}\mbox{d}\beta\\
&amp;=\frac{1}{2\pi}\int_{0}^{2\pi}f(z+r\mbox{e}^{\mbox{i}\beta})\mbox{d}\beta.\end{align*}\]</span>
This representation simply says that the value of <span class="math inline">\(f(z)\)</span> is the same as the average value of the function going through a circle centering at <span class="math inline">\(z\)</span>. This is called the <em>mean value property</em> of the <a href="ch-complexAn.html#sub:complexCal">analytical function</a> <span class="math inline">\(f(\cdot)\)</span>. The <strong>mean value property</strong> of the <a href="ch-harmonicAn.html#sub:heatEq">harmonic function</a> <span class="math inline">\(u\)</span> is
<span class="math display">\[u(z)=\frac{1}{2\pi}\int_{0}^{2\pi}u(z+r\mbox{e}^{\mbox{i}\beta})\mbox{d}\beta.\]</span></p>
<p>Let’s elaborate on this property. Note that the length of the radius <span class="math inline">\(r\)</span> can be arbitrarily chosen. Because the value of <span class="math inline">\(r\)</span> does not matter, we can simply set <span class="math inline">\(r=1\)</span>. So we will work on the <strong>complex unit circle</strong>. Now suppose we can “express” <span class="math inline">\(f(z+ r\mbox{e}^{\mbox{i}\beta})\)</span> as an integral of <span class="math inline">\(f(\cdot)\)</span> on the unit circle, namely <span class="math inline">\(f(\mbox{e}^{\mbox{i}\beta})\)</span>, with an <strong>integrated kernel</strong> function, i.e.,
<span class="math display">\[f(z)=\frac{1}{2\pi}\int^{2\pi}_{0} f(z+ r\mbox{e}^{\mbox{i}\beta})\mbox{d}\beta = \frac{1}{2\pi}\int^{2\pi}_{0} f(\mbox{e}^{\mbox{i}\beta}) K(\beta,z) \mbox{d}\beta\]</span> where <span class="math inline">\(K(\beta,z)\)</span> is the <strong>kernel function</strong>.<label for="tufte-sn-606" class="margin-toggle sidenote-number">606</label><input type="checkbox" id="tufte-sn-606" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">606</span> The intuitive motivation is as follows. Suppose we have a vector <span class="math inline">\(\mathbf{f}\)</span>, and we want <span class="math inline">\(\mathbf{f}\)</span> to be represented by another vector <span class="math inline">\(\mathbf{g}\)</span>. We would seek a matrix <span class="math inline">\(\mathbf{K}\)</span> such that <span class="math inline">\(\mathbf{f}=\mathbf{K}\mathbf{g}\)</span>. Now we imagine that the vectors are simply data generated by the function <span class="math inline">\(f(x)\)</span> and <span class="math inline">\(g(y)\)</span>, then <span class="math inline">\(\mathbf{K}\)</span> is the matrix realization of the <strong>integrated kernel</strong> <span class="math inline">\(K(x,y)\)</span> such that <span class="math inline">\(f(x)=\int K(x,y)g(y)\mbox{d}y\)</span>.</span> Then we would arrive at a better representation using only the value of <span class="math inline">\(f(\cdot)\)</span> evaluated at the <strong>complex unit circle</strong>.</p>
<p>Such a <strong>kernel function</strong> <span class="math inline">\(K(\beta,z)\)</span> exists. It is called the <strong>Poisson kernel</strong>. We list different specific forms of the <em>Poisson kernel</em> below:
<span class="math display">\[\begin{align*}\mbox{Poisson kernel:} &amp; \, f(z)= \frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\underset{K(\beta,z)}{\underbrace{\mbox{Re}\left(\frac{\mbox{e}^{\mbox{i}\beta}+z}{\mbox{e}^{\mbox{i}\beta}-z}\right)}}\mbox{d}\beta,
 \\
\mbox{Polar form:} &amp; \, f(r\mbox{e}^{\mbox{i}\theta})=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\underset{K_{r}(\theta-\beta)}{\underbrace{\frac{1-r^{2}}{1-2r\cos(\theta-\beta)+r^{2}}}}\mbox{d}\beta, \\
\mbox{Series form:} &amp; \, f(r\mbox{e}^{\mbox{i}\theta})= \frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\underset{K_{r}(\theta-\beta)}{\underbrace{\left(\sum_{n=-\infty}^{\infty}r^{|n|}\mbox{e}^{\mbox{i}n(\theta-\beta)}\right)}}\mbox{d}\beta. \end{align*}\]</span></p>
<p>It is easy to see that the <strong>Poisson kernel</strong> <span class="math inline">\(K_r(\theta)\)</span> is a symmetry function of <span class="math inline">\(\theta\)</span>, <span class="math inline">\(K_r(\theta)\geq 0\)</span> for all <span class="math inline">\(\theta\)</span> and <span class="math inline">\(\int_{0}^{2 \pi}K_r(\theta)\mbox{d}\theta = 1\)</span>.<label for="tufte-sn-607" class="margin-toggle sidenote-number">607</label><input type="checkbox" id="tufte-sn-607" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">607</span> For symmetric, note that <span class="math inline">\(\cos(\cdot)\)</span> is a symmetric function. So the polar form tells the symmetricity. Also, the polar form tells the positivity. To see <span class="math inline">\(\int_{0}^{2 \pi}K_r(\theta)\mbox{d}\theta = 1\)</span>, let’s use a dirty trick. Set <span class="math inline">\(f\)</span> to be a constant function <span class="math inline">\(c\)</span>. The <strong>mean value property</strong> tells that <span class="math inline">\(c=\int_{0}^{2\pi} c K_r(\theta)\mbox{d}\theta\)</span>, namely <span class="math inline">\(\int_{0}^{2\pi} K_r(\theta)\mbox{d}\theta=1\)</span>.</span></p>
<div class="solution">
<p class="solution-begin">
Poisson kernel <span id="sol-start-135" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-135', 'sol-start-135')"></span>
</p>
<div id="sol-body-135" class="solution-body" style="display: none;">
<ol style="list-style-type: decimal">
<li>Poisson kernel.</li>
</ol>
<p>Assume that <span class="math inline">\(z\)</span> is inside the unit circle. We set the path of <span class="math inline">\(\gamma\)</span> on the unit circle such that <span class="math inline">\(|w|=1=\mbox{e}^{\mbox{i}\theta}\)</span>, the original <a href="ch-complexAn.html#sub:complexCal">Cauchy integral</a> <span class="math display">\[f(z)=\frac{1}{2\pi\mbox{i}}\int_{\gamma}\frac{f(w)}{w-z}\mbox{d}w\]</span>
can be written as
<span class="math display">\[\begin{align*}
f(z)=\frac{1}{2\pi}\int_{0}^{2\pi}\frac{f(\mbox{e}^{\mbox{i}\beta})}{\mbox{e}^{\mbox{i}\beta}-z}\mbox{d}\beta=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\left[\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-z}\right]\mbox{d}\beta.
\end{align*}\]</span></p>
<p>On the other hand, recall that the <a href="ch-complexAn.html#sub:complexCal">Cauchy integral</a> is non-zero because of the <a href="ch-complexAn.html#sub:complexCal">singularity</a> caused by <span class="math inline">\(w-z=0\)</span>. Since <span class="math inline">\(z\)</span> is inside the unit circle, <span class="math inline">\(1/\bar{z}\)</span> must lie outside the unit circle. By replacing <span class="math inline">\(z\)</span> with <span class="math inline">\(1/\bar{z}\)</span> in the above formula, we will be able to remove the singularity and we can apply the <a href="ch-complexAn.html#sub:complexCal">fundamental theorem of the complex integral</a>,
<span class="math display">\[\begin{align*}
0=\frac{1}{2\pi\mbox{i}}\int_{\gamma}\frac{f(w)}{w-(\bar{z})^{-1}}\mbox{d}w=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\left[\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-(\bar{z})^{-1}}\right]\mbox{d}\beta.\end{align*}\]</span>
Rearrange the expression <span class="math display">\[\begin{align*}\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-(\bar{z})^{-1}}&amp;=\frac{\bar{z}\mbox{e}^{\mbox{i}\beta}}{\bar{z}\mbox{e}^{\mbox{i}\beta}-1}=\frac{-\bar{z}}{\mbox{e}^{\mbox{i}\beta}-\bar{z}}\\&amp;=1-\frac{\mbox{e}^{-\mbox{i}\beta}}{\mbox{e}^{-\mbox{i}\beta}-\bar{z}}=\overline{\left[1-\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-\bar{z}}\right]}.
\end{align*}\]</span></p>
<p>We combine the two cases of the integrals
<span class="math display">\[\begin{align*}f(z)-0  &amp;=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\left[\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-z}\right]\mbox{d}t-\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\left[\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-(\bar{z})^{-1}}\right]\mbox{d}\beta\\
    &amp;=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\left[\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-z}+\overline{\left(\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-\bar{z}}\right)}-1\right]\mbox{d}\beta\\
    &amp;=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\left[2\mbox{Re}\left(\frac{\mbox{e}^{\mbox{i}\beta}}{\mbox{e}^{\mbox{i}\beta}-z}\right)-1\right]\mbox{d}\beta\\
    &amp;=\frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})\mbox{Re}\left(\frac{\mbox{e}^{\mbox{i}\beta}+z}{\mbox{e}^{\mbox{i}\beta}-z}\right)\mbox{d}\beta.\end{align*}\]</span>
The result follows.</p>
<ol start="2" style="list-style-type: decimal">
<li>Polar form.</li>
</ol>
<p>We set <span class="math inline">\(z=r\mbox{e}^{\mbox{i}\theta}\)</span>. Then we have <span class="math display">\[\begin{align*}\frac{\mbox{e}^{\mbox{i}\beta}+r\mbox{e}^{\mbox{i}\theta}}{\mbox{e}^{\mbox{i}\beta}-r\mbox{e}^{\mbox{i}\theta}}&amp;=\frac{(\mbox{e}^{\mbox{i}\beta}+r\mbox{e}^{\mbox{i}\theta})(\mbox{e}^{-\mbox{i}\beta}-r\mbox{e}^{-\mbox{i}\theta})}{(\mbox{e}^{\mbox{i}\beta}-r\mbox{e}^{\mbox{i}\theta})(\mbox{e}^{-\mbox{i}\beta}-r\mbox{e}^{-\mbox{i}\theta})}\\&amp;=\frac{-r^{2}+1+2\mbox{i}r\sin(\theta-\beta)}{r^{2}-2r\cos(\theta-\beta)+1}\end{align*}\]</span>
where we applied the definition <span class="math inline">\(\sin x=\frac{\mbox{e}^{\mbox{i}x}-\mbox{e}^{\mbox{-i}x}}{2\mbox{i}}\)</span> and <span class="math inline">\(\cos x=\frac{\mbox{e}^{\mbox{i}x}+\mbox{e}^{-\mbox{i}x}}{2}\)</span>. The real part of the ratio is<span class="math display">\[\frac{1-r^{2}}{1-2r\cos(\theta-\beta)+r^{2}}.\]</span>
So the full expression becomes <span class="math display">\[f(z)=f(r\mbox{e}^{\mbox{i}\theta})=\frac{1}{2\pi}\int_{0}^{2\pi}\frac{1-r^{2}}{1-2r\cos(\theta-\beta)+r^{2}}f(\mbox{e}^{\mbox{i}\beta})\mbox{d}\beta.\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Series form.</li>
</ol>
<p>The polar form gives<span class="math display">\[\frac{1}{2\pi}\int_{0}^{2\pi}\frac{1-r^{2}}{1-2r\cos(\theta-\beta)+r^{2}}f(\mbox{e}^{\mbox{i}\beta})\mbox{d}\beta \]</span>
Let <span class="math inline">\(w=r\mbox{e}^{\mbox{i}(\theta-\beta)}\)</span>, we have <span class="math display">\[\frac{1}{2}\frac{1+w}{1-w}=\frac{1}{1-w}-\frac{1}{2}=\sum_{n=0}^{\infty}w^{n}-\frac{1}{2},\]</span>
and <span class="math inline">\(w\bar{w}=r^{2}\)</span>, and <span class="math display">\[w+\bar{w}=2\mbox{Re}w=2r\cos(\beta-\theta).\]</span>
Then the kernel in the polar form can be written as
<span class="math display">\[\begin{align*}\frac{1-r^{2}}{1-2r\cos(\beta-\theta)+r^{2}}   &amp;=\frac{1-w\bar{w}}{1-(w+\bar{w})+w\bar{w}}\\
    &amp;=\frac{1}{2}\frac{(1+w)(1-\bar{w})+(1+\bar{w})(1-w)}{(1-w)(1-\bar{w})}\\
    &amp;=\frac{1}{2}\frac{1+w}{1-w}+\frac{1}{2}\frac{1+\bar{w}}{1-\bar{w}}=\sum_{n=0}^{\infty}w^{n}+\sum_{n=0}^{\infty}\bar{w}^{n}-1\\
    &amp;=\cdots+\bar{w}^{2}+\bar{w}+1+w+w^{2}+\cdots\\
    &amp;=\sum_{-\infty}^{\infty}r^{|n|}\mbox{e}^{\mbox{i}n(\beta-\theta)}\end{align*}\]</span>
The result follows.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><span class="newthought">From mean value property to Brownian motion</span></p>
<p>The last expression of the <strong>Poisson kernel</strong> connects to <a href="ch-representation.html#sub:innerProd">Fourier basis</a>. Note that for bounded continuous functions, we can interchange the integral and summation operations. The last expression becomes
<span class="math display">\[\begin{align*}f(r\mbox{e}^{\mbox{i}\theta})&amp;=\sum_{n=-\infty}^{\infty} \left( \frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta}) \mbox{e}^{-\mbox{i}n\beta} \mbox{d}\beta \right) r^{|n|}\mbox{e}^{\mbox{i}n \theta}\\ &amp;= \sum_{n=-\infty}^{\infty}(\mathbf{F}_nf) r^{|n|}\mbox{e}^{\mbox{i}n \theta}
=\sum_{n=-\infty}^{\infty}c_nr^{|n|}\mbox{e}^{\mbox{i}n \theta},\end{align*}\]</span>
where <span class="math inline">\(\{c_n\}\)</span> are the Fourier coefficients of <span class="math inline">\(f(\cdot)\)</span> on the unit circle. Let <span class="math inline">\(r=1\)</span>, <span class="math inline">\(f(z)=\sum_{n=-\infty}^{\infty}c_n \mbox{e}^{\mbox{i}n \theta}\)</span> is the representation of the <a href="ch-representation.html#sub:innerProd">Fourier basis</a> generated by <span class="math inline">\(\mbox{e}^{\mbox{i} \theta}\)</span>. The Fourier series is infinitely differentiable and is harmonic, so does the <strong>Poisson kernel</strong> <span class="math inline">\(K(\cdot,\cdot)\)</span>.<label for="tufte-sn-608" class="margin-toggle sidenote-number">608</label><input type="checkbox" id="tufte-sn-608" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">608</span> The infinite differentiability is obvious as the representation has the exponential <span class="math inline">\(\mbox{e}^{\mbox{i}n\theta}\)</span>. Let’s consider the harmonicity. Given the radius <span class="math inline">\(r\)</span>, for any analytic function <span class="math inline">\(f\)</span>, the <strong>mean value property</strong> of the last expression says <span class="math display">\[\begin{align*}f(\theta) &amp;= \frac{1}{2\pi}\int_{0}^{2\pi}f(\mbox{e}^{\mbox{i}\beta})K_{r}(\theta-\beta)\mbox{d}\beta\\ 
&amp;= f\star K_r (\theta).\end{align*}\]</span>
If <span class="math inline">\(f\)</span> is a harmonic function, say <span class="math inline">\(\Delta f =0\)</span>, we can write the convolution as <span class="math display">\[\Delta f = \Delta f \star K_r = f \star \Delta K_r = 0,\]</span>
which tells that the Poisson kernel <span class="math inline">\(K_r\)</span> is also harmonic <span class="math inline">\(\Delta K_r=0\)</span>.</span></p>
<p>So far, we have seen that a continuous second-order differentiable <a href="ch-harmonicAn.html#sub:heatEq">harmonic function</a> can have the <strong>mean value property</strong> with respect to the <strong>Poisson kernel</strong>. In fact, the converse statement is also true.<label for="tufte-sn-609" class="margin-toggle sidenote-number">609</label><input type="checkbox" id="tufte-sn-609" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">609</span> Here is the intuition about the converse statement. For any continuous second-order differentiable function <span class="math inline">\(u\)</span>, the <strong>mean value property</strong> implies that <span class="math inline">\(u(\theta) = u \star K_r(\theta)\)</span> is a convolution of the infinitely differentiable <strong>Poisson kernel</strong> <span class="math inline">\(K\)</span>, so <span class="math inline">\(u(\theta)\)</span> must be infinitely differentiable. Thus, we can take the <a href="ch-harmonicAn.html#sub:heatEq">Laplacian</a> operator on <span class="math inline">\(u(\theta)\)</span>, which results in <span class="math display">\[\Delta u(\theta) = u\star \Delta K_r = 0,\]</span> because <span class="math inline">\(\Delta K_r=0\)</span>.</span> Together, we arrive at the conclusion that a continuous second-order differentiable function <span class="math inline">\(u\)</span> satisfies the <strong>mean value property</strong> (for the <strong>Poisson kernel</strong>) if and only if it is a <a href="ch-harmonicAn.html#sub:heatEq">harmonic function</a>.</p>
<p>There are various kernels. For different kernels, we would have different types of <strong>mean value properties</strong>. To close the tour, we will consider how does the <strong>mean value properties</strong> of the <strong>heat kernel</strong> work for the <a href="ch-randomization.html#sub:RHilbert">Brownian motion</a>.</p>
<p>A <span class="math inline">\(d\)</span>-dimensional <em>heat kernel</em> (or called <em>Gaussian kernel</em>) is a transition function <span class="math inline">\({K}_{d}(\cdot,\cdot):(0,\infty)\times\mathbb{R}^{d}\rightarrow(0,\infty)\)</span> such that
<span class="math display">\[{K}_{d}(t,\mathbf{x})=\frac{1}{(4\pi t)^{\frac{d}{2}}}\mbox{e}^{-\frac{\|\mathbf{x}\|^{2}}{4t}}.\]</span> The <strong>heat kernel</strong> is the solution of the <span class="math inline">\(d\)</span>-dimensional heat equation, namely <span class="math display">\[\frac{{K}_{d}(t,\mathbf{x})}{\partial t}=\Delta {K}_{d}(t,\mathbf{x})\]</span> where the <strong>Laplacian operator</strong> satisfies <span class="math inline">\(\Delta K_d(t,\mathbf{x})=\sum_{i=1}^{d} \frac{\partial^{2}K_d(t,\mathbf{x})}{\partial x_{i}^{2}}\)</span>.</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:2dBM"></span>
<img src="fig/Part5/2dBM.gif" alt="2D Brownian motion under the fixed heat distribution" width="100%"><!--
<p class="caption marginnote">-->Figure 18.5: 2D Brownian motion under the fixed heat distribution<!--</p>-->
<!--</div>--></span>
</p>
<div class="solution">
<p class="solution-begin">
Code <span id="sol-start-136" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-136', 'sol-start-136')"></span>
</p>
<div id="sol-body-136" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb193-2" data-line-number="2"><span class="co"># restore the previous heat data</span></a>
<a class="sourceLine" id="cb193-3" data-line-number="3">t =<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb193-4" data-line-number="4">solution =<span class="st"> </span><span class="kw">unlist</span>(solve.vec[t], <span class="dt">recursive=</span><span class="ot">TRUE</span>, <span class="dt">use.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb193-5" data-line-number="5">dat =<span class="st"> </span><span class="kw">data.frame</span>(xy[<span class="dv">1</span>],xy[<span class="dv">2</span>],<span class="dt">u=</span>solution)</a>
<a class="sourceLine" id="cb193-6" data-line-number="6"></a>
<a class="sourceLine" id="cb193-7" data-line-number="7"><span class="co">## 2d Random walk</span></a>
<a class="sourceLine" id="cb193-8" data-line-number="8"><span class="kw">set.seed</span>(<span class="dv">2021</span>)</a>
<a class="sourceLine" id="cb193-9" data-line-number="9">n =<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb193-10" data-line-number="10">rw =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> n)</a>
<a class="sourceLine" id="cb193-11" data-line-number="11"><span class="co"># generate the indices to set the direction (x-axis or y-axis)</span></a>
<a class="sourceLine" id="cb193-12" data-line-number="12"><span class="co"># then generate the walk (forward or backward)</span></a>
<a class="sourceLine" id="cb193-13" data-line-number="13">indx =<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">seq</span>(n), <span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), n, <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb193-14" data-line-number="14">rw[indx] =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), n, <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb193-15" data-line-number="15"></a>
<a class="sourceLine" id="cb193-16" data-line-number="16">rw[,<span class="dv">1</span>] =<span class="st"> </span><span class="kw">cumsum</span>(rw[, <span class="dv">1</span>])<span class="op">/</span>(<span class="dv">4</span><span class="op">*</span>pi<span class="op">^</span><span class="dv">2</span>) <span class="co"># phi(t)=\sqrt(2)*sin(j*pi*t), c(t)=1/(pi^2*j^2)  </span></a>
<a class="sourceLine" id="cb193-17" data-line-number="17">rw[, <span class="dv">2</span>] =<span class="st"> </span><span class="kw">cumsum</span>(rw[, <span class="dv">2</span>])<span class="op">/</span>(<span class="dv">4</span><span class="op">*</span>pi<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb193-18" data-line-number="18"></a>
<a class="sourceLine" id="cb193-19" data-line-number="19">dat.rw =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x1=</span>rw[<span class="dv">1</span><span class="op">:</span><span class="dv">5000</span>, <span class="dv">1</span>], <span class="dt">y1=</span>rw[<span class="dv">1</span><span class="op">:</span><span class="dv">5000</span>, <span class="dv">2</span>], <span class="dt">x2=</span>rw[<span class="dv">2</span><span class="op">:</span><span class="dv">5001</span>, <span class="dv">1</span>], <span class="dt">y2=</span>rw[<span class="dv">2</span><span class="op">:</span><span class="dv">5001</span>, <span class="dv">2</span>])</a>
<a class="sourceLine" id="cb193-20" data-line-number="20"></a>
<a class="sourceLine" id="cb193-21" data-line-number="21"><span class="kw">ggplot</span>(<span class="dt">data=</span>dat,<span class="kw">aes</span>(<span class="dt">x=</span>Var1,<span class="dt">y=</span>Var2))<span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">"x"</span>, <span class="dt">y=</span><span class="st">"y"</span>)<span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>()<span class="op">+</span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>u))<span class="op">+</span></a>
<a class="sourceLine" id="cb193-22" data-line-number="22"><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> y1, <span class="dt">xend =</span> x2, <span class="dt">yend =</span> y2, <span class="dt">colour =</span> <span class="st">"Brownian Motion"</span>), <span class="dt">data =</span> dat.rw)</a></code></pre></div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Now consider a <a href="ch-randomization.html#sub:RHilbert">Brownian motion</a> whose <a href="ch-randomization.html#sub:RHilbert">increments</a> are the <a href="ch-randomization.html#sub:RHilbert">Gaussian white noises</a> such that <span class="math display">\[B(t,\omega) - B(s,\omega) \sim \mathcal{N}(0,2(t-s)).\]</span>
Let the initial state be <span class="math inline">\(y\)</span>, and the terminal state be <span class="math inline">\(x\)</span>. The <a href="ch-UnMulti.html#sub:Markov">transition probability</a>
<span class="math display">\[\begin{align*}
\mathbb{P}\left(\left.B(t,\omega)=x\right|B(0,\omega)=y\right)=
\frac{1}{\sqrt{4\pi t}}\mbox{e}^{-\frac{(x-y)^{2}}{4t}}= K_1(t,x-y) 
\end{align*}\]</span>
becomes the 1D <strong>heat kernel</strong>. For any continuous second-order differentiable function <span class="math inline">\(f\)</span>, the convolution of <span class="math inline">\(f\)</span> with the <strong>heat kernel</strong> is <span class="math display">\[\left(K_{1}(t,\cdot)\star f \right)(x)=\frac{1}{(4\pi t)^{\frac{1}{2}}}\int_{\mathbb{R}}\mbox{e}^{-\frac{\|x-y\|^{2}}{4t}}f(y)\mbox{d}y,\]</span> which is the same as the expectation of <span class="math inline">\(f(\cdot)\)</span> where the random input of <span class="math inline">\(f(\cdot)\)</span> follows the distribution <span class="math inline">\(\mathcal{N}(0,2t)\)</span>.</p>
<p>Let the expectation of the function <span class="math inline">\(f\)</span> at time <span class="math inline">\(t\)</span> be <span class="math inline">\(u(\cdot,t)\)</span>. The expected function <span class="math inline">\(u(\cdot,t)\)</span> has a <strong>mean value property</strong> with respect to the <strong>heat kernel</strong> <span class="math inline">\(K_1(t,\cdot)\)</span>. Let <span class="math inline">\(u(y,0)=u_0(y)\)</span> be the initial of this function evaluated at the determined state <span class="math inline">\(y\)</span>. The <strong>mean value property</strong> with respect to the <strong>heat kernel</strong> says
<span class="math display">\[\begin{align*} 
u(x,t)&amp;=\mathbb{E}\left[\left.u\left(B(t,\omega),t\right)\right|u(B(0,\omega),0)=u_{0}(y)\right]\\
&amp;=\int u(y,0)K_{1}(t,x-y)\mbox{d}y.
\end{align*}\]</span>
Because the <strong>heat kernel</strong> is the solution of the <a href="ch-harmonicAn.html#sub:heatEq">heat equation</a>, so is this expected value function <span class="math inline">\(u(x,t)\)</span>. The proof is given below.</p>
<div class="solution">
<p class="solution-begin">
Proof <span id="sol-start-137" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-137', 'sol-start-137')"></span>
</p>
<div id="sol-body-137" class="solution-body" style="display: none;">
<p>Since the transition probability serves the role as the transition <strong>kernel</strong>, we can introduce the shift operator <span class="math inline">\(\mathbf{L}^{-t}\)</span> such that <span class="math display">\[\lim_{t\rightarrow0}\frac{\mathbf{L}^{-t}u_0 -u_0 }{t}=\lim_{t\rightarrow0}\frac{u(\cdot,t)-u(\cdot,0)}{t}=\frac{\partial u }{\partial t}\]</span></p>
<p>On the other hand, we can derive that <span class="math display">\[\lim_{t\rightarrow0}\frac{\mathbf{L}^{-t}u-u}{t}= \frac{\partial^{2}u}{\partial x^{2}}.\]</span></p>
<p>Here is the derivation.</p>
<p>We know that
<span class="math display">\[\begin{align*}(\mathbf{L}^{-t}u_0)(x) &amp;=\int_{\mathbb{R}}K_{1}(t,x-y)u_0(y)\mbox{d}y \\
    &amp;=\int\frac{1}{\sqrt{4\pi t}}\mbox{e}^{-\frac{(x-y)^{2}}{4t}}u_0(y)\mbox{d}y \\
    &amp;=\int\frac{1}{\sqrt{2\pi}}\mbox{e}^{-\frac{z^{2}}{2}}u_0(x-\sqrt{2t}z)\mbox{d}z \end{align*}\]</span>
where the last equality comes from the change of variables <span class="math inline">\((x-y)/\sqrt{2t}=z\)</span> or <span class="math inline">\(x-z\sqrt{2t}=y\)</span>. Re-examinate the derivative
<span class="math display">\[\lim_{t\rightarrow0}\frac{\mathbf{L}^{-t}u_0(x)-u_0(x)}{t}
    =\lim_{t\rightarrow0}\int\frac{1}{\sqrt{2\pi}}\mbox{e}^{-\frac{z^{2}}{2}}\frac{u_0(x-\sqrt{2t}z)-u_0(x)}{t}\mbox{d}z\]</span>
Note that we can expand <span class="math inline">\(u_{0}(x-\sqrt{2t}z)\)</span> at <span class="math inline">\(u_0(x)\)</span> by the <a href="sub-calculus.html#sub:Taylor">Taylor series</a> <span class="math display">\[u_{0}(x-\sqrt{2t}z)\approx u_{0}(x)-\frac{\partial u_{0}}{\partial x}\sqrt{2t}z+\frac{\partial^{2}u_{0}}{\partial x^{2}}(-\sqrt{2t}z)^{2}.\]</span>
Thus <span class="math display">\[u_0(x-\sqrt{2t}z)-u_0(x) \approx -\frac{\partial u_{0}}{\partial x}\sqrt{2t}z+\frac{\partial^{2}u_{0}}{\partial x^{2}}(-\sqrt{2t}z)^{2}.\]</span> Note that <span class="math inline">\(\int \frac{1}{\sqrt{2\pi}}e^{-\frac{z^{2}}{2}} z = 0\)</span> and <span class="math inline">\(\int \frac{1}{\sqrt{2\pi}}e^{-\frac{z^{2}}{2}} z^2 = 1\)</span> by the property of normal distribution density. Thus
<span class="math display">\[\begin{align*}\lim_{t\rightarrow0}\int\frac{1}{\sqrt{2\pi}}\mbox{e}^{-\frac{z^{2}}{2}}\frac{u_0(x-\sqrt{2t}z)-u_0(x)}{t}\mbox{d}z \\= \lim_{t\rightarrow0} \frac{\partial^{2}u_{0}}{\partial x^{2}} \int \frac{1}{\sqrt{2\pi}}\mbox{e}^{-\frac{z^{2}}{2}}\frac{2z^{2}t}{2t}\mbox{d}z=\frac{\partial^{2}u_{0}}{\partial x^{2}}.\end{align*}\]</span></p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<div class="solution">
<p class="solution-begin">
Probalistic interpretation of the Poisson kernel <span id="sol-start-138" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-138', 'sol-start-138')"></span>
</p>
<div id="sol-body-138" class="solution-body" style="display: none;">
<p>Let a particle move inside a unit circle following the law of Brownian motion. Define the time <span class="math inline">\(\tau\)</span> to be the first time that the particle hits the boundary of the circle <span class="math inline">\(\mathcal{U}\)</span>, namely <span class="math display">\[\tau(\omega) = \inf \{t : \mathbf{B}(t,\omega) \in \mathcal{U} \}\]</span>. If we want the particle to stop at the circle, we can use a harmonic function <span class="math inline">\(u\)</span> such that <span class="math inline">\(\Delta u(\mathbf{x}) =0\)</span> for <span class="math inline">\(\mathbf{x}\in \mathcal{U}\)</span>.<label for="tufte-sn-610" class="margin-toggle sidenote-number">610</label><input type="checkbox" id="tufte-sn-610" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">610</span> The reason is that Brownian motion can be described by the heat equation. So the equilibrium condition of the heat equation, namely <span class="math inline">\(\Delta u(\mathbf{x}) =0\)</span>, tells the Brownian motion to stop.</span> In this case, for every initial location <span class="math inline">\(\mathbf{y}\)</span> inside the unit circle, we have <span class="math display">\[\begin{align*}u(\mathbf{y})&amp;=\mathbb{E}\left[\left.u\left(\mathbf{B}(\tau,\omega)\right)\right|u(\mathbf{B}(0,\omega))=\mathbf{y} \right]\\
&amp;= \int u(\mathbf{x})\Pr\left(\left.\mbox{d}\mathbf{x} \in \mathbf{B}(\tau,\omega)\right|\mathbf{B}(0,\omega)=\mathbf{y}\right) \end{align*}\]</span> The probability <span class="math inline">\(\Pr\left(\mbox{d}\mathbf{x}\in\left.\mathbf{B}(\tau,\omega)\right|\mathbf{B}(0,\omega)=\mathbf{y}\right)\)</span> is called the hitting probability or exit distribution if the <a href="ch-CalUn.html#sub:conProb">Radon-Nikodym derivative</a> exists. The distribution is in fact the <strong>Poisson kernel</strong>, and it is harmonic.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
</div>
<div id="sub:income" class="section level2">
<h2>
<span class="header-section-number">18.3</span> * Infinite Divisibility: equality and inequality</h2>
<p>For an aggregated variable <span class="math inline">\(x\)</span> such as GDP in economics, one can model its stochastic growth using some stochastic process <span class="math inline">\(X_t(\omega)\)</span>, given that the aggregated process consists of <span class="math inline">\(n\)</span> individual components <span class="math display">\[X(t, \omega)=\varepsilon_1(t, \omega)+\cdots + \varepsilon_n(t, \omega).\]</span> Let the probability law <span class="math inline">\(\mathbb{P}_{X_t}\)</span> represent the distribution of <span class="math inline">\(X(t,\omega)\)</span>, and the law <span class="math inline">\(\mathbb{P}_{\varepsilon_i}\)</span> represent the distribution of
individual contribution that makes up for the overall growth <span class="math inline">\(X(t,\omega)\)</span>. In economics, the individual contribution of the GDP growth is (theoretically) relating to the measure of the (desired) individual income. Thus, in principle, the distribution of the GDP growth process <span class="math inline">\(X(t,\omega)\)</span> also relates to the income distribution at time <span class="math inline">\(t\)</span>.</p>
<p>We will restrict our attention to the aggregated processes within some specific processes whose distributions are <a href="ch-CalUn.html#sub:divRV">infinitely divisible</a> because the infinite divisibility assumes that the individual components <span class="math inline">\(\varepsilon(\omega)\)</span> are identically distributed. This assumption coincides with the political morality requiring the <em>equality of opportunity</em>. The poor and the rich tend to have the same chances to change their current status to any possible future state.<label for="tufte-sn-611" class="margin-toggle sidenote-number">611</label><input type="checkbox" id="tufte-sn-611" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">611</span> Another reason is that very often, the number of the component <span class="math inline">\(n\)</span> relates to the time <span class="math inline">\(t\)</span>, e.g., the population increasing along the time. Suppose the process is in the infinite divisible family, at the equilibrium. In that case, we can ignore the growth effect caused by the time tt and only focus on the compositions of n individual components. Suppose the process is in the <a href="ch-CalUn.html#sub:divRV">infinite divisible family</a>, at the equilibrium. In that case, we can ignore the growth effect caused by the time tt and only focus on the compositions of <span class="math inline">\(n\)</span> individual components. However, it is worth emphasizing that assuming an object that is composed of infinitely many distinct smaller elements may conflict with some modeling ideology. For example, in mathematics, the Society of Jesus had long viewed this modeling method with suspicion. Since according to the Christian doctrine, no one part of Christ’s substance can be divided; otherwise, all the elements of the Eucharist (leavened or unleavened bread and sacramental wine) cannot accompany the presence of Christ in the rite.</span></p>
<p>Before the introduction of the desired process, called the <strong>Lévy process</strong>, we detour around the <a href="ch-harmonicAn.html#sub:heatEq">group structure</a> on the complex field where we can see how to represent the probability law and the <a href="ch-CalUn.html#sub:divRV">infinite divisible</a> structure dually. Then we will investigate the <strong>Lévy process</strong> and see its application on growth and income distribution.</p>
<p><span class="newthought">Convoluted semigroup </span></p>
<p>The probabilistic structure of the <a href="ch-CalUn.html#sub:divRV">infinite divisibility</a> is, in fact, attributed to the <strong>convoluted semi-group</strong>. Let’s consider a <a href="ch-UnMulti.html#sub:rw">random walk</a> <span class="math inline">\(X_t(\omega)\)</span>. It is known that <span class="math inline">\(X_t(\omega)\)</span> is the sum of the sequence of random <a href="ch-randomization.html#sub:RHilbert">noises</a> <span class="math inline">\((\varepsilon_{1},\dots,\varepsilon_{t})\)</span>, so the probability law of the random walk is the convolution of the probability laws of the sequence.<label for="tufte-sn-612" class="margin-toggle sidenote-number">612</label><input type="checkbox" id="tufte-sn-612" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">612</span> 
Recall that for two random variables <span class="math display">\[\varepsilon_{1}(\omega)\sim\mathbb{P}_{\varepsilon_{1}},\: \varepsilon_{2}(\omega)\sim\mathbb{P}_{\varepsilon_{2}},\]</span>
the sum of these two random variables follows the probability law <span class="math inline">\(\mathbb{P}_{\varepsilon_1}\star\mathbb{\mathbb{P}}_{\varepsilon_{2}}\)</span>.</span> On the other hand, the sum of random variables has the probability law, the joint probability of its components. So we have<label for="tufte-sn-613" class="margin-toggle sidenote-number">613</label><input type="checkbox" id="tufte-sn-613" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">613</span> Recall that <a href="ch-randomization.html#sub:RHilbert">white noises</a> are not only independent but also identical. The noises follow the same law <span class="math inline">\(\mathbb{P}_{\varepsilon}\)</span>.</span>
<span class="math display">\[\begin{align*}\varepsilon_{1}(\omega)+\cdots+\varepsilon_{t}(\omega) &amp;\sim \mathbb{P}_{\varepsilon_{1}}\star\cdots\star\mathbb{\mathbb{P}}_{\varepsilon_{t}},\\
X_{t}(\omega) &amp; \sim \mathbb{P}_{X_{t}}, \\  \mathbb{P}_{X_t}=\mathbb{P}_{\varepsilon_{1}\cdots\varepsilon_{t}}=&amp;\mathbb{P}_{\varepsilon_{1}}\star\cdots\star\mathbb{\mathbb{P}}_{\varepsilon_{t}}=\mathbb{P}_{\varepsilon}^{\star (t)}.\end{align*}\]</span></p>
<p>Here, <span class="math inline">\(\mathbb{P}_{\varepsilon}^{\star (t)}\)</span> denotes a <span class="math inline">\(t\)</span>-fold of convolutions.</p>
<div class="solution">
<p class="solution-begin">
Proof <span id="sol-start-139" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-139', 'sol-start-139')"></span>
</p>
<div id="sol-body-139" class="solution-body" style="display: none;">
<p>Let’s just take two random variables as an example. For <span class="math inline">\(\varepsilon_1(\omega)\)</span> and <span class="math inline">\(\varepsilon_2(\omega)\)</span>, the sum <span class="math inline">\(X_2(\omega)=\varepsilon_1(\omega)+\varepsilon_2(\omega)\)</span> follows the probability</p>
<p><span class="math display">\[\mathbb{P}_{X_2}(x)=\int\mathbb{P}_{\varepsilon_{1}\varepsilon_{2}}(\mbox{d}e,x-\mbox{d}e).\]</span>
Because <span class="math inline">\(\varepsilon_{1}(\omega)\)</span> and <span class="math inline">\(\varepsilon_{2}(\omega)\)</span> are <a href="ch-CalUn.html#sub:divRV">independent</a>, the <a href="ch-CalUn.html#sub:conProb">joint probability</a> <span class="math inline">\(\mathbb{P}_{\mu_{1}\mu_{2}}\)</span>
is the product of two individual probability <span class="math inline">\(\mathbb{P}_{\varepsilon_{1}}\mathbb{P}_{\varepsilon_{2}}\)</span>. Then the above integral becomes <span class="math display">\[\mathbb{P}_{X_2}(x)=\int\mathbb{P}_{\varepsilon_{1}}(\mbox{d}e)\mathbb{P}_{\varepsilon_{2}}(x-\mbox{d}e)=\mathbb{P}_{\varepsilon_{1}}\star\mathbb{\mathbb{P}}_{\varepsilon_{2}}(x).\]</span></p>
<p>The same argument can be applied for attaining the probability law of <span class="math inline">\(X_t(\omega)\)</span>.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Suppose that the <a href="ch-randomization.html#sub:RHilbert">white noises</a> are Gaussian, <span class="math inline">\(\varepsilon_i \sim \mathcal{N}(0,1)\)</span>, then we have the variance of <span class="math inline">\(X_t(\omega)\)</span> as the <a href="ch-harmonicAn.html#sub:heatEq">group parameter</a>
<span class="math display">\[X_t = \varepsilon_1 + \cdots + \varepsilon_{t}  \sim \mathcal{N}(0,t)=\mathbb{P}_{\varepsilon}^{\star (t)}.\]</span>
The Gaussian family of probabilities together with the convolution operation <span class="math inline">\((\star)\)</span> establishes the probability law <span class="math inline">\(\mathbb{P}_{\varepsilon}\)</span> as a <em>convolution semigroup</em>.<label for="tufte-sn-614" class="margin-toggle sidenote-number">614</label><input type="checkbox" id="tufte-sn-614" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">614</span> Recall that property of normal distributions: <span class="math display">\[\begin{align*}\mathbb{P}_{\varepsilon}^{\star (t)}\mathbb{P}_{\varepsilon}^{\star (s)}&amp;=\mathcal{N}(0,s+t) \\ &amp;=\mathcal{N}(0,s)\star \mathcal{N}(0,t)\end{align*}\]</span> for any <span class="math inline">\(s,t&gt;0\)</span>. This convolution product is associative for any <span class="math inline">\(s,t&gt;0\)</span>. The identity element of the group is the <a href="ch-randomization.html#sub:RHilbert">delta function</a>. The inverse does not necessarily exist, so it is only a <a href="ch-randomization.html#sub:global">semigroup</a>.</span></p>
<p>The random walk is a particular case of <a href="ch-UnMulti.html#sub:Markov">time-homogeneous Markov chains</a>. The <a href="ch-randomization.html#sub:global">semigroup</a> structure of random walks is endowed by the properties of the additive stochastic <a href="ch-randomization.html#sub:RHilbert">increment</a> and the <a href="ch-UnMulti.html#sub:Markov">Markov condition</a>. See the discussion below.</p>
<div class="solution">
<p class="solution-begin">
Chapman-Kolmogorov equation and semigroup <span id="sol-start-140" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-140', 'sol-start-140')"></span>
</p>
<div id="sol-body-140" class="solution-body" style="display: none;">
<p>The <a href="ch-UnMulti.html#sub:Markov">Chapman-Kolmogorov equation</a> of the time-homogeneous Markov chain follows
<span class="math display">\[\begin{align*}\mathbb{P}(X_{t+2}\in\mathcal{A}|X_{t})&amp;=\int\mathbb{P}(X_{t+2}\in\mathcal{A}|X_{t+1}=x)\mathbb{P}(X_{t+1}\in\mbox{d}x|X_{t})\\
&amp;=\int\mathbb{P}(X_{t+2}\in\mathcal{A}|X_{t}+\varepsilon_{t+1}=x)\mathbb{P}(X_{t}+\varepsilon_{t+1}\in\mbox{d}x|X_{t})\\
&amp;=\int\mathbb{P}(X_{t+2}\in\mathcal{A}|\varepsilon_{t+1}=x-X_{t})\mathbb{P}(\varepsilon_{t+1}\in\mbox{d}x|X_{t}),\end{align*}\]</span>
which is the <strong>convolution semigroup</strong>.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><span class="newthought">Characteristic functions </span></p>
<p>The great virtue of the Fourier transform is that it behaves well under convolution and some other operations such as translation and differentiation.
By the <a href="ch-harmonicAn.html#sub:convolution">convolution theorem</a>, we know that the <a href="ch-harmonicAn.html#sub:convolution">character</a> or the <a href="ch-representation.html#sub:conjugacy">Fourier transform</a> takes convolutions into ordinary multiplications.<label for="tufte-sn-615" class="margin-toggle sidenote-number">615</label><input type="checkbox" id="tufte-sn-615" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">615</span> A <a href="ch-randomization.html#sub:RHilbert">delta function</a> is not a probability distribution, but it plays as a distribution in the general sense. The Fourier transform of the <a href="ch-randomization.html#sub:RHilbert">delta function</a> is <span class="math display">\[\begin{align*}\hat{\delta}(x-x_{0}) &amp;=\int_{-\infty}^{\infty}\delta(x-x_{0})\mbox{e}^{\mbox{i}\lambda x}\mbox{d}x
\\&amp;=\mbox{e}^{-\mbox{i}\theta x_{0}}.\end{align*}\]</span>
In particular, <span class="math inline">\(x_{0}=0\)</span> gives <span class="math inline">\(\hat{\delta}(x)=1\)</span> regardless of the value of <span class="math inline">\(\theta\)</span>.</span></p>
<p>The <em>characteristic function</em> that maps the random variable <span class="math inline">\(X(\omega)\)</span> onto the <a href="ch-harmonicAn.html#sub:convolution">complex unit circle</a> is the Fourier transform of <span class="math inline">\(X(\omega)\)</span> and is defined by<label for="tufte-sn-616" class="margin-toggle sidenote-number">616</label><input type="checkbox" id="tufte-sn-616" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">616</span> Note that we assume that the probability law of <span class="math inline">\(X(\omega)\)</span>, <span class="math inline">\(\mathbb{P}_{X}\)</span>, is a bounded and continuous function. Thus, by definition, <span class="math inline">\(\mathbb{P}_{X}\)</span> is integrable to one, and <span class="math inline">\(\mathbb{P}_{X}\in \mathcal{C}_{b}(\mathbb{R})\cap L^{1}(\mathbb{R})\)</span>.</span> <span class="math display">\[\xi_X(\theta)=\mathbb{E}\left[\mbox{e}^{\mbox{i}\theta X(\omega)}\right]=\mathbf{F}_\theta(\mathbb{P}_X).\]</span>
The <strong>characteristic function</strong> <span class="math inline">\(\xi_{X}(\mathbf{\theta})\)</span> uniquely determines <span class="math inline">\(\mathbb{P}\)</span> in the sense that if <span class="math inline">\(\bar{\mathbb{P}}\)</span> is a second probability measure whose Fourier transform is <span class="math inline">\(\xi_{X}(\theta)\)</span>, then <span class="math inline">\(\bar{\mathbb{P}}=\mathbb{P}\)</span>. This property motivates us to study the <strong>convoluted semigroup structures</strong> and the <a href="ch-CalUn.html#sub:divRV">infinite divisible family</a> through their characters.</p>
<p><a href="ch-CalUn.html#sub:divRV">Poisson distributions</a> and <a href="ch-CalUn.html#sub:divRV">normal distributions</a> form two important one-dimensional <strong>characteristic functions</strong>.<label for="tufte-sn-617" class="margin-toggle sidenote-number">617</label><input type="checkbox" id="tufte-sn-617" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">617</span> When <span class="math inline">\(X(\omega)\sim\mathcal{N}(0,1)\)</span>, we have <span class="math inline">\(\xi_X(\theta)=\mbox{e}^{-\frac{\theta^{2}}{2}}\)</span>.</span>
<span class="math display">\[\begin{align*}
X(\omega)\sim\mbox{Poi}(\lambda) : \, &amp; \,\, \xi_X(\theta)=\exp\left({\lambda(\mbox{e}^{\mbox{i}\theta}-1)}\right),\\
X(\omega)\sim\mathcal{N}(\mu,\sigma^2) : \, &amp; \,\,
\xi_X(\theta)=\mbox{e}^{\mbox{i}\theta\mu-\frac{\sigma^{2}\theta^{2}}{2}}.  
\end{align*}
\]</span></p>
<div class="solution">
<p class="solution-begin">
Derivation <span id="sol-start-141" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-141', 'sol-start-141')"></span>
</p>
<div id="sol-body-141" class="solution-body" style="display: none;">
<ol style="list-style-type: decimal">
<li>Poisson distribution <span class="math inline">\(X(\omega)\sim\mbox{Poi}(\lambda)\)</span>:</li>
</ol>
<p>Let <span class="math inline">\(\Pr(X(\omega)=k)=\frac{\lambda^{k}}{k!}\mbox{e}^{-\lambda}\)</span>. The characteristic function is
<span class="math display">\[\begin{align*}
\mathbb{E}\left[\mbox{e}^{\mbox{i}\theta X(\omega)}\right] &amp;=\sum_{k=0}^{\infty}\mbox{e}^{-\lambda}\left(\frac{\lambda^{k}}{k!}\right)\mbox{e}^{\mbox{i}\theta k}=\mbox{e}^{-\lambda}\sum_{k=0}^{\infty}\left(\frac{\lambda^{k}\mbox{e}^{\mbox{i}\theta k}}{k!}\right)\\
&amp;=\mbox{e}^{-\lambda}\mbox{e}^{\lambda\mbox{e}^{\mbox{i}\theta}}=\mbox{e}^{\lambda(\mbox{e}^{\mbox{i}\theta}-1)},
\end{align*}\]</span>
where <span class="math inline">\(\mbox{e}^{\lambda\mbox{e}^{\mbox{i}\theta}}=\sum_{k=0}^{\infty}\frac{1}{k!}\left(\lambda\mbox{e}^{\mbox{i}\theta}\right)^{k}\)</span>.<label for="tufte-sn-618" class="margin-toggle sidenote-number">618</label><input type="checkbox" id="tufte-sn-618" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">618</span> Recall that <span class="math inline">\(\sum_{k=0}^{\infty}\frac{1}{k!}x^{k}=\mbox{e}^{x}\)</span>.</span></p>
<ol start="2" style="list-style-type: decimal">
<li>Normal distribution <span class="math inline">\(X(\omega)\sim\mathcal{N}(0,1)\)</span>:
<span class="math display">\[\begin{align*}
\mathbb{E}\left[\mbox{e}^{\mbox{i}\theta X(\omega)}\right]  &amp;=
\int_{-\infty}^{\infty} \mbox{e}^{\mbox{i}\theta x} \frac{1}{\sqrt{2\pi}}\mbox{e}^{-\frac{x^{2}}{2}}\mbox{d}x \\
&amp;=\int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}\mbox{e}^{\mbox{i}\theta x-\frac{x^{2}}{2}}\mbox{d}x \\ &amp;=\mbox{e}^{-\frac{\theta^{2}}{2}}\int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}\mbox{e}^{-\frac{(x-\mbox{i}\theta)^{2}}{2}}\mbox{d}x=e^{-\frac{\theta^{2}}{2}}.
\end{align*}\]</span>
where the last equality uses the condition <span class="math display">\[\begin{align*}\int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}\mbox{e}^{-\frac{(x-\mbox{i}\theta)^{2}}{2}}\mbox{d}x &amp;=\int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}\mbox{e}^{-\frac{(x-\mbox{i}\theta)^{2}}{2}}\mbox{d}(x-\mbox{i}\theta) \\&amp;= \int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}\mbox{e}^{-\frac{y^{2}}{2}}\mbox{d}y= 1.\end{align*}\]</span>
</li>
</ol>
<p>In general, if <span class="math inline">\(X(\omega)\)</span> is a normal random variable with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^{2}\)</span>, then <span class="math inline">\(Z(\omega)=(X(\omega)-\mu)/\sigma\)</span>
is a standard normal random variable. For <span class="math inline">\(\xi_{Z}(\theta)=e^{-\frac{\theta^{2}}{2}}\)</span>, we can derive <span class="math display">\[\mathbb{E}\left[\mbox{e}^{\mbox{i}\theta X(\omega)}\right]=\mbox{e}^{\mbox{i}\theta\mu}\mbox{e}^{-\frac{\sigma^{2}\theta^{2}}{2}}.\]</span></p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><span class="newthought">Multivariate characteristic function </span></p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:2Dtorus"></span>
<img src="fig/Part5/2Dtorus.gif" alt="2-dimensional torus" width="100%"><!--
<p class="caption marginnote">-->Figure 18.6: 2-dimensional torus<!--</p>-->
<!--</div>--></span>
</p>
<p>Similar results hold in the multivariate cases. For a <span class="math inline">\(d\)</span>-dimensional Gaussian random vector, its characteristic function is a product of <span class="math inline">\(d\)</span> one-dimensional characteristic functions. To see this construction, we first extend the <a href="ch-harmonicAn.html#sub:convolution">complex unit circle</a> <span class="math inline">\(\mbox{e}^{\mbox{i}\theta}\)</span> to the <span class="math inline">\(d\)</span>-dimensional <em>torus</em> :
<span class="math display">\[\left[\begin{array}{cccc}
\mbox{e}^{\mbox{i}\theta_{1}} &amp; 0 &amp; \cdots &amp; 0\\
0 &amp; \ddots\\
\vdots &amp;  &amp; \ddots\\
0 &amp; \cdots &amp; 0 &amp; \mbox{e}^{\mbox{i}\theta_{n}}
\end{array}\right]=\mbox{diag}(\mbox{e}^{\mbox{i}\theta_{1}},\dots,\mbox{e}^{\mbox{i}\theta_{n}}).\]</span>
Each 1-dimensional <strong>torus</strong> <span class="math inline">\(\mbox{e}^{\mbox{i}\theta_{i}}\)</span> is independent of the others.</p>
<p>For an <a href="ch-randomization.html#sub:RHilbert"><span class="math inline">\(\mathcal{H}\)</span>-valued random variable</a> <span class="math inline">\(\mathbf{X}(\omega)\)</span> whose realization is in the Hilbert space <span class="math inline">\(\mathcal{H}\)</span> and whose probability law is <span class="math inline">\(\mathbb{P}\)</span>, the <a href="ch-representation.html#sub:conjugacy">Fourier transform</a> of <span class="math inline">\(\mathbf{X}(\omega)\)</span> is a map <span class="math inline">\(\xi_{\mathbf{X}}:\mathcal{H}^{*}\rightarrow \mathbb{C}\)</span> such that<label for="tufte-sn-619" class="margin-toggle sidenote-number">619</label><input type="checkbox" id="tufte-sn-619" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">619</span> This definition is valid when <span class="math inline">\(\mathcal{H}\)</span> is either a finite-dimensional vector space, i.e., <span class="math inline">\(\mathcal{H}=\mathbb{R}^{n}\)</span>, or an infinite-dimensional Hilbert space.</span> <span class="math display">\[\xi_{\mathbf{X}}(\mathbf{\theta}) = \int\mbox{e}^{\mbox{i}\langle \mathbf{x} , \mathbf{\theta} \rangle } \mathbb{P} (\mbox{d}\mathbf{x}),\]</span>
for <span class="math inline">\(\mathbf{x}\in\mathcal{H}\)</span> and <span class="math inline">\(\mathbf{\theta} \in \mathcal{H}^{*}\)</span>.
Here, the real-valued <a href="ch-vecMat.html#sub:vec">inner product</a> is defined for the <a href="ch-representation.html#sub:conjugacy">Hilbert space</a> <span class="math inline">\(\mathcal{H}\)</span> and its dual space <span class="math inline">\(\mathcal{H}^{*}\)</span>:
<span class="math display">\[\langle \cdot, \cdot^* \rangle \in \mathcal{H}\times \mathcal{H}^{*} \rightarrow \mathbb{R}.\]</span></p>
<p>The <strong>characteristic function</strong> of the <span class="math inline">\(d\)</span>-dimensional <a href="ch-UnMulti.html#sub:MultiVar">multivariate normal distributions</a> is<label for="tufte-sn-620" class="margin-toggle sidenote-number">620</label><input type="checkbox" id="tufte-sn-620" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">620</span> For the standard case <span class="math display">\[\mathbf{X}(\omega)\sim \mathcal{N}(\mathbf{0},\mathbf{I}),\]</span> the characteristic function is <span class="math inline">\(\mbox{e}^{-\frac{\|\mathbf{\theta}\|^{2}}{2}}\)</span> for <span class="math inline">\(\mathbf{\theta}\in\mathbb{R}^{d}\)</span>.</span> <span class="math display">\[\begin{align*}
\xi_\mathbf{X}(\theta)=\mbox{e}^{\mbox{i}\langle\mathbf{\theta},\mathbf{\mu}\rangle-\frac{1}{2}\langle\mathbf{\theta},\mathbf{\Sigma}\mathbf{\theta}\rangle},  
\end{align*}\]</span>
when <span class="math inline">\(\mathbf{X}(\omega)\sim\mathcal{N}(\mathbf{\mu},\mathbf{\Sigma})\)</span>.</p>
<p>As the Poisson distribution is about the counts of natural numbers, it would not be so easy to extend to higher dimensions. The <em>multivariate Poisson distribution</em>, or called the <em>Poisson measure</em>, is about the total counts (of jumps) happening for some multivariate distribution <span class="math inline">\(\mathbf{\nu}\)</span>. We denote this <strong>Poisson measure</strong> by <span class="math inline">\(\mathbf{X}(\omega)\sim \mbox{Poi}(\mathbf{\nu}, \lambda)\)</span>.<label for="tufte-sn-621" class="margin-toggle sidenote-number">621</label><input type="checkbox" id="tufte-sn-621" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">621</span> The distribution is defined as follows. For any positive counting number <span class="math inline">\(N\)</span>,
<span class="math display">\[\Pr(\mathbf{X}(\omega)\leq N) = \mbox{e}^{-\lambda} \sum_{k=0}^{N} \frac{\lambda^k}{k!}\nu^{(\star k)}\]</span> where <span class="math inline">\(\nu\)</span> is an underlying distribution for jumps on <span class="math inline">\(\mathbb{R}^{d}\)</span> and <span class="math inline">\(\lambda\)</span> is the jumping rate as in the one-dimensional case. The definition gives a sum of <span class="math inline">\(k\)</span>-fold convoluted <span class="math inline">\(d\)</span>-dimensional jump distributions and assumes that the total number of jumps follows the Poisson distribution.</span> The <strong>characiteristic function</strong> of <span class="math inline">\(\mathbf{X}(\omega)\sim \mbox{Poi}(\mathbf{\nu}, \lambda)\)</span> is
<span class="math display">\[\begin{align*}
\xi_\mathbf{X}(\theta)=\exp\left({\lambda \int (\mbox{e}^{\mbox{i}\langle\mathbf{\theta},\mathbf{\mathbf{x}}\rangle}-1)}\mathbf{\nu}(\mbox{d}\mathbf{x})\right).  
\end{align*}\]</span></p>
<p>The unspecified role of <span class="math inline">\(\nu\)</span> in the <strong>Poisson measures</strong> offers much flexibility to characterize the <a href="ch-CalUn.html#sub:divRV">infinite divisibility</a>. In fact, every infinitely divisible distribution can be thought of as a kind of the limit of the <strong>Poisson measures</strong>.<label for="tufte-sn-622" class="margin-toggle sidenote-number">622</label><input type="checkbox" id="tufte-sn-622" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">622</span> Note that both multivariate distributions are <a href="ch-CalUn.html#sub:divRV">infinitely divisible</a>:
<span class="math display">\[\begin{align*}\mathcal{N}(\mathbf{\mu},\mathbf{\Sigma})^{(\star n)}&amp;=\mathcal{N}(n\mathbf{\mu},n^2\mathbf{\Sigma}), \\
\mbox{Poi}(\mathbf{\nu}, \lambda)^{(\star n)}&amp;=\mbox{Poi}(\mathbf{\nu}, n \lambda)\end{align*}\]</span>
for any <span class="math inline">\(n\in\mathbb{N}\)</span>.</span></p>
<div class="solution">
<p class="solution-begin">
Gaussian terms and jumps <span id="sol-start-142" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-142', 'sol-start-142')"></span>
</p>
<div id="sol-body-142" class="solution-body" style="display: none;">
<p>Every multivariate normal distribution can be approximates by discrete jumps.</p>
<p>For example, if we let the underlying jump distribution <span class="math inline">\(\nu\)</span> be a sum of <a href="ch-randomization.html#sub:RHilbert">delta functions</a>
<span class="math display">\[\nu(\mathbf{x})=\frac{1}{2n}\sum_{i=1}^{n}\delta\left(\mathbf{x}-\frac{\mu_{i}\mathbf{e}_{i}}{N}\right)\]</span>
where <span class="math inline">\(N\)</span> is the number of observations and <span class="math inline">\(\mathbf{e}_{i}\)</span> is the unit vector, then the characteristic function is<span class="math display">\[\begin{align*}\lim_{N\rightarrow\infty}&amp;\exp\left(\sum_{i=1}^{n}N\left(\mbox{e}^{\frac{\mbox{i}\langle\mu_{i}\mathbf{e}_{i},\mathbf{\theta}\rangle}{N}}-1\right)\right)\\
&amp;=\mbox{e}^{\mbox{i}\langle\mathbf{\mu},\mathbf{\theta}\rangle}\end{align*}\]</span>
which is the mean term of the characteristic function of the multivariate normal distribution.</p>
<p>Similarly, the covariance term can be construct by some other delta functions.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p><span class="newthought">Lévy process and martingale</span></p>
<p>By combining the <strong>characteristic functions</strong> of (multivariate) normal and Poisson distributions, we can reach a special form of the <strong>characteristic function</strong> for any infinitely divisible random variable <span class="math inline">\(\mathbf{m}(\omega)\)</span>, call the <em>independent and time-homogeneous increment of a Lévy process</em><label for="tufte-sn-623" class="margin-toggle sidenote-number">623</label><input type="checkbox" id="tufte-sn-623" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">623</span> There are many ways to represent this characteristic function by modifying the definition of the measure <span class="math inline">\(\mathbf{\nu}\)</span>. The <strong>Lévy process</strong> is uniquely determined by the triplet <span class="math inline">\((\mathbf{\mu},\mathbf{\Sigma},\mathbf{\nu})\)</span>. The triplet suggest that each <strong>Lévy process</strong> can be seen as having three independent components: a linear mean drift, a Gaussian noise, and jumps.</span>
<span class="math display">\[\begin{align*}&amp; \xi_{\mathbf{m}}(\theta)= \mbox{e}^{\widehat{\mathbf{A}_{L}}} \\
&amp;=\exp\left\{\mbox{i}\langle\mathbf{\theta},\mathbf{\mu}\rangle-\frac{1}{2}\langle\mathbf{\theta},\mathbf{\Sigma}\mathbf{\theta}\rangle + {\int (\mbox{e}^{\mbox{i}\langle\mathbf{\theta},\mathbf{\mathbf{m}}\rangle}-1)}\mathbf{\nu}_{\lambda}(\mbox{d}\mathbf{m}) \right\}\end{align*}\]</span> where <span class="math inline">\(\mathbf{\nu}_{\lambda}=\lambda \mathbf{\nu}\)</span> for the Poisson jumping rate <span class="math inline">\(\lambda\)</span> and the multivariate distribution <span class="math inline">\(\nu\)</span>. The meaning of the <a href="ch-optApp.html#sub:appSys">hat</a> notation <span class="math inline">\(\widehat{\mathbf{A}_{L}}\)</span> will be explained later.</p>
<p>The (multivariate) <em>Lévy process</em> <span class="math inline">\(\mathbf{Z}(t,\omega)\)</span> is defined by the <strong>characteristic function</strong> <span class="math display">\[\xi_{\mathbf{Z}_t}=(\xi_{\mathbf{m}})^{t}=\mbox{e}^{t \widehat{\mathbf{A}_{L}}}.\]</span>
Thus, for example, the random walk <span class="math inline">\(X_{t}=\sum_{i=1}^{t}\varepsilon_i\)</span> is a discrete one dimensional <strong>Lévy process</strong>.<label for="tufte-sn-624" class="margin-toggle sidenote-number">624</label><input type="checkbox" id="tufte-sn-624" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">624</span> Its <strong>characteristic function</strong> is
<span class="math display">\[\begin{align*}\mathbf{F}_\theta(\mathbb{P}_{X_{t}})&amp;= \mathbb{E}[\mbox{e}^{\mbox{i}\theta X_{t}}] \\
&amp;= \mathbb{E}[\mbox{e}^{\mbox{i}\theta \varepsilon_1+\cdots \varepsilon_{t}}]\\
&amp;= \mathbf{F}_\theta(\mathbb{P}_{\varepsilon}\star \cdots \star \mathbb{P}_{\varepsilon})\\
&amp;= [\mathbf{F}_\theta(\mathbb{P}_{\varepsilon})]^t = \mathbf{e}^{\frac{t\theta}{2}}.\end{align*}\]</span></span></p>
<p>Now we have seen that the characteristic function of a stochastic process dually represents the process. On the other hand, we knew that on the complex unit circle (or <strong>torus</strong>), the <a href="ch-harmonicAn.html#sub:heatEq">harmonic operator</a> and the <a href="ch-harmonicAn.html#sub:convolution">mean value property</a> could also specify the representation. It would be interesting to see how these two perspectives consolidate for the stochastic processes.</p>
<p>A <strong>martingale</strong> is a stochastic process in which, conditionally on its history, every future value is expected to remain at its current level of the process.
Consider a continuous-time <span class="math inline">\(d\)</span>-dimensional <a href="ch-randomization.html#sub:RHilbert">Brownian motion</a> <span class="math inline">\(\mathbf{B}_{t}(\omega)\)</span> associated to the <a href="ch-UnMulti.html#sub:Markov">filtered space</a> <span class="math inline">\((\Omega,\{\mathcal{F}_{t}\}_{t\in\mathbb{R}^{+}},\mathbb{P})\)</span>. Let <span class="math inline">\(f:\mathbb{R}^{d}\rightarrow\mathbb{R}\)</span> be continuous, bounded, differentiable up to the second-order, and all the derivatives are bounded.
Suppose <span class="math inline">\(f\)</span> is a non-negative measurable harmonic function, then the harmonicity <span class="math inline">\(\Delta f=0\)</span> implies that <span class="math display">\[\mathbb{E}\left[\left.\int_{s}^{t}\Delta f(\mathbf{B}_{\tau})\mbox{d}\tau\right|\mathcal{F}_s\right]=0.\]</span>
This result can attain a stochastic type <a href="ch-harmonicAn.html#sub:convolution">mean value property</a> <span class="math display">\[\mathbb{E}\left[\left.f(\mathbf{B}_{t})\right|\mathcal{F}_s\right]=f(\mathbf{B}_{s}),\]</span> known as the <em><span class="math inline">\(\mathbb{P}\)</span>-harmonic</em> condition or <em>martingale condition</em>.<label for="tufte-sn-625" class="margin-toggle sidenote-number">625</label><input type="checkbox" id="tufte-sn-625" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">625</span> For the (harmonic) identity function <span class="math inline">\(f(X_{t})=X_{t}\)</span> and the random walk <span class="math inline">\(X_{t}(\omega)\)</span> associated to <span class="math inline">\((\Omega,\{\mathcal{F}_{t}\}_{t\in\mathbb{N}},\mathbb{P})\)</span>, we can see that the <strong>martingale condition</strong> holds
<span class="math display">\[\begin{align*}\mathbb{E}\left[X_{t+1}|\mathcal{F}_{t}\right]&amp;=\mathbb{E}\left[X_{t}+\varepsilon_{t}|\mathcal{F}_{t}\right]\\&amp;=\mathbb{E}\left[X_{t}|\mathcal{F}_{t}\right]+0=X_{t}.\end{align*}\]</span> </span> This <strong>martingale condition</strong> comes from the following representation<br><span class="math display">\[\mathbb{E}\left[f(\mathbf{B}_{t})|\mathcal{F}_s\right]=f(\mathbf{B}_{s})+\mathbb{E}\left[\left.\int_{s}^{t}\Delta f(\mathbf{B}_{\tau})\mbox{d}\tau \right|\mathcal{F}_s \right],\]</span> for any <span class="math inline">\(s\leq t\)</span>.</p>
<div class="solution">
<p class="solution-begin">
Proof <span id="sol-start-143" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-143', 'sol-start-143')"></span>
</p>
<div id="sol-body-143" class="solution-body" style="display: none;">
<p>Let <span class="math inline">\(f:\mathbb{R}^{d}\rightarrow\mathbb{R}\)</span> be continuous, bounded, differentiable up to the second order, and all the derivatives are bounded. There is<label for="tufte-sn-626" class="margin-toggle sidenote-number">626</label><input type="checkbox" id="tufte-sn-626" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">626</span> Here we assume that the expectation is taken under the conditional probability <span class="math display">\[\Pr(\mathbf{B}_{t}=\mathbf{y}|\mathbf{B}_{0}=\mathbf{x})=K_{d}(t,\mathbf{y}-\mathbf{x})\]</span> where <span class="math inline">\(K_{d}(t,\mathbf{y}-\mathbf{x})\)</span> is the <a href="ch-harmonicAn.html#sub:heatEq">heat kernel</a>. Depending on the definition of the transition probability of the Brownian motion, if <span class="math display">\[K_{d}(t,\mathbf{y}-\mathbf{x})=\frac{\mbox{e}^{-\frac{\|\mathbf{y}-\mathbf{x}\|^2}{2t}}}{(2\pi t)^{-d/2}},\]</span> the scaling factor in front of the expectation in the right-hand side will not be <span class="math inline">\(1\)</span> but <span class="math inline">\(1/2\)</span> as the new kernel is the solution of <span class="math display">\[\frac{\partial u}{\partial t} = \frac{1}{2}\Delta u.\]</span></span> <span class="math display">\[\mathbb{E}\left[f(\mathbf{B}_{t})|\mathcal{F}_s\right]=f(\mathbf{B}_{s})+\mathbb{E}\left[\left.\int_{s}^{t}\Delta f(\mathbf{B}_{\tau})\mbox{d}\tau \right|\mathcal{F}_s \right],\]</span> for any <span class="math inline">\(s\leq t\)</span>.</p>
<p>When <span class="math inline">\(f\)</span> is a non-negative measurable harmonic function, then it is straightforward to see
<span class="math display">\[\mathbb{E}\left[\left.\int_{s}^{t}\Delta f(\mathbf{B}_{\tau})\mbox{d}\tau\right|\mathcal{F}_s\right]=0.\]</span></p>
<p>Now we prove <span class="math display">\[\mathbb{E}\left[f(\mathbf{B}_{t})|\mathcal{F}_s\right]=f(\mathbf{B}_{s})+\mathbb{E}\left[\left.\int_{s}^{t}\Delta f(\mathbf{B}_{\tau})\mbox{d}\tau \right|\mathcal{F}_s \right],\]</span> for any <span class="math inline">\(s\leq t\)</span>.</p>
<p>Frist, we need to prove that
<span class="math display">\[\mathbb{E}\left[f(\mathbf{B}_{t})|\mathbf{B}_{0}=\mathbf{x}\right]=f(\mathbf{x})+\mathbb{E}\left[\int_{0}^{t}\Delta f(\mathbf{B}_{\tau})\mbox{d}\tau|\mathbf{B}_{0}=\mathbf{x} \right].\]</span>
Let the transition density <span class="math inline">\(\Pr(\mathbf{B}_{t}=\mathbf{y}|\mathbf{B}_{0}=\mathbf{x})\)</span> be the <a href="ch-harmonicAn.html#sub:heatEq">heat kernel</a> <span class="math inline">\(K_{d}(t,\mathbf{y}-\mathbf{x})\)</span>.
We can represent the heat kernel by its integrated form
<span class="math display">\[K_{d}(t,\mathbf{y}-\mathbf{x})=\int_{0}^{t}\frac{\partial}{\partial \tau}K_{d}(\tau,\mathbf{y}-\mathbf{x})\mbox{d}\tau.\]</span></p>
<p>As the heat kernel is the solution of the heat equation, we know <span class="math display">\[\frac{\partial}{\partial \tau}K_{d}(\tau,\mathbf{y}-\mathbf{x})=\Delta K_{d}(\tau,\mathbf{y}-\mathbf{x})\]</span>
where the operator <span class="math inline">\(\Delta\)</span> is the Laplacian operator on <span class="math inline">\(\mathbf{y}\)</span>. The conditional expection becomes <span class="math display">\[\begin{align*}\mathbb{E}\left[f(\mathbf{B}_{t})-f(\mathbf{B}_{0})|\mathbf{B}_{0}=\mathbf{x}\right]   &amp;=\int K_{d}(\tau,\mathbf{y}-\mathbf{x})f(\mathbf{y})\mbox{d}\mathbf{y}\\
&amp;=\int_{0}^{\tau}\int\frac{\partial}{\partial s}K_{d}(\tau,\mathbf{y}-\mathbf{x})f(\mathbf{y})\mbox{d}\mathbf{y}\mbox{d}s\\
    &amp;=\int_{0}^{\tau}\int\left(\Delta K_{d}(\tau,\mathbf{y}-\mathbf{x})\right)f(\mathbf{y})\mbox{d}\mathbf{y}\mbox{d}s\\
    &amp;=\mathbb{E}\left[\int_{0}^{t}\Delta f(\mathbf{B}_{\tau})\mbox{d}\tau|\mathbf{B}_{0}=\mathbf{x}\right].\end{align*}\]</span>
Note that
<span class="math display">\[\mathbb{E}\left[f(\mathbf{B}_{t})-f(\mathbf{B}_{0})|\mathbf{B}_{0}=\mathbf{x}\right]=\mathbb{E}\left[f(\mathbf{B}_{t})|\mathbf{B}_{0}=\mathbf{x}\right]-f(\mathbf{B}_{0}).\]</span>
So we have <span class="math display">\[\mathbb{E}\left[f(\mathbf{B}_{t})|\mathbf{B}_{0}=\mathbf{x}\right]=f(\mathbf{x})+\mathbb{E}\left[\int_{0}^{t}\Delta f(\mathbf{B}_{\tau})\mbox{d}\tau|\mathbf{B}_{0}=\mathbf{x} \right].\]</span>
The above procedure still holds if we change the condition <span class="math inline">\(\mathcal{F}_{0}=\{\mathbf{B}_{0}=\mathbf{x}\}\)</span> to the information set <span class="math inline">\(\mathcal{F}_{s}\)</span>.</p>
<p>If we let function <span class="math inline">\(f\)</span> be a time-inhomogenous function <span class="math inline">\(f(t,\cdot)\)</span>, the following term <span class="math display">\[f(t,\mathbf{B}(t))-\int_{0}^{t}\left(\frac{\partial}{\partial t}-\Delta)f(\tau,\mathbf{B}(\tau)\right)\mbox{d}\tau\]</span>
is a <strong>martingale</strong> with mean value <span class="math inline">\(0\)</span>.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Now let’s connect the <strong>martingale condition</strong> with the <strong>characteristic function</strong>. For each <strong>Lévy process</strong>, there exists a corresponding operator for constructing the (zero) <strong>martingale</strong> condition. This operator is the one used in our previous definition of the <strong>Lévy process</strong>.</p>
<p>For a (non-probabilistic) operator <span class="math inline">\(\mathbf{A}_{L}\)</span>, if the Fourier transform of <span class="math inline">\(\mathbf{A}_{L}\)</span> satisfies the following <em>Levy-Khinchine condition</em> <span class="math display">\[\mbox{e}^{\mathbf{F}_{\theta}(\mathbf{A}_{L})}=\mbox{e}^{\widehat{\mathbf{A}_{L}}}=\xi_{\mathbf{m}}(\theta),\]</span> then the conditional expectation of <span class="math display">\[f(\mathbf{Z}(t,\omega))-f(\mathbf{Z}(0,\omega))-\int_{0}^{t}\mathbf{A}_{L}f(\mathbf{Z}(\tau,\omega))\mbox{d}\tau\]</span>
is a <strong>martingale</strong> with zero mean value for any infinitely differentiable continuous function <span class="math inline">\(f: \mathbb{R}^{d}\rightarrow \mathbb{R}\)</span>.<label for="tufte-sn-627" class="margin-toggle sidenote-number">627</label><input type="checkbox" id="tufte-sn-627" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">627</span> The meaning of <span class="math inline">\(\mathbf{A}_{L}\)</span> relates to the construction of a <strong>convolution semigroup</strong>. Recall the relation between <span class="math inline">\(\mbox{d}/\mbox{d}t\)</span> and <span class="math inline">\(\mbox{e}^{t\Delta}\)</span> for the <a href="ch-harmonicAn.html#sub:heatEq">heat equation</a> <span class="math display">\[\frac{\mbox{d}}{\mbox{d}t}f\star(K_{d})=\Delta f\star(K_{d}).\]</span> There is a similar relation between <span class="math inline">\(\mbox{d}/\mbox{d}t\)</span> and <span class="math inline">\(\mbox{e}^{t\mathbf{A}_{L}}\)</span>:
<span class="math display">\[\frac{\mbox{d}}{\mbox{d}t}f\star(\mathbb{P})=\mathbf{\mathbf{A}}_{L}f\star(\mathbb{P}).\]</span> See the following proof for the detail.</span></p>
<div class="solution">
<p class="solution-begin">
Proof <span id="sol-start-144" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-144', 'sol-start-144')"></span>
</p>
<div id="sol-body-144" class="solution-body" style="display: none;">
<p>Let <span class="math inline">\(\mathbb{P}\)</span> be the probability law of the <strong>Lévy process</strong> <span class="math inline">\(\mathbf{Z}(t,\omega)\)</span>. By using the Fourier transform, we have<br><span class="math display">\[\begin{align*}\frac{\mbox{d}}{\mbox{d}t}\mathbf{F}_{\theta}\left(f\star \mathbb{P}\right)&amp;=\frac{\mbox{d}}{\mbox{d}t}\left[\mathbf{\mathbf{F}}_{\theta}(f) \mathbf{\mathbf{F}}_{\theta}(\mathbb{P})\right]\\&amp;=\mathbf{\mathbf{F}}_{\theta}(f) \frac{\mbox{d}}{\mbox{d}t} \mbox{e}^{t\mathbf{F}_{\theta}(\mathbf{A}_{L})} \\&amp;=\hat{f}(\theta)\mathbf{F}_{\theta}(\mathbf{A}_{L})\mbox{e}^{t\mathbf{F}_{\theta}(\mathbf{A}_{L})}\\
&amp; =\hat{f}(\theta)\widehat{\mathbf{A}_{L}}\mbox{e}^{t \widehat{\mathbf{A}_{L}}}. \end{align*}\]</span>
The inverse Fourier transform gives the differential equation
<span class="math display">\[\frac{\mbox{d}}{\mbox{d}t}f\star(\mathbb{P})=\mathbf{\mathbf{A}}_{L}f\star(\mathbb{P}).\]</span>
Note that if <span class="math display">\[\mathbf{Z}_{t}(\omega)=\varepsilon_{1}+\cdots+\varepsilon_{t}=\mathbf{Z}_{t-1}(\omega)+\varepsilon_{t}\]</span>
the conditional expectation is about convoluting the <strong>identical stationary increment</strong>
<span class="math display">\[\mathbb{E}\left[\left.f(\mathbf{Z}_{t}(\omega))\right|\mathbf{Z}_{t-1}(\omega)=\mathbf{z}\right]=\int f(\mathbf{z}+e)\mathbb{P}_{\mathbf{m}}(\mbox{d}e)=f\star\mathbb{P}_{\mathbf{m}}\]</span>
which implies <span class="math inline">\(\mathbb{E}[f(\mathbf{Z}_{t})|\mathcal{F}_{s}]=f\star\mathbb{P}_{\mathbf{m}}^{\star(t-s)}\)</span>.
Thus, integrating the differential equation, we have the <strong>martingale representation</strong>.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>For example, for the Gaussian white noise <span class="math inline">\(\varepsilon\sim\mathcal{N}(0,1)\)</span>, the <strong>characteristic function</strong> is <span class="math inline">\(\mathbb{E}[\mbox{e}^{\mbox{i}\theta\varepsilon}]=\mbox{e}^{-\frac{1}{2}\theta^{2}}\)</span>. On the other hand, the <a href="ch-harmonicAn.html#sub:heatEq">Laplacian operator</a> for the delta function under the Fourier transform is <span class="math display">\[\mathbf{F}_\theta(\Delta \delta(x))= (- \mathbf{i}\theta)^{2} \mathbf{F}_\theta(\delta(x))=\theta^{2}.\]</span></p>
<div class="solution">
<p class="solution-begin">
Fourier transform of Laplacian operator <span id="sol-start-145" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-145', 'sol-start-145')"></span>
</p>
<div id="sol-body-145" class="solution-body" style="display: none;">
<p>For simplicity, let’s assume that <span class="math inline">\(\lim_{x\rightarrow\pm\infty}f(x)=0\)</span>.</p>
<p><span class="math display">\[\begin{align*}\mathbf{F}_{\theta}\left(\frac{\partial f(x)}{\partial x}\right)&amp;=\mathbb{E}\left[\mbox{e}^{\mbox{i}\theta x}\left(\frac{\partial f(x)}{\partial x}\right)\mbox{d}x\right]\\&amp;=\left.\mbox{e}^{\mbox{i}\theta x}f(x)\right|_{x=-\infty}^{\infty}-\int\mbox{i}\theta x\mbox{e}^{\mbox{i}\theta x}f(x)\mbox{d}x \\
&amp;=-\mbox{i}\theta\mathbf{F}_{\theta}\left(f(x)\right)\end{align*}\]</span>
where the second equality comes from integral by parts, and the third equality comes from the assumption <span class="math inline">\(\lim_{x\rightarrow\pm\infty}f(x)=0\)</span>.</p>
<p>For the second-order derivative, we have<span class="math display">\[\mathbf{F}_{\theta}\left(\frac{\partial^{2}f(x)}{\partial x^{2}}\right)=\theta^{2}\mathbf{F}_{\theta}\left(f(x)\right).\]</span></p>
<p>As you can see, the tourier transform of the derivative of a function is <span class="math inline">\((-\mbox{i}\theta)\)</span> times the Fourier transform of the funciton. For each differentiation, a new factor <span class="math inline">\((-\mbox{i}\theta)\)</span> emerges in the Fourier domain.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Let the operator <span class="math inline">\(\mathbf{A}_L=\Delta\)</span>, by <strong>Levy-Khinchine condition</strong>, we will have <span class="math display">\[\mbox{e}^{\mathbf{F}_{\theta}(-\Delta/2)}=\mbox{e}^{-\frac{1}{2}\theta^{2}}.\]</span> So the heat equation induced by the Laplacian operator corresponds to the <strong>Lévy process</strong> (<strong>Brownian motion</strong>), whose <strong>identical stationary increments</strong> are Gaussian white noises.</p>
<p><span class="newthought">Infinite divisibility with symmetry</span></p>
<p>The <em>equality of conditions</em>, namely all people living in approximately the same general economic conditions, does not exist under uncertainty.
Because this equality targets the deterministic equality state.<label for="tufte-sn-628" class="margin-toggle sidenote-number">628</label><input type="checkbox" id="tufte-sn-628" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">628</span> Mathematically speaking, the state is characterized by the delta function, while the delta function is not able to describe the uncertainty.</span></p>
<p>To incorporate the uncertainty in the growth, we attempt to model the <strong>equality of opportunity</strong> by using the <strong>identical stationary increments</strong> in the <strong>Lévy process</strong>. Because in the infinite divisible family, any increment will merge with the same probability law as all the others. That is, every individual element faces the same law of probability under a transition from a state <span class="math inline">\(x\)</span> to another state <span class="math inline">\(x'\)</span>.</p>
<p>However, the infinitely divisible distribution tells little about the realized inequality caused by the outcome measurement of any random variables. Therefore, to measure the realized inequality caused by the uncertainty, one has to use some (real-valued) indicators to distinguish the severe levels amongst the unequal situations. A popular indicator is the <em>Gini coefficient</em> defined by <span class="math display">\[\frac{\int |x-x'|\mathbb{P}(\mbox{d}x)\mathbb{P}(\mbox{d}x')}{2\int x \mathbb{P}(\mbox{d}x)}.\]</span>
The value of the coefficient is between <span class="math inline">\(0\)</span> and <span class="math inline">\(1\)</span>.<label for="tufte-sn-629" class="margin-toggle sidenote-number">629</label><input type="checkbox" id="tufte-sn-629" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">629</span> If we replace the probability law <span class="math inline">\(\mathbb{P}\)</span> with the <a href="ch-randomization.html#sub:RHilbert">delta function</a>, the <strong>Gini coefficient</strong> returns zero, namely perfect equality. On the contrary, the value <span class="math inline">\(1\)</span> represents perfect inequality.</span></p>
<p>The <strong>Gini coefficient</strong> is not very sensitive to symmetry. For a positive-valued random variable, the symmetry always implies a Gini-coefficient less than <span class="math inline">\(1/2\)</span>, and Gini-coefficients greater than 1/2 indicate a distribution skewed to the larger values (than the mean).<label for="tufte-sn-630" class="margin-toggle sidenote-number">630</label><input type="checkbox" id="tufte-sn-630" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">630</span> For a normal distribution with a positive mean, if its variance approaches zero, the distribution converges to the delta function.</span></p>
<p>What will be a characteristic function relating to the symmetricty? For a random variable <span class="math inline">\(X(\omega)\)</span>, if <span class="math inline">\(\mathbb{E}[X]^{2}&lt;\infty\)</span> and <span class="math inline">\(\mathbb{E}[X]^{k}=0\)</span> for any <span class="math inline">\(k&gt;2\)</span>, then Taylor’s series of the <strong>characteristic function</strong> of <span class="math inline">\(X(\omega)\)</span> approximates to <span class="math display">\[\mathbb{E}[\mbox{e}^{\mbox{i}\theta X}] \approx 1+\mbox{i}\theta\mathbb{E}[X]-\frac{1}{2}\theta^{2}\mathbb{E}[X^{2}].\]</span>
The latter is the characteristic function of a normal random variable.<label for="tufte-sn-631" class="margin-toggle sidenote-number">631</label><input type="checkbox" id="tufte-sn-631" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">631</span> Notice that the Taylor’s series of the <strong>characteristic function</strong> of <span class="math inline">\(Y(\omega)\sim \mathcal{N}(\mu,\sigma^2)\)</span> is
<span class="math display">\[\begin{align*}\mathbb{E}[\mbox{e}^{\mbox{i}\theta X}] &amp;= \mbox{e}^{\mbox{i}\theta \mu-\frac{\sigma^2\theta^2}{2}}  \\
&amp;\approx 1+\mbox{i}\theta\mu-\frac{1}{2}\theta^{2}\sigma^2.\end{align*}\]</span>
Thus, the term <span class="math inline">\(-\frac{1}{2}\theta^{2}\mathbb{E}[X^{2}]=-\frac{1}{2}\theta^{2}\)</span> for <span class="math inline">\(X(\omega) \sim \mathcal{N}(0,1)\)</span> corresponds to the <span class="math inline">\(\frac{1}{2} \Delta\)</span> under the (inverse) Fourier transform.</span>
Roughly speaking, a characteristic function acquires symmetricity when the finite second moment exists and the complex-valued higher moments degenerate.<label for="tufte-sn-632" class="margin-toggle sidenote-number">632</label><input type="checkbox" id="tufte-sn-632" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">632</span> The procedure can be expressed in terms of a multivariate normal distribution by interpreting the multivariate distribution as a product of <span class="math inline">\(d\)</span> one-dimensional normal distributions.</span></p>
<p>For the distributions in the <strong>infinitely divisible family</strong>, the symmetricity (of the second moment) can be <a href="ch-harmonicAn.html#sub:convolution">characterized</a> by the Laplacian operators.
To see this argument, let’s construct a random variable <span class="math inline">\(S_{n}(\omega)\)</span> such that
<span class="math display">\[S_{n}(\omega)=\frac{1}{\sqrt{n}}\left(X_{1}(\omega)+\cdots+X_{n}(\omega)\right)\]</span>
for i.i.d. random variable <span class="math inline">\(X_{i}(\omega)\sim\mathbb{P}_{X}\)</span> and <span class="math inline">\(S_{n}(\omega)\sim\mathbb{P}_{S_{n}}\)</span>. The random variable <span class="math inline">\(S_{n}(\omega)\)</span> belongs to the <strong>infinitely divisible family</strong>. The <strong>characteristic function</strong> of <span class="math inline">\(S_{n}(\omega)\)</span> converges to <span class="math inline">\(\mbox{e}^{-\frac{\theta^{2}}{2}}\)</span>.</p>
<div class="solution">
<p class="solution-begin">
Proof <span id="sol-start-146" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-146', 'sol-start-146')"></span>
</p>
<div id="sol-body-146" class="solution-body" style="display: none;">
<p>Note that <span class="math display">\[\begin{align*}\mathbf{F}_{\theta}\left(\mathbb{P}_{S_{n}}\right)&amp;=\frac{1}{\sqrt{n}}\mathbf{F}_{\theta}\left(\mathbb{P}_{X}^{(\star n)}\right)\\
&amp;=\left(\mathbb{E}\left[\mbox{e}^{\mbox{i}\frac{\theta X_{i}}{\sqrt{n}}}\right]\right)^{n}\\
&amp;=\left(\xi_{X}\left(\frac{\theta}{\sqrt{n}}\right)\right)^{n}.\end{align*}\]</span>
The <strong>characteristic function</strong> of <span class="math inline">\(S_{n}(\omega)\)</span> set up
<span class="math inline">\(\xi_{S_{n}}(\theta)=\left(\xi_{X}\left(\frac{\theta}{\sqrt{n}}\right)\right)^{n}\)</span>
for any <span class="math inline">\(\theta\in\mathbb{R}\)</span>. The expansion of the characteristic function gives
<span class="math display">\[\left(\xi_{X}\left(\frac{\theta}{\sqrt{n}}\right)\right)^{n}\\=\left(1-\frac{\theta^{2}}{2n}+o\left(\frac{1}{n}\right)\right)^{n},\]</span>
Furthermore,
<span class="math display">\[\begin{align*}\lim_{n\rightarrow\infty}\left(1-\frac{\theta^{2}}{2n}+o\left(\frac{1}{n}\right)\right)^{n}\\=\lim_{n\rightarrow\infty}\left(1-\frac{\theta^{2}}{2n}\right)^{n}=\mbox{e}^{-\frac{\theta^{2}}{2}}.\end{align*}\]</span> The results follows.</p>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>By the duality property of the characteristic function, the convergence means that the random variable <span class="math inline">\(S_{n}(\omega)\)</span> behaves similarly as a standard normal random variable when <span class="math inline">\(n\)</span> goes to infinity.<label for="tufte-sn-633" class="margin-toggle sidenote-number">633</label><input type="checkbox" id="tufte-sn-633" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">633</span> For a sequence of i.i.d. random variables of this type, one can always <a href="ch-CalUn.html#sub:ex">standardize</a> the sum of variables, and the standardized sum converges to a standard normal distribution. This statement is also known as the <em>central limit theorem</em>. When the higher moments exist, the <strong>central limit theorem</strong> may still be valid. However, if a probability has divergent higher moments, the theorem may only hold in some regions of the domain where the divergences do not cause serious bais for the approximations.</span></p>
<p><span class="newthought">Infinite divisibility with asymmetry</span></p>
<p>We’ve seen that the symmetricity in the <strong>Lévy processes</strong> relates to the Laplacian operator in <span class="math inline">\(\mathbf{A}_{L}\)</span>.<label for="tufte-sn-634" class="margin-toggle sidenote-number">634</label><input type="checkbox" id="tufte-sn-634" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">634</span> Note that if we extend the Laplacian operator to the fractional Laplacian operator, then we can characterize some more complicated situations, i.e., asymmetric distribution with infinite variance and a finite mean or an infinite mean and finite variance. But this is beyond our current concern.</span> Thus, it is natural to think of the asymmetry in the infinite divisible processes to be controlled by the operator <span class="math inline">\(\mathbf{A}_L\)</span> without involving the Laplacian term.</p>
<p>We will study the “dual” behaviors of such an operator acting on the probability law rather than on the bounded continuous function <span class="math inline">\(f\)</span>.<label for="tufte-sn-635" class="margin-toggle sidenote-number">635</label><input type="checkbox" id="tufte-sn-635" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">635</span> Intuitively speaking, if we view an expectation as an inner product <span class="math display">\[\mathbb{E}\left[ f(X_t(\omega))\right]= \left\langle f,\mathbb{P}\right\rangle,\]</span> then an operator acting on <span class="math inline">\(f\)</span> can be dually expressed on the probability law <span class="math inline">\(\mathbb{P}\)</span>. For example, for the Laplacian operator (a <a href="ch-representation.html#sub:conjugacy">self-adjoint operator</a>), we have <span class="math display">\[\begin{align*} &amp;\mathbb{E}\left[\Delta f(X_t(\omega))\right]=\\
&amp;\left\langle \Delta f,\mathbb{P}\right\rangle=\left\langle f,\Delta\mathbb{P}\right\rangle \end{align*}\]</span>
Then for the expectation of a <strong>Lévy process</strong>, we expect to have
<span class="math display">\[\begin{align*}&amp; \mathbb{E}\left[\mathbf{A}_L f(X_t(\omega))\right] \\
&amp;= \langle \mathbf{A}_Lf, \mathbb{P} \rangle = \langle f, \mathbf{A}^{\mbox{H}}_L \mathbb{P} \rangle.\end{align*}\]</span></span>
Consider the following <em>integro-partial differential</em> equation
<span class="math display" id="eq:gamma">\[\begin{align} \frac{\partial}{\partial t}\mathbb{P}(x,t) &amp;= \mathbf{A}^{\mbox{H}}_L\mathbb{P}(x,t) \notag \\
&amp;= -c(x) \frac{\partial\mathbb{P}(x,t)}{\partial x}+\alpha\left[\int K(x,x')\mathbb{P}(\mbox{d} x',t) \right] \tag{18.1}
\end{align}\]</span>
The equation tells that the change of the probability law along the time composes of the changes with respect to the state variable <span class="math inline">\(x\)</span> and an integrated operator with respect to a kernel <span class="math inline">\(K(\cdot, \cdot)\)</span>.</p>
<p>While the roles of the partial derivatives in <a href="ch-harmonicAn.html#eq:gamma">(18.1)</a> are easy to understand, the integrated kernel in <a href="ch-harmonicAn.html#eq:gamma">(18.1)</a> is worthing further discussion. Like the Laplacian operator, the integrated operator captures the interacted effects simultaneously caused by the variations of the input states.<label for="tufte-sn-636" class="margin-toggle sidenote-number">636</label><input type="checkbox" id="tufte-sn-636" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">636</span> Recall that some kernel <span class="math inline">\(K(\cdot,\cdot)\)</span> plays the role of an eigenfunction for the Laplacian operator <span class="math inline">\(\Delta K= \lambda K\)</span>.</span> However, the integrated kernel provides a more flexible structure.</p>
<p>Let’s select <span class="math inline">\(n\)</span> points from an interval <span class="math inline">\([a,b]\)</span> such that <span class="math inline">\(a\leq x_{1}&lt;\cdots&lt;x_{n}\leq b\)</span>. The following simultaneous system <span class="math display">\[\begin{align*}\frac{\mbox{d}p(x_{1},t)}{\mbox{d}t} &amp;=k_{11}p(x_{1},t)+k_{12}p(x_{2},t)+\cdots+k_{1n}p(x_{n},t)
\\&amp;\vdots   
\\
\frac{\mbox{d}p(x_{n},t)}{\mbox{d}t}    &amp;=k_{n1}p(x_{1},t)+k_{n2}p(x_{2},t)+\cdots+k_{nn}p(x_{n},t)\end{align*}\]</span>
is equivalent to <span class="math display">\[\frac{\mbox{d}p(x_{i},t)}{\mbox{d}t}=\sum_{j=1}^{n}k_{ij}p(x_{j},t), \,\,\, \mbox{ for }i=1,\dots,n\]</span> where <span class="math inline">\(k_{ij}=K(x_{i},x_{j})\)</span>.
If we let <span class="math inline">\(n\)</span> grow to infinite, the infinite-dimensional simultaneous system can be “extended” to an integral equation <span class="math display">\[\frac{\mbox{d}\mathbb{P}(x,t)}{\mbox{d}t}=\int_{a}^{b}K(x,x')\mathbb{P}(\mbox{d}x',t).\]</span></p>
<p>To allow for the <strong>infinite divisibility</strong>, we need to impose <span class="math inline">\(K(x,x')\)</span> to be a time-invariant homogenous kernel <span class="math inline">\(K(x-x')\)</span> so that the integration becomes the convolution in equation <a href="ch-harmonicAn.html#eq:gamma">(18.1)</a>.<label for="tufte-sn-637" class="margin-toggle sidenote-number">637</label><input type="checkbox" id="tufte-sn-637" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">637</span> Intuitively speaking, the specification of the kernel function corresponds to the increment of the associated stochastic process. For an arbitrary small <span class="math inline">\(\epsilon= x-x'\)</span>, the effect given by the kernel is independent (memoryless), identical, and time-homogeneous, so as the increment for the process. The interaction only happened for the successive increments due to the independence (memoryless) of the increments.</span></p>
<p>For example, if we set the kernel <span class="math inline">\(K(x, x')\)</span> as a delta function <span class="math inline">\(\delta(x'-x)\)</span>, the equation becomes
<span class="math display">\[\begin{align*}\frac{\partial}{\partial t}\mathbb{P}(x,t) &amp;= -c(x) \frac{\partial\mathbb{P}(x,t)}{\partial x}+\alpha\left[ K \star \mathbb{P}\right]
\\&amp;= -c(x) \frac{\partial\mathbb{P}(x,t)}{\partial x}+\alpha \mathbb{P}(x,t).\end{align*}\]</span>
At the equilibrium stage, namely <span class="math inline">\(\partial \mathbb{P}(x,t)/ \partial t =0\)</span>, the equation becomes
<span class="math display">\[ c(x) \frac{\partial\mathbb{P}(x)}{\partial x} = \alpha \mathbb{P}(x).\]</span>
If we set <span class="math inline">\(c(x)=x\)</span> and <span class="math inline">\((\mathbb{P}(x_b)/x_b^{\alpha})=b\)</span> for some constant lower bound <span class="math inline">\(x_b\)</span>, the solution of the above differentiation equation is <span class="math inline">\(\mathbb{P}(x)=b x^{-\frac{1}{\alpha}}\)</span> known as the <em>power-law distribution</em>.<label for="tufte-sn-638" class="margin-toggle sidenote-number">638</label><input type="checkbox" id="tufte-sn-638" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">638</span> We re-arrange the expression <span class="math display">\[\frac{1}{\mathbb{P}(x)}\frac{\mbox{d}\mathbb{P}(x)}{\mbox{d} x} =\frac{\mbox{d}\ln\mathbb{P}(x)}{\mbox{d}x}= \frac{\alpha}{x}\\ \mbox{or say, }
\mbox{d}\ln\mathbb{P}(x)=\alpha \mbox{d}(\ln x).\]</span> The integration (from <span class="math inline">\(x_b\)</span> to <span class="math inline">\(x\)</span>) gives
<span class="math display">\[\ln\mathbb{P}(x) - \ln\mathbb{P}(x_b) = \alpha (\ln x - \ln x_b),\]</span>
which means
<span class="math display">\[ \frac{\mathbb{P}(x)}{\mathbb{P}(x_b)}=(\frac{x}{x_b})^{\alpha} \\
\mbox{or } \mathbb{P}(x)= \frac{\mathbb{P}(x_b)}{x_b^{\alpha}} x^{\alpha} =b x^{\alpha}.\]</span></span> It also has infinite divisible properties.</p>
<p>The parameter <span class="math inline">\(\alpha\)</span> is an aggregated parameter. It captures the shape of the <strong>power-law distribution</strong>, thus it also reflects the level of inequality. By increasing the value of <span class="math inline">\(\alpha\)</span>, we expect to have more equal shapes for the distribution.<label for="tufte-sn-639" class="margin-toggle sidenote-number">639</label><input type="checkbox" id="tufte-sn-639" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">639</span> The <strong>Gini coefficient</strong> for the power-law distribution is <span class="math display">\[\frac{1}{2\alpha-1}.\]</span> Thus, the larger <span class="math inline">\(\alpha\)</span>, the smaller value of the <strong>Gini coefficient</strong>, which implies more equality.</span></p>
<p>Let’s consider a more delicate specification of the kernel. We specify the time-homogeneous kernel <span class="math inline">\(K(x-x')\)</span> in <a href="ch-harmonicAn.html#eq:gamma">(18.1)</a> by the <em>exponential density function</em> <span class="math display">\[K(x-x')=\begin{cases}
\lambda\mbox{e}^{-\lambda(x-x')}, &amp; \: x-x'\geq0,\\
0, &amp; \: x-x'&lt;0.
\end{cases}\]</span> Figure <a href="ch-harmonicAn.html#fig:expKernel">18.7</a> shows that the kernel is asymmetric. The solution of equation <a href="ch-harmonicAn.html#eq:gamma">(18.1)</a> is a <a href="ch-CalUn.html#sub:divRV">Gamma distribution</a> <span class="math display">\[\mathbb{P}(x)=\frac{\beta^{\alpha}x^{\alpha-1}e^{-\beta x}}{\Gamma(\alpha)}\sim\mbox{Gamma}(\alpha,\beta),\]</span> which is also infinitely divisible.<label for="tufte-sn-640" class="margin-toggle sidenote-number">640</label><input type="checkbox" id="tufte-sn-640" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">640</span> The Gamma distribution of <span class="math inline">\(n\)</span> individuals is <span class="math display">\[\frac{\beta^{\frac{\alpha}{n}}x^{\frac{\alpha-1}{n}}e^{-\beta x}}{\Gamma(\frac{\alpha}{n})}\sim\mbox{Gamma}\left(\frac{\alpha}{n},\beta\right).\]</span> </span></p>
<div class="solution">
<p class="solution-begin">
Exponential kernel and memoryless <span id="sol-start-147" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-147', 'sol-start-147')"></span>
</p>
<div id="sol-body-147" class="solution-body" style="display: none;">
<p>The <strong>exponential density function</strong> comes from the following memoryless property (the second equality) <span class="math display">\[\begin{align*}\Pr\left\{ \left.X_{t}(\omega)&gt;x+\epsilon\right|X_{t}(\omega)&gt;\epsilon\right\} &amp;=\frac{\Pr\{X_{t}(\omega)&gt;x+\epsilon\}}{\Pr\{X_{t}(\omega)&gt;\epsilon\}}\\
&amp;=\Pr\{X_{t}(\omega)&gt;x\}.\end{align*}\]</span>
To see this, taking logarithm and denoting <span class="math display">\[k(x)=\log\Pr\{X_{t}(\omega)&gt;x\},\]</span> one has <span class="math inline">\(k(x+\epsilon)=k(\epsilon)+k(x)\)</span>, a linear decreasing function. Since <span class="math inline">\(k(x)\)</span>
is a linear function of <span class="math inline">\(x\)</span>, we can write it as <span class="math inline">\(k(x)=-\beta x\)</span> which means <span class="math display">\[\Pr\{X_{t}(\omega)\leq x\}=1-e^{-\beta x},\]</span> a exponential distribution whose density kernel is <span class="math inline">\(\beta e^{-\beta x}\)</span>.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb194-1" data-line-number="1">n =<span class="st"> </span><span class="dv">10</span>; beta =<span class="st"> </span><span class="fl">0.01</span></a>
<a class="sourceLine" id="cb194-2" data-line-number="2">KernelMatrix =<span class="st"> </span><span class="cf">function</span>(x1,x2){ </a>
<a class="sourceLine" id="cb194-3" data-line-number="3">  <span class="cf">if</span> (x1<span class="op">&gt;</span>x2 <span class="op">||</span><span class="st"> </span>x2<span class="op">&lt;</span>x1)</a>
<a class="sourceLine" id="cb194-4" data-line-number="4">  {beta<span class="op">*</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>beta<span class="op">*</span>(x1<span class="op">-</span>x2))}</a>
<a class="sourceLine" id="cb194-5" data-line-number="5">  <span class="cf">else</span> {<span class="kw">return</span>(<span class="dv">0</span>)}</a>
<a class="sourceLine" id="cb194-6" data-line-number="6">  }; <span class="co"># exponential kernel</span></a>
<a class="sourceLine" id="cb194-7" data-line-number="7">x =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">100</span>, <span class="dt">length.out =</span> n); <span class="co"># 100 points in [0,100]</span></a>
<a class="sourceLine" id="cb194-8" data-line-number="8">KernelMatrix =<span class="st"> </span><span class="kw">sapply</span>(x, <span class="cf">function</span>(argument_<span class="dv">1</span>){<span class="kw">sapply</span>(x, <span class="cf">function</span>(argument_<span class="dv">2</span>){</a>
<a class="sourceLine" id="cb194-9" data-line-number="9">     <span class="kw">KernelMatrix</span>(argument_<span class="dv">1</span>, argument_<span class="dv">2</span>)})})</a>
<a class="sourceLine" id="cb194-10" data-line-number="10"><span class="kw">library</span>(Matrix); K=<span class="kw">Matrix</span>(KernelMatrix); <span class="kw">image</span>(K, <span class="dt">colorkey=</span><span class="ot">TRUE</span>); </a></code></pre></div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>Because <span class="math inline">\(\beta\)</span> emerges inside the kernel, we interpret <span class="math inline">\(\beta\)</span> as the parameter of individual growth (parameter for the increments) due to the interactions amongst the individuals.</p>
<p>Like the parameter in the <strong>power-law distribution</strong>, the parameter <span class="math inline">\(\alpha\)</span> in the <a href="ch-CalUn.html#sub:divRV">Gamma distribution</a> is an aggregated parameter, as it emerges outside the kernel integral.</p>
<div id="htmlwidget-f9dc01dd2ce988faf0ae" style="width:55%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f9dc01dd2ce988faf0ae">{"x":{"filter":"none","caption":"<caption>Income data (numbers in thousands) <\/caption>","autoHideNavigation":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22"],[1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015],[186402,188073,189997,191615,193642,195636,196957,200814,202275,203482,205146,207231,208491,210019,211831,211254,212411,214559,216917,222003,222972,226762],[18964,17946,16525,15927,16196,15617,15110,15095,15498,15664,14967,14498,12824,11920,12945,12695,12755,12607,12538,14466,14724,14689],[13353,12736,11984,11107,10311,10521,9372,9280,8884,8841,8725,8117,7468,7279,7408,7403,7233,6955,7056,6764,6613,6262],[17474,16638,16897,16250,15462,14385,13688,13601,13289,12572,12648,12021,11029,10708,9980,9890,9682,9711,9147,9389,8314,7657],[13683,13553,13358,12425,12143,11869,11470,11755,11417,11431,11398,11113,10504,11014,11496,11931,12211,11999,11564,10931,10795,10551],[14639,14389,14350,14575,13335,13307,12975,13154,13397,13228,13122,12631,12999,12456,12874,13004,13173,13529,13188,12784,13085,12474],[10750,10358,10551,10243,10327,9740,9858,9792,9735,9833,9595,9880,9148,9121,9107,9369,9573,9534,9475,9529,8898,8995],[11500,11855,11030,11050,10825,11467,10845,11149,11310,11104,11186,11121,11432,11121,11052,10921,11499,11033,11544,11404,10694,10672],[8656,8691,8740,8416,8380,8459,8539,8450,8384,8147,8061,8229,8009,7871,7749,8468,8496,8369,8546,7966,8101,7931],[9812,10383,10276,10854,10410,10420,10754,10510,10888,10426,10974,10934,11195,10762,10944,10805,10933,10898,11075,10987,11315,11031],[6710,6864,7336,6952,7023,6888,9750,7113,6957,7180,6917,6949,6610,6542,6798,6921,6508,6843,6939,7346,6894,6962],[8106,8197,8784,8788,9034,9093,9583,9059,9222,9188,9258,9300,9524,9564,9192,9299,8818,9134,9286,9047,9215,9623],[5081,5247,5339,5224,5655,5619,5453,5696,5765,5509,5336,5206,5363,5324,5749,5484,5622,5261,5478,5501,5640,5535],[6748,7375,7664,8424,8343,8472,8936,9377,9418,9482,9549,9595,10036,10128,9835,9451,9351,9725,9703,9462,9910,10399],[3752,3976,4007,4117,4189,4320,4231,4478,4301,4139,4289,4281,4376,4221,4243,4285,4130,4201,4169,4424,4234,4429],[5283,5410,5677,5932,6538,6426,6876,7063,6946,7010,7281,7535,7611,7917,7917,7445,7314,7796,7540,6983,7785,7975],[2991,3092,3320,3492,3732,3495,3786,3812,4043,3857,3854,3940,3738,4068,3978,3981,4000,4000,3939,4289,3941,3930],[4487,4624,4898,5178,5521,5957,5951,6376,6763,6916,7150,7281,7585,7643,7568,7432,7611,7594,7485,7824,8044,8091],[2090,2264,2500,2390,2627,2902,2771,2836,2759,2992,2884,2991,2904,3018,2879,3004,2901,2886,2948,3258,3042,3113],[2625,2970,3091,3479,3671,3815,3935,4296,4188,4421,4439,4733,4962,5451,5106,4991,5185,5133,5354,5116,5348,5718],[1687,1923,2015,2102,2295,2302,2470,2406,2559,2588,2859,2863,2772,2881,2888,2964,2863,2972,3068,3245,3113,3221],[2744,2871,3265,3543,3735,3900,4502,4694,4872,4988,5182,5585,6268,6199,6569,6502,6312,6373,6395,5939,6528,7130],[1336,1350,1485,1612,1973,1892,1764,1933,1956,2086,1875,1987,2119,2236,2394,2226,2201,2208,2177,2249,2467,2489],[1547,1813,1734,1994,2142,2288,2576,2619,2697,2811,2929,3067,3088,3468,3360,3469,3462,3485,3486,4018,3968,3834],[1022,990,971,1186,1381,1414,1452,1416,1410,1379,1517,1516,1684,1848,1776,1801,1884,1725,1766,1984,1944,2066],[1589,1709,1956,1911,2370,2479,3045,3038,3008,3358,3332,3767,4143,4259,4345,4214,4244,4432,4556,4883,4806,5047],[653,789,889,1055,1021,1182,1261,1250,1167,1313,1412,1391,1389,1428,1576,1449,1478,1579,1580,1559,1707,1894],[821,1100,1181,1353,1489,1678,1768,1776,1846,1980,2176,2301,2511,2517,2602,2523,2494,2733,2941,2535,3022,3289],[514,586,632,774,864,886,968,975,976,1092,1108,1184,1204,1198,1307,1254,1319,1253,1400,1316,1423,1493],[748,894,936,1258,1258,1503,1683,1794,1933,2061,2097,2345,2567,2741,2857,2978,2791,2876,3182,3191,3227,3264],[449,417,523,603,624,802,822,800,836,787,903,932,1025,1138,1104,1004,1078,1025,1122,1215,1299,1372],[699,832,787,924,1118,1250,1502,1660,1744,1628,1692,1901,2009,2135,2166,2083,2071,2279,2334,2353,2753,2922],[357,376,444,460,557,638,677,713,684,750,811,776,916,977,973,899,1035,965,971,1051,1046,1307],[542,601,689,761,954,995,1219,1251,1395,1389,1544,1673,1809,1951,2135,1908,2077,2339,2382,2213,2571,2725],[214,347,313,439,446,514,531,589,555,614,649,595,710,755,751,768,891,839,875,982,1001,1021],[298,333,479,496,500,686,740,838,800,978,943,1028,1121,1165,1193,1299,1282,1311,1386,1490,1527,1508],[298,180,288,292,353,368,364,356,392,501,538,510,512,568,613,566,607,595,759,992,791,856],[208,356,369,455,480,627,696,758,821,973,1003,1046,1178,1326,1385,1468,1479,1478,1736,1742,1738,1966],[338,207,237,195,287,310,268,446,349,426,447,455,548,552,525,572,516,588,683,725,683,712],[179,212,266,280,339,388,386,510,544,523,703,683,740,772,830,775,780,818,841,1071,976,1090],[195,138,166,219,262,231,348,350,356,310,404,377,475,581,448,485,513,549,576,672,723,768],[128,72,97,102,5474,6531,6952,7749,8213,9008,9390,10895,12386,13195,13215,13268,14039,14930,15727,19108,19063,20755]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Year.Total<\/th>\n      <th>Total.With.Income<\/th>\n      <th>X.1.to..2.499.or.Loss<\/th>\n      <th>X.2.500.to..4.999<\/th>\n      <th>X.5.000.to..7.499<\/th>\n      <th>X.7.500.to..9.999<\/th>\n      <th>X.10.000.to..12.499<\/th>\n      <th>X.12.500.to..14.999<\/th>\n      <th>X.15.000.to..17.499<\/th>\n      <th>X.17.500.to..19.999<\/th>\n      <th>X.20.000.to..22.499<\/th>\n      <th>X.22.500.to..24.999<\/th>\n      <th>X.25.000.to..27.499<\/th>\n      <th>X.27.500.to..29.999<\/th>\n      <th>X.30.000.to..32.499<\/th>\n      <th>X.32.500.to..34.999<\/th>\n      <th>X.35.000.to..37.499<\/th>\n      <th>X.37.500.to..39.999<\/th>\n      <th>X.40.000.to..42.499<\/th>\n      <th>X.42.500.to..44.999<\/th>\n      <th>X.45.000.to..47.499<\/th>\n      <th>X.47.500.to..49.999<\/th>\n      <th>X.50.000.to..52.499<\/th>\n      <th>X.52.500.to..54.999<\/th>\n      <th>X.55.000.to..57.499<\/th>\n      <th>X.57.500.to..59.999<\/th>\n      <th>X.60.000.to..62.499<\/th>\n      <th>X.62.500.to..64.999<\/th>\n      <th>X.65.000.to..67.499<\/th>\n      <th>X.67.500.to..69.999<\/th>\n      <th>X.70.000.to..72.499<\/th>\n      <th>X.72.500.to..74.999<\/th>\n      <th>X.75.000.to..77.499<\/th>\n      <th>X.77.500.to..79.999<\/th>\n      <th>X.80.000.to..82.499<\/th>\n      <th>X.82.500.to..84.999<\/th>\n      <th>X.85.000.to..87.499<\/th>\n      <th>X.87.500.to..89.999<\/th>\n      <th>X.90.000.to..92.499<\/th>\n      <th>X.92.500.to..94.999<\/th>\n      <th>X.95.000.to..97.499<\/th>\n      <th>X.97.500.to..99.999<\/th>\n      <th>X.100.000.and.Over<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"scrollY":true,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:expKernel"></span>
<img src="fig/Part5/expKernel.png" alt="Asymmetric exponential kernel" width="100%"><!--
<p class="caption marginnote">-->Figure 18.7: Asymmetric exponential kernel<!--</p>-->
<!--</div>--></span>
</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:usIncome"></span>
<img src="fig/Part5/usIncome.gif" alt="U.S. total money annual income distribution 1994-2015 (Each bin is an income interval of 2500 USD) " width="100%"><!--
<p class="caption marginnote">-->Figure 18.8: U.S. total money annual income distribution 1994-2015 (Each bin is an income interval of 2500 USD) <!--</p>-->
<!--</div>--></span>
</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:alphaGrowth"></span>
<img src="fig/Part5/alphaGrowth.png" alt="Alpha and Beta growth " width="100%"><!--
<p class="caption marginnote">-->Figure 18.9: Alpha and Beta growth <!--</p>-->
<!--</div>--></span>
</p>
<p>The magnitude of each individual growth (or the jump size of each increment) is positively related to <span class="math inline">\(1/\beta\)</span>. While the magnitude of the aggregated growth (or the jump size of the Lévy process driven by <span class="math inline">\(\mathbb{P}(x,t)\)</span> in <a href="ch-harmonicAn.html#eq:gamma">(18.1)</a>) is positively related to <span class="math inline">\(\alpha\)</span>. We can see that <span class="math inline">\(\beta\)</span>-growth relates to the individual opportunities and <span class="math inline">\(\alpha\)</span>-growth relates to economic inequality.<label for="tufte-sn-641" class="margin-toggle sidenote-number">641</label><input type="checkbox" id="tufte-sn-641" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">641</span> For <span class="math inline">\(X^{*}(\omega) \sim \mbox{Gamma}(\alpha,\beta)\)</span>, the mean is <span class="math inline">\(\alpha/\beta\)</span>, and the variance is <span class="math inline">\(\alpha/\beta^2\)</span>. Thus, the mean of the growth process is positively related to <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(1/\beta\)</span>.</span> Therefore, inequality is mainly affected by the aggregated <span class="math inline">\(\alpha\)</span>-growth.<label for="tufte-sn-642" class="margin-toggle sidenote-number">642</label><input type="checkbox" id="tufte-sn-642" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">642</span> The <strong>Gini coefficient</strong> of the Gamma distribution is <span class="math display">\[\Gamma((2\alpha+1)/2)/\alpha \Gamma(\alpha)\sqrt{\pi}.\]</span> As we can see, it only depends on the value <span class="math inline">\(\alpha\)</span>.</span></p>
<p>I use a data set from the Current Population Survey (CPS) issued by the U.S. Bureau of Labor Statistics and the Census Bureau. The data set is listed above. It records the personal total money income from persons of 15 years old and over (from 1994 to 2015).</p>
<p>For each year, I assume that equation <a href="ch-harmonicAn.html#eq:gamma">(18.1)</a> reaches an equilibrium outcome. Thus, there are <span class="math inline">\(22\)</span> pairs of <span class="math inline">\(\alpha_t\)</span> and <span class="math inline">\(\beta_t\)</span> for <span class="math inline">\(t\)</span> from <span class="math inline">\(1994\)</span> to <span class="math inline">\(2015\)</span>. As shown in figure <a href="ch-harmonicAn.html#fig:usIncome">18.8</a>, the Gamma distributions with different pairs reasonably fit the empirical data. Also, by figure <a href="ch-harmonicAn.html#fig:alphaGini">18.10</a>, we can see that the (computed) U.S. Gini coefficients from these years are monotonically on <span class="math inline">\(\alpha_t\)</span>; the higher <span class="math inline">\(\alpha_t\)</span>, the less inequality (the lower Gini coefficient).</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:alphaGini"></span>
<img src="fig/Part5/alphaGini.png" alt="Alpha growth and Gini coefficient " width="100%"><!--
<p class="caption marginnote">-->Figure 18.10: Alpha growth and Gini coefficient <!--</p>-->
<!--</div>--></span>
</p>
<div class="solution">
<p class="solution-begin">
Code <span id="sol-start-148" class="fa fa-plus-square solution-icon clickable" onclick="toggle_visibility('sol-body-148', 'sol-start-148')"></span>
</p>
<div id="sol-body-148" class="solution-body" style="display: none;">
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1"><span class="kw">library</span>(fitdistrplus)</a>
<a class="sourceLine" id="cb195-2" data-line-number="2"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb195-3" data-line-number="3"><span class="co"># For information on confidentiality protection, sampling error, nonsampling error,</span></a>
<a class="sourceLine" id="cb195-4" data-line-number="4"><span class="co"># and definitions, see www2.census.gov/programs-surveys/cps/techdocs/cpsmar16.pdf</span></a>
<a class="sourceLine" id="cb195-5" data-line-number="5"></a>
<a class="sourceLine" id="cb195-6" data-line-number="6">DataUS &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">"~/Documents/IncomeUS.txt"</span>, <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>, <span class="dt">escape_double =</span> <span class="ot">FALSE</span>, <span class="dt">trim_ws =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb195-7" data-line-number="7"></a>
<a class="sourceLine" id="cb195-8" data-line-number="8">us =<span class="st"> </span><span class="kw">unname</span>(DataUS)</a>
<a class="sourceLine" id="cb195-9" data-line-number="9">us =<span class="st"> </span><span class="kw">as.matrix</span>(us)</a>
<a class="sourceLine" id="cb195-10" data-line-number="10"></a>
<a class="sourceLine" id="cb195-11" data-line-number="11"><span class="co"># Ignore the year and truncate total number of individuals </span></a>
<a class="sourceLine" id="cb195-12" data-line-number="12"><span class="co"># and income larger than $ 100,000</span></a>
<a class="sourceLine" id="cb195-13" data-line-number="13">numcol =<span class="st"> </span><span class="kw">ncol</span>(us)<span class="op">-</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb195-14" data-line-number="14">numrow =<span class="st"> </span><span class="kw">nrow</span>(us)</a>
<a class="sourceLine" id="cb195-15" data-line-number="15">us =<span class="st"> </span>us[,<span class="dv">3</span><span class="op">:</span>numcol]</a>
<a class="sourceLine" id="cb195-16" data-line-number="16"></a>
<a class="sourceLine" id="cb195-17" data-line-number="17"><span class="co"># Generate counting observations</span></a>
<a class="sourceLine" id="cb195-18" data-line-number="18">alpha =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, numrow, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb195-19" data-line-number="19">beta =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,numrow,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb195-20" data-line-number="20">sd.alpha =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, numrow, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb195-21" data-line-number="21">parm =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, numrow, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb195-22" data-line-number="22"></a>
<a class="sourceLine" id="cb195-23" data-line-number="23">t =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb195-24" data-line-number="24"></a>
<a class="sourceLine" id="cb195-25" data-line-number="25"><span class="cf">for</span> (year <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>numrow){</a>
<a class="sourceLine" id="cb195-26" data-line-number="26">  t =<span class="st"> </span>t <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb195-27" data-line-number="27">  iter =<span class="st"> </span><span class="kw">ncol</span>(us)</a>
<a class="sourceLine" id="cb195-28" data-line-number="28">  <span class="co"># For each year</span></a>
<a class="sourceLine" id="cb195-29" data-line-number="29">  x.t =<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb195-30" data-line-number="30">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>iter){</a>
<a class="sourceLine" id="cb195-31" data-line-number="31">    x =<span class="st"> </span><span class="kw">replicate</span>(us[t,i], i)</a>
<a class="sourceLine" id="cb195-32" data-line-number="32">    x.t =<span class="st"> </span><span class="kw">c</span>(x.t,x) </a>
<a class="sourceLine" id="cb195-33" data-line-number="33">    }</a>
<a class="sourceLine" id="cb195-34" data-line-number="34">  est.x =<span class="st"> </span><span class="kw">fitdist</span>(x.t,<span class="st">"gamma"</span>) <span class="co"># estimate the Gamma distribution</span></a>
<a class="sourceLine" id="cb195-35" data-line-number="35">  parm[t] =<span class="st"> </span>est.x<span class="op">$</span>estimate[<span class="st">"shape"</span>]<span class="op">/</span>est.x<span class="op">$</span>estimate[<span class="st">"rate"</span>]</a>
<a class="sourceLine" id="cb195-36" data-line-number="36">  x.t =<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb195-37" data-line-number="37">  alpha[t] =<span class="st"> </span>est.x<span class="op">$</span>estimate[<span class="st">"shape"</span>]</a>
<a class="sourceLine" id="cb195-38" data-line-number="38">  beta[t] =<span class="st"> </span>est.x<span class="op">$</span>estimate[<span class="st">"rate"</span>]</a>
<a class="sourceLine" id="cb195-39" data-line-number="39">  plot.legend=<span class="st"> </span><span class="kw">paste</span>(<span class="st">"Year = "</span>, <span class="dv">1993</span><span class="op">+</span>t, <span class="st">", alpha="</span>, <span class="kw">format</span>(alpha[t],<span class="dt">nsmall=</span><span class="dv">3</span>), <span class="st">", beta="</span>, <span class="kw">format</span>(beta[t],<span class="dt">nsmall=</span><span class="dv">3</span>) )</a>
<a class="sourceLine" id="cb195-40" data-line-number="40">  <span class="kw">denscomp</span>(<span class="kw">list</span>(est.x), <span class="dt">xlab=</span><span class="st">""</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,iter), <span class="dt">fitcol =</span> <span class="kw">c</span>(<span class="st">"blue"</span>), <span class="dt">main =</span> plot.legend, <span class="dt">addlegend =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb195-41" data-line-number="41">}</a>
<a class="sourceLine" id="cb195-42" data-line-number="42"><span class="co"># Gini coefficient</span></a>
<a class="sourceLine" id="cb195-43" data-line-number="43">gini =<span class="st"> </span><span class="kw">gamma</span>((<span class="dv">2</span><span class="op">*</span>alpha<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span>(alpha<span class="op">*</span><span class="kw">gamma</span>(alpha)<span class="op">*</span><span class="kw">sqrt</span>(pi))</a>
<a class="sourceLine" id="cb195-44" data-line-number="44"></a>
<a class="sourceLine" id="cb195-45" data-line-number="45"><span class="co"># Plots</span></a>
<a class="sourceLine" id="cb195-46" data-line-number="46"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb195-47" data-line-number="47">dat =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Year=</span><span class="dv">1993</span><span class="op">+</span><span class="dv">1</span><span class="op">:</span>numrow, alpha, beta, <span class="dt">Population=</span>us[,<span class="dv">1</span>], gini)</a>
<a class="sourceLine" id="cb195-48" data-line-number="48"><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>Year)) <span class="op">+</span><span class="st">   </span><span class="kw">geom_line</span>( <span class="kw">aes</span>(<span class="dt">y=</span>alpha), <span class="dt">color=</span><span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb195-49" data-line-number="49"><span class="st">  </span><span class="kw">geom_line</span>( <span class="kw">aes</span>(<span class="dt">y=</span>beta<span class="op">/</span><span class="fl">0.09</span>), <span class="dt">color=</span><span class="st">"blue"</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb195-50" data-line-number="50"><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">"Alpha value (red)"</span>, <span class="dt">sec.axis =</span> <span class="kw">sec_axis</span>( <span class="dt">trans=</span><span class="op">~</span>.<span class="op">*</span><span class="fl">0.09</span>, <span class="dt">name=</span><span class="st">"Beta value (blue)"</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>()<span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">"red"</span>), <span class="dt">axis.title.y.right =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">"blue"</span>))</a>
<a class="sourceLine" id="cb195-51" data-line-number="51"></a>
<a class="sourceLine" id="cb195-52" data-line-number="52"></a>
<a class="sourceLine" id="cb195-53" data-line-number="53"><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>Year)) <span class="op">+</span><span class="st">  </span><span class="kw">geom_line</span>( <span class="kw">aes</span>(<span class="dt">y=</span>alpha), <span class="dt">color=</span><span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>( <span class="kw">aes</span>(<span class="dt">y=</span>(gini<span class="fl">-0.4</span>)<span class="op">*</span><span class="dv">20</span><span class="op">+</span><span class="dv">1</span>), <span class="dt">color=</span><span class="st">"blue"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb195-54" data-line-number="54"><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">"Alpha value (red)"</span>, <span class="dt">sec.axis =</span> <span class="kw">sec_axis</span>( <span class="dt">trans=</span><span class="op">~</span><span class="st"> </span>((. <span class="dv">-1</span>)<span class="op">/</span><span class="dv">20</span><span class="fl">+0.4</span>), <span class="dt">name=</span><span class="st">"Gini (blue)"</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>()<span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">"red"</span>), <span class="dt">axis.title.y.right =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">"blue"</span>))</a>
<a class="sourceLine" id="cb195-55" data-line-number="55"></a>
<a class="sourceLine" id="cb195-56" data-line-number="56"></a>
<a class="sourceLine" id="cb195-57" data-line-number="57"><span class="kw">ggplot</span>(dat, <span class="kw">aes</span>(<span class="dt">x=</span>Year)) <span class="op">+</span><span class="st">  </span><span class="kw">geom_line</span>( <span class="kw">aes</span>(<span class="dt">y=</span>alpha<span class="op">/</span>(Population<span class="op">/</span><span class="dv">10000</span>)), <span class="dt">color=</span><span class="st">"blue"</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>( <span class="kw">aes</span>(<span class="dt">y=</span>(gini<span class="fl">-0.4</span>)<span class="op">*</span><span class="dv">20</span><span class="op">+</span><span class="dv">1</span>), <span class="dt">color=</span><span class="st">"red"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb195-58" data-line-number="58"><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">name =</span> <span class="st">"Individual alpha value (red)"</span>, <span class="dt">sec.axis =</span> <span class="kw">sec_axis</span>( <span class="dt">trans=</span><span class="op">~</span><span class="st"> </span>((. <span class="dv">-1</span>)<span class="op">/</span><span class="dv">20</span><span class="fl">+0.4</span>), <span class="dt">name=</span><span class="st">"Gini (blue)"</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_minimal</span>()<span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">"red"</span>), <span class="dt">axis.title.y.right =</span> <span class="kw">element_text</span>(<span class="dt">color =</span> <span class="st">"blue"</span>))</a></code></pre></div>
<p class="solution-end">
<span class="fa fa-square-o solution-icon"></span>
</p>
</div>
</div>
<p>The data shows that the parameter <span class="math inline">\(\beta_t\)</span> almost monotonically decreased during these <span class="math inline">\(22\)</span> years, implying that individual growth increased. It also shows that the U.S. inequality in <span class="math inline">\(2015\)</span> is less severe than in <span class="math inline">\(1994\)</span>, although, after the economic crisis in <span class="math inline">\(2008\)</span>, the inequality arose. Comparing to the value in <span class="math inline">\(2007\)</span> (the minimum), the <strong>Gini coefficient</strong> in <span class="math inline">\(2015\)</span> increased by about ten percent.</p>
<p>Finally, by using the infinite divisibility of the Gamma distribution, we can assume that given the growth parameters <span class="math inline">\(\alpha_t\)</span> and <span class="math inline">\(\beta_t\)</span>, the growth composes of <span class="math inline">\(n\)</span>-identical individuals “drawn” from the same distribution <span class="math display">\[\mbox{Gamma}\left(\frac{\alpha_t}{n_t},\beta_t \right),\]</span>
where <span class="math inline">\(n_t\)</span> is the population at year <span class="math inline">\(t\)</span>. Here, the word “drawn” simply reflects that the individuals face equal opportunities. This individual parameter <span class="math inline">\(\alpha_t/n_t\)</span> can relate to the individual growth of the productivity (or contribution) at year <span class="math inline">\(t\)</span>.<label for="tufte-sn-643" class="margin-toggle sidenote-number">643</label><input type="checkbox" id="tufte-sn-643" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">643</span> Technically speaking, productivity refers to the <span class="math inline">\(\alpha\)</span>-growth of the aggregate income. To assess the real productivity rate, one has to map the aggregate income process to the real GDP process. Normally, the GDP process depends on the income, so one can model the process by <span class="math inline">\(f(X_t(\omega))\)</span> with the income <span class="math inline">\(X_t(\omega)\)</span> from equation <a href="ch-harmonicAn.html#eq:gamma">(18.1)</a> and some priorly specified function <span class="math inline">\(f(\cdot)\)</span>. This GDP process <span class="math inline">\(f(X_t(\omega))\)</span> relates to <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> because <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> associate with the operator <span class="math inline">\(\mathbf{A}_{L}^{\mbox{H}}\)</span>. However, the proper operator to characterize the dynamics of <span class="math inline">\(f(X_t(\omega))\)</span> is <span class="math inline">\(\mathbf{A}_{L}\)</span>, the dual of <span class="math inline">\(\mathbf{A}_{L}^{\mbox{H}}\)</span>. Here, for an illustration, I simply assume that <span class="math inline">\(f\)</span> is an identity function so that <span class="math inline">\(f(X_t(\omega))=X_t(\omega)\)</span>.</span> Figure <a href="ch-harmonicAn.html#fig:IalphaGini">18.11</a> shows that in <span class="math inline">\(2015\)</span> the value of <span class="math inline">\(\alpha_t/n_t\)</span> drops about <span class="math inline">\(20\%\)</span> compared to that in <span class="math inline">\(2007\)</span>. This is an effect of combining the decrease of the <span class="math inline">\(\alpha\)</span>-growth and the increase of the population.</p>
<p>
<span class="marginnote shownote">
<!--
<div class="figure">--><span id="fig:IalphaGini"></span>
<img src="fig/Part5/IalphaGini.png" alt="Individual alpha growth and Gini coefficient " width="100%"><!--
<p class="caption marginnote">-->Figure 18.11: Individual alpha growth and Gini coefficient <!--</p>-->
<!--</div>--></span>
</p>
</div>
</div></body></html>

<p style="text-align: center;">
<a href="ch-complexAn.html"><button class="btn btn-default">Previous</button></a>
<a href="bibliography.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2021-08-09
</p>
</div>
</div>



</body>
</html>
